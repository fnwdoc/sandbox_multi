
<!doctype html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DUNiAH - PERSON. KUMON01 7.4.1</title>
    
    <!-- Favicon e PWA Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    <link rel="shortcut icon" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    
    <!-- Apple Touch Icons para iOS -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    <link rel="apple-touch-icon" sizes="60x60" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    <link rel="apple-touch-icon" sizes="57x57" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    
    <!-- Android Chrome Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    <link rel="icon" type="image/png" sizes="512x512" href="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    
    <!-- Meta tags PWA -->
    <meta name="theme-color" content="#503060">
    <meta name="msapplication-TileColor" content="#503060">
    <meta name="msapplication-TileImage" content="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkdFUmlBSCAtIENhdMOhbG9nbyBkZSBSZWN1cnNvcyIsCiAgInNob3J0X25hbWUiOiAiR0VSaUFIIiwKICAiZGVzY3JpcHRpb24iOiAiUGxhdGFmb3JtYSBkZSBhcHJlbmRpemFnZW0gcGFyYSBtYWR1cm9zIGUgaWRvc29zIiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiM1MDMwNjAiLAogICJ0aGVtZV9jb2xvciI6ICIjNTAzMDYwIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiaHR0cHM6Ly9kMXllaTJ6M2k2azM1ei5jbG91ZGZyb250Lm5ldC8xMjk3NDUyOS82ODRkOWFiMzYwYmNfR0VSaUFITE9HTzhTUVVBUkUyZG9ud2xvYWQucG5nIiwKICAgICAgInNpemVzIjogIjE5MngxOTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9wbmciCiAgICB9LAogICAgewogICAgICAic3JjIjogImh0dHBzOi8vZDF5ZWkyejNpNmszNXouY2xvdWRmcm9udC5uZXQvMTI5NzQ1MjkvNjg0ZDlhYjM2MGJjX0dFUmlBSExPR084U1FVQVJFMGRVD3dsb2FkLnBuZyIsCiAgICAgICJzaXplcyI6ICI1MTJ4NTEyIiwKICAgICAgInR5cGUiOiAiaW1hZ2UvcG5nIgogICAgfQogIF0KfQ==">
    
    <style>
        /* ========================================
        üé® SISTEMA DE VARI√ÅVEIS DE CORES CSS
        ========================================
        Para facilitar mudan√ßas futuras de temas/cores,
        todas as cores est√£o centralizadas aqui como vari√°veis CSS.
        
        COMO USAR:
        - Para mudar esquema de cores: altere apenas as vari√°veis abaixo
        - Para novos temas: duplique o :root e crie .tema-nome
        - Para modo escuro/claro: use media queries ou classes
        */
        
        :root {
            /* === MODO NORMAL (Padr√£o) === */
            --color-primary-start: #503060;     /* Roxo inicial do gradiente */
            --color-primary-end: #3B204A;       /* Roxo final do gradiente */
            --color-primary-solid: #503060;     /* Roxo s√≥lido para elementos */
            --color-primary-alpha: rgba(80, 48, 96, 0.9); /* Roxo com transpar√™ncia */
            --color-primary-light: rgba(80, 48, 96, 0.7);  /* Roxo mais claro */
            
            /* === MODO DE EDI√á√ÉO === */
            --color-edit-start: #6b4423;        /* Marrom inicial do gradiente */
            --color-edit-end: #4a2f16;          /* Marrom final do gradiente */
            --color-edit-solid: #6b4423;        /* Marrom s√≥lido */
            --color-edit-alpha: rgba(107, 68, 35, 0.8); /* Marrom com transpar√™ncia */
            --color-edit-accent: #ff6b35;       /* Laranja de destaque */
            --color-edit-bg: #2d1810;           /* Fundo main modo edi√ß√£o */
            
            /* === CORES NEUTRAS === */
            --color-text-primary: #e5e5e5;      /* Texto principal */
            --color-text-secondary: #d3d3d3;    /* Texto secund√°rio */
            --color-text-white: #ffffff;        /* Texto branco */
            --color-bg-dark: #100818;           /* Fundo escuro main */
            --color-primary-dark-border: #2A1A3A; /* Borda escura do modal */
            --color-bg-separator: rgba(26, 15, 33, 0.3); /* Separadores */
            
            /* === CLARIDADE DO TEXTO (AJUST√ÅVEL) === */
            --text-brightness: 1;               /* Valor da claridade (0.3 a 1.0) */
            --text-brightness-color: #ffffff;   /* Cor calculada do texto */
        }
        
        /* === APLICA√á√ÉO DO CONTRASTE AUTOM√ÅTICO EM TODOS OS TEXTOS === */
        aside, aside *,
        aside h1, aside h2, aside h3, aside h4, aside h5, aside h6,
        aside p, aside span, aside div, aside button, aside label, aside a,
        .accordion-header, .sub-accordion-header, .sub-sub-accordion-header,
        .card-menu-item, .search-results, .menu-item,
        .search-result-item, .search-result-name,
        .search-highlighted-item, .card-highlighted,
        .sidebar-user-header, .sidebar-user-header *,
        .menu-search-container, .menu-search-container *,
        .search-input, .search-placeholder,
        .color-customization-panel, .color-customization-panel *,
        .brightness-preview, .brightness-info, .color-info-text,
        .color-control-label, .brightness-label,
        /* Elementos espec√≠ficos que podem estar faltando */
        .user-type-display, #userTypeLabel,
        .menu-section, .menu-section *,
        .accordion-content, .accordion-content *,
        .sub-accordion-content, .sub-accordion-content *,
        .course-card, .course-card *,
        /* Todos os elementos dentro da sidebar */
        nav, nav *, 
        .sidebar, .sidebar *,
        /* Elementos de lista e navega√ß√£o */
        ul, ul *, li, li *,
        /* Input e form elements */
        input[type="text"], input[type="search"], textarea,
        /* Qualquer texto restante */
        .text, .label, .title, .subtitle, .description {
            color: var(--text-brightness-color, #ffffff) !important;
        }
        
        /* REGRA CATCH-ALL: Todos os elementos dentro da sidebar */
        aside *:not(input[type="color"]):not(input[type="range"]):not(button):not(select) {
            color: var(--text-brightness-color, #ffffff) !important;
        }
        
        /* Bot√µes e elementos interativos tamb√©m devem seguir o contraste */
        aside button, aside select, .contrast-btn {
            color: var(--text-brightness-color, #ffffff) !important;
        }
        
        /* Elementos espec√≠ficos que precisam manter hierarquia visual */
        .search-result-path {
            color: var(--text-brightness-color, #ffffff) !important;
            filter: brightness(0.7);
        }
        
        .search-no-results {
            color: var(--text-brightness-color, #ffffff) !important;
            filter: brightness(0.6);
            
            /* === CORES DE SISTEMA === */
            --color-header-bg: linear-gradient(135deg, var(--color-primary-solid), var(--color-sidebar-elements)); /* DIN√ÇMICO: header gradient */
            --color-border-light: rgba(255, 255, 255, 0.1); /* Bordas claras */
            --color-shadow: rgba(0, 0, 0, 0.3); /* Sombras */
        }
        
        /* === TEMAS ALTERNATIVOS (EXEMPLO) === */
        /* Para usar: adicione a classe no <body>, ex: <body class="theme-blue"> */
        
        .theme-blue {
            --color-primary-start: #2E5BBA;     /* Azul gradiente inicial */
            --color-primary-end: #1E3A5F;       /* Azul gradiente final */
            --color-primary-solid: #2E5BBA;     /* Azul s√≥lido */
            --color-primary-alpha: rgba(46, 91, 186, 0.9);
            --color-edit-accent: #FF9500;       /* Laranja para edi√ß√£o */
        }
        
        .theme-green {
            --color-primary-start: #2D5016;     /* Verde gradiente inicial */
            --color-primary-end: #1A3009;       /* Verde gradiente final */
            --color-primary-solid: #2D5016;     /* Verde s√≥lido */
            --color-primary-alpha: rgba(45, 80, 22, 0.9);
            --color-edit-accent: #FF6B35;       /* Mant√©m laranja para edi√ß√£o */
        }
        
        .theme-gray {
            --color-primary-start: #606060;     /* Cinza gradiente inicial */
            --color-primary-end: #404040;       /* Cinza gradiente final */
            --color-primary-solid: #606060;     /* Cinza s√≥lido */
            --color-primary-alpha: rgba(96, 96, 96, 0.9);
            --color-edit-accent: #FF6B35;       /* Mant√©m laranja para edi√ß√£o */
        }
        
        /* Reset de overflow para layout fixo */
        html, body { height: 100%; margin: 0; padding: 0; }
        body { 
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-image: linear-gradient(to bottom, var(--color-primary-start), var(--color-primary-end));
            background-color: var(--color-primary-end); /* Fallback */
            color: var(--color-text-primary); /* Cor de texto padr√£o clara */
            padding-top: 70px !important; /* Espa√ßo para o header fixo */
        }
        /* Header fixo GERiAH */
        header { 
            position: fixed !important; 
            top: 0 !important; 
            left: 0 !important; 
            right: 0 !important; 
            height: 70px; 
            background: linear-gradient(135deg, var(--color-primary-solid, #503060), var(--color-sidebar-elements, #503060)) !important; /* DIN√ÇMICO: gradiente com cores do sistema */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--color-text-white); 
            display: flex; 
            align-items: center; 
            padding: 0 30px; /* Aumentado de 20px para 30px para mais espa√ßamento */
            z-index: 9999 !important; /* Z-index alto */
            border-bottom: 1px solid var(--color-sidebar-hover, rgba(80, 48, 96, 0.7)) !important; /* DIN√ÇMICO: borda com cor do sistema */
            gap: 15px; /* Adiciona espa√ßamento entre elementos do header */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3), 0 0 20px var(--color-primary-light, rgba(80, 48, 96, 0.2)) !important; /* EFEITO: sombra com glow */
        }
        header h3 { /* Ajuste no t√≠tulo do header */
            margin: 0; 
            font-size: 1.2em; 
            font-weight: normal;
        }
        /* Estilos para o toggle de modo de edi√ß√£o */
        .edit-mode-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
            margin-right: 15px;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.3);
            transition: 0.3s;
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #ff6b35;
            border-color: #ff6b35;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        #toggleLabel {
            font-size: 0.9em;
            font-weight: normal;
            white-space: nowrap;
        }
        
        /* Modo de edi√ß√£o ativo */
        body.edit-mode {
            background-image: linear-gradient(to bottom, var(--color-edit-start), var(--color-edit-end));
        }
        
        body.edit-mode header {
            background-color: var(--color-edit-alpha);
        }
        
        body.edit-mode #headerTitle {
            color: #ffcc80;
        }
        
        /* Ajuste de font-size para o headerTitle - aumentado 50% */
        #headerTitle {
            font-size: 1.05em; /* 50% maior que o padr√£o original */
            margin: 0 15px; /* Mais espa√ßamento lateral */
        }
        
        body.edit-mode aside {
            background: rgba(74, 47, 22, 0.8);
            border-right: 1px solid rgba(107, 68, 35, 0.7);
        }
        
        body.edit-mode main {
            background-color: var(--color-edit-bg);
        }
        
        /* Bot√µes edit√°veis no modo de edi√ß√£o */
        body.edit-mode .editable-item {
            border: 2px dashed var(--color-edit-accent) !important;
            position: relative;
        }
        
        body.edit-mode .editable-item::after {
            content: "‚úèÔ∏è";
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 12px;
            background: var(--color-edit-accent);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        /* Estilos para o bot√£o de toggle do menu (hamburger) */
        .menu-toggle {
            display: block !important; /* For√ßa a exibi√ß√£o do bot√£o hamburger */
            background: transparent;
            border: none;
            font-size: 2em;
            color: #ffffff !important; /* Cor branca para contraste */
            cursor: pointer;
            padding: 5px 10px;
            z-index: 10000 !important; /* Garante que fique acima de outros elementos do header */
            margin-right: 15px;
            line-height: 1;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5); /* Sombra para melhor legibilidade */
            transition: color 0.3s ease, text-shadow 0.3s ease;
        }
        
        .menu-toggle:hover {
            color: #e0e0e0 !important; /* Cor ligeiramente mais escura no hover */
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.7);
        }
        
        /* Cor espec√≠fica para modo de edi√ß√£o */
        body.edit-mode .menu-toggle {
            color: #ffffff !important; /* Mant√©m branco no modo de edi√ß√£o */
            text-shadow: 0 1px 3px rgba(255, 107, 53, 0.5); /* Sombra laranja no modo de edi√ß√£o */
        }
        
        body.edit-mode .menu-toggle:hover {
            color: #fff3e0 !important; /* Tom mais quente no hover do modo de edi√ß√£o */
            text-shadow: 0 2px 4px rgba(255, 107, 53, 0.8);
        }
        
        /* === PAINEL DE PERSONALIZA√á√ÉO DE CORES (MODO EDI√á√ÉO) === */
        .color-customization-panel {
            position: fixed;
            top: 70px;
            right: 20px;
            width: 300px;
            background: var(--color-edit-alpha);
            border: 2px solid var(--color-edit-accent);
            border-radius: 8px;
            padding: 20px;
            z-index: 1000;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            display: none;
        }
        
        body.edit-mode .color-customization-panel {
            display: block;
        }
        
        .color-panel-header {
            font-size: 1.1em;
            font-weight: bold;
            color: var(--color-edit-accent);
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 1px solid var(--color-edit-accent);
            padding-bottom: 8px;
        }
        
        .color-control-group {
            margin-bottom: 15px;
        }
        
        .color-control-label {
            display: block;
            color: #fff;
            font-size: 0.9em;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .color-control {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .color-picker {
            width: 50px;
            height: 35px;
            border: 2px solid var(--color-edit-accent);
            border-radius: 4px;
            cursor: pointer;
            background: none;
            outline: none;
        }
        
        .color-preview {
            flex: 1;
            height: 35px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }
        
        .color-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .color-btn {
            flex: 1;
            padding: 8px 12px;
            background: var(--color-edit-accent);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: bold;
            transition: background 0.3s ease;
        }
        
        .color-btn:hover {
            background: #e55a2b;
        }
        
        .color-btn.secondary {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .color-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* === CSS PARA PREVIEWS AUTOM√ÅTICOS === */
        .auto-colors-info {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .auto-color-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .auto-color-item:last-child {
            margin-bottom: 0;
        }
        
        .auto-color-label {
            color: #fff;
            font-size: 0.85em;
            font-weight: bold;
            min-width: 140px;
        }
        
        .auto-color-preview {
            flex: 1;
            height: 25px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            font-family: monospace;
        }
        
        .color-info-text {
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 235, 59, 0.1);
            border: 1px solid rgba(255, 235, 59, 0.3);
            border-radius: 4px;
            color: #fff;
            font-size: 0.85em;
            text-align: center;
        }
        
        /* === CSS PARA CONTROLE DE CLARIDADE DO TEXTO === */
        .text-brightness-control {
            margin-top: 8px;
        }
        
        .brightness-slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .brightness-label {
            color: #fff;
            font-size: 0.8em;
            min-width: 45px;
            text-align: center;
        }
        
        .brightness-slider {
            flex: 1;
            height: 6px;
            background: linear-gradient(to right, rgba(255,255,255,0.3), rgba(255,255,255,1));
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }
        
        .brightness-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--color-edit-accent, #ff6b35);
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .brightness-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: var(--color-edit-accent, #ff6b35);
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .brightness-preview {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            padding: 8px 12px;
            text-align: center;
            color: #fff;
            font-size: 0.8em;
            font-family: monospace;
        }
        
        .brightness-info {
            margin-top: 10px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            color: #ccc;
            font-size: 0.75em;
            text-align: center;
        }
        
        /* === ESTILOS PARA EXPORT/IMPORT === */
        .export-import-section {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .export-import-actions {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        
        .export-btn, .import-btn {
            flex: 1;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 10px;
            border-radius: 6px;
            font-weight: bold;
            border: none;
            font-size: 0.9em;
        }
        
        .export-btn {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            color: white;
        }
        
        .export-btn:hover {
            background: linear-gradient(45deg, #1976D2, #1565C0);
            transform: translateY(-1px);
        }
        
        .import-btn {
            background: linear-gradient(45deg, #4CAF50, #388E3C);
            color: white;
            display: inline-block;
            text-decoration: none;
        }
        
        .import-btn:hover {
            background: linear-gradient(45deg, #388E3C, #2E7D32);
            transform: translateY(-1px);
        }
        
        /* === ESTILOS PARA LOGO EDIT√ÅVEL === */
        .support-logo.editable {
            border: 2px dashed rgba(255, 107, 53, 0.5);
            background: rgba(255, 107, 53, 0.1);
        }
        
        .support-logo.editable:hover {
            border-color: rgba(255, 107, 53, 0.8);
            background: rgba(255, 107, 53, 0.2);
            cursor: pointer;
        }
        
        .logo-edit-tooltip {
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7em;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1001;
        }
        
        .support-logo.editable:hover .logo-edit-tooltip {
            opacity: 1;
        }
        
        /* === CSS PARA ELEMENTOS AFETADOS PELA COR PRINCIPAL === */
        .sidebar-user-header {
            background: var(--color-primary-alpha, rgba(80, 48, 96, 0.9));
            color: var(--color-text-white);
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1em;
            border-bottom: 2px solid var(--color-primary-solid, #503060);
            margin-bottom: 10px;
            position: relative;
        }
        
        /* === EDI√á√ÉO DE NOMENCLATURA INDIVIDUAL === */
        #userTypeLabel {
            transition: all 0.3s ease;
            padding: 2px 4px;
            border-radius: 4px;
            cursor: default;
            display: inline-block;
            min-width: 100px;
        }
        
        /* Estilo quando edit√°vel (modo edi√ß√£o) */
        #userTypeLabel.editable {
            cursor: text;
            background: rgba(255, 255, 255, 0.1);
            border: 1px dashed rgba(255, 255, 255, 0.3);
            outline: none;
        }
        
        #userTypeLabel.editable:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        #userTypeLabel.editable:focus {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid var(--color-primary-solid, #503060);
            box-shadow: 0 0 5px var(--color-primary-light, rgba(80, 48, 96, 0.4));
        }
        
        /* Tooltip para modo de edi√ß√£o */
        .sidebar-user-header.edit-mode::after {
            content: "‚úèÔ∏è Clique para editar";
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7em;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1001;
        }
        
        .sidebar-user-header.edit-mode:hover::after {
            opacity: 1;
        }
        
        /* === EDI√á√ÉO DO LOGO DO USU√ÅRIO === */
        #userTypeLogo {
            transition: all 0.3s ease;
            border-radius: 4px;
        }
        
        body.edit-mode #userTypeLogo {
            border: 1px dashed rgba(255, 107, 53, 0.5);
            padding: 2px;
            cursor: pointer;
            position: relative;
        }
        
        body.edit-mode #userTypeLogo::after {
            content: '‚úèÔ∏è';
            position: absolute;
            top: -5px;
            right: -5px;
            background: rgba(255, 107, 53, 0.9);
            border-radius: 50%;
            width: 12px;
            height: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            color: white;
            z-index: 10;
        }
        
        body.edit-mode #userTypeLogo:hover {
            background: rgba(255, 107, 53, 0.2);
            border-color: #ff6b35;
            transform: scale(1.1);
        }
        
        .sidebar-user-header {
            position: relative;
        }
        
        .user-logo-edit-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            top: -30px;
            left: 0;
        }
        
        body.edit-mode .sidebar-user-header:hover .user-logo-edit-tooltip {
            opacity: 1;
        }
        
        .menu-search-container {
            background: var(--color-primary-light, rgba(80, 48, 96, 0.7));
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 6px;
        }
        
        .search-input-wrapper input {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--color-primary-solid, #503060);
            color: #333;
        }
        
        .search-input-wrapper input:focus {
            border-color: var(--color-primary-solid, #503060);
            box-shadow: 0 0 0 2px var(--color-primary-light, rgba(80, 48, 96, 0.3));
        }
        
        /* === CARDS DE NAVEGA√á√ÉO CONECTADOS √Ä COR PRINCIPAL === */
        /* Sobrescrever bordas dos cards com as vari√°veis de cor */
        .course-card {
            border: 1px solid var(--color-primary-light, rgba(80, 48, 96, 0.9)) !important;
        }
        
        .course-card.focused-card {
            border: 2px solid var(--color-primary-solid, #503060) !important;
            box-shadow: 0 20px 45px rgba(0,0,0,0.8), 0 0 20px var(--color-primary-light, rgba(80, 48, 96, 0.4)) !important;
        }
        
        /* IMPORTANTE: Hover priorit√°rio com especificidade alta */
        .course-card:hover {
            border-color: var(--color-primary-solid, #503060) !important;
            box-shadow: 0 6px 12px rgba(0,0,0,0.4), 0 0 15px var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important;
            /* Mant√©m outras propriedades do hover original */
            transform: scale(1.12) !important;
            z-index: 10 !important;
            opacity: 0.95 !important;
            filter: brightness(0.9) !important;
        }
        
        /* Bot√µes e elementos ativos dos cards */
        .course-card .course-action,
        .course-card button,
        .card-menu-item.active {
            background: var(--color-primary-alpha, rgba(80, 48, 96, 0.9)) !important;
            border-color: var(--color-primary-solid, #503060) !important;
        }
        
        .course-card .course-action:hover,
        .course-card button:hover {
            background: var(--color-primary-solid, #503060) !important;
        }
        
        /* === HOVERS ESPEC√çFICOS DOS CARDS === */
        .course-card .course-title,
        .course-card h3,
        .course-card .card-title {
            transition: color 0.3s ease !important;
        }
        
        .course-card:hover .course-title,
        .course-card:hover h3,
        .course-card:hover .card-title {
            color: var(--color-primary-solid, #503060) !important;
        }
        
        .course-card .course-description,
        .course-card .card-description,
        .course-card p {
            transition: color 0.3s ease !important;
        }
        
        .course-card:hover .course-description,
        .course-card:hover .card-description {
            color: #fff !important;
        }
        
        /* Cards de recursos e outros tipos */
        .resource-card,
        .card,
        .content-card {
            border: 1px solid var(--color-primary-light, rgba(80, 48, 96, 0.4)) !important;
            transition: all 0.3s ease !important;
        }
        
        .resource-card:hover,
        .card:hover,
        .content-card:hover {
            border-color: var(--color-primary-solid, #503060) !important;
            box-shadow: 0 6px 20px rgba(0,0,0,0.3), 0 0 15px var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important;
            transform: translateY(-2px) !important;
        }
        
        .resource-card.focused,
        .card.focused,
        .content-card.focused {
            border: 2px solid var(--color-primary-solid, #503060) !important;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4), 0 0 25px var(--color-primary-light, rgba(80, 48, 96, 0.5)) !important;
        }
        
        /* Sidebar abaixo do header */
        aside {
            position: fixed;
            top: 70px;
            left: 0;
            width: 250px;
            height: calc(100vh - 70px);
            background: var(--color-primary-alpha);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--color-text-primary);
            z-index: 990;
            border-right: 1px solid var(--color-border-light);
            overflow-y: auto;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
        }
        /* Adicionado para espa√ßar a primeira categoria do topo da sidebar */
        aside .accordion-item:first-of-type {
            margin-top: 20px; /* Espa√ßo do topo da sidebar */
        }
        /* Novo estilo para o separador cego */
        .category-separator {
            height: 15px; /* Altura do espa√ßador */
            background-color: rgba(26, 15, 33, 0.3); /* AJUSTADO: P√∫rpura mais escuro com 30% de transpar√™ncia */
            margin: 15px 0; /* Margem vertical para espa√ßar */
            border-radius: 3px;
        }
        aside h2 { 
            margin-top: 0; /* Garante que o h2 respeite o margin-bottom do bot√£o acima */
            font-size: 1.1em; 
            color: var(--color-text-white); 
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--color-primary-light);
        }
        #categoriesList {
            list-style: none; 
            /* padding: 0; Removido daqui, ser√° tratado pelo .accordion-content */
        }
        #categoriesList li { margin-bottom: 8px; }
        /* #categoriesList button { // Comentado para usar o seletor mais gen√©rico abaixo
            width: 100%; 
            padding: 10px 15px; 
            text-align: left; 
            border: none; 
            background: transparent; 
            color: #d3d3d3; 
            cursor: pointer; 
            border-radius: 4px; 
            font-size: 0.95em;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        #categoriesList button.active, #categoriesList button:hover { 
            background: var(--color-primary-alpha, rgba(80, 48, 96, 0.9)); 
            color: #fff; 
        } */

        /* Novo seletor gen√©rico para bot√µes dentro dos acorde√µes da sidebar */
        aside .accordion-content ul li button {
            width: 100%; 
            padding: 10px 15px; 
            text-align: left; 
            border: none; 
            background: transparent; 
            color: #d3d3d3; /* Lightgray para itens n√£o ativos */
            cursor: pointer; 
            border-radius: 4px; 
            font-size: 1.0125em;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        aside .accordion-content ul li button:hover,
        aside .accordion-content ul li button.active { /* .active ainda √© √∫til para categorias */
            background: var(--color-primary-alpha); /* Roxo mais forte para ativo/hover */
            color: var(--color-text-white); 
        }

        #myCoursesBtn { 
            /* Estilos de posicionamento fixo na aside removidos */
            /* z-index: 10; */
            /* background-color: #2A1A3A; */ 

            /* width:100%; */ /* N√£o mais 100% da aside */
            padding: 8px 15px; /* Padding ajustado para o header */
            color:#fff; 
            border: 1px solid #fff; 
            border-radius:4px; 
            background: transparent; /* Fundo transparente no header */
            cursor:pointer; 
            margin-left: auto; /* Empurra o bot√£o para a direita do header */
            margin-right: 10px; /* Pequena margem da borda direita do header */
            /* margin-bottom removido pois n√£o √© mais relevante para o fluxo da aside */
            font-size: 0.9em; /* Levemente reduzido para o header */
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        #myCoursesBtn:hover { 
            background: rgba(255,255,255,0.1); /* Hover sutil no header */
            color: #fff;
        }
        /* Conte√∫do ao lado da sidebar, abaixo do header */
        main { 
            margin-left: 250px; /* Largura da sidebar */
            padding: 70px 30px 20px 30px; /* AJUSTADO padding-top para 70px (era 8px) */
            background-color: var(--color-bg-dark); /* MAIS ESCURO: Fundo s√≥lido para o main, pr√≥ximo ao preto */
            transition: margin-left 0.3s ease-in-out; /* Transi√ß√£o para o push/pull */
        }
        main h1 { /* Este √© o #mainTitle - agora usado apenas se necess√°rio ou pode ser removido do JS */
            margin-top: 0; 
            color: #fff; 
        }
        /* Estilo para o t√≠tulo da categoria quando exibido acima do carrossel */
        .category-title-header {
            font-size: 0.9em; 
            color: #fff; 
            margin-bottom: 10px; /* AJUSTADO (era 30px) para aproximar ainda mais o carrossel do t√≠tulo */
            padding-bottom: 10px; 
            border-bottom: 1px solid rgba(80, 48, 96, 0.7);
        }

        /* Removido .courses-grid, agora usamos .carousel-track */
        .carousel-track {
            display: flex;
            overflow-x: auto;
            overflow-y: hidden; /* Esconde scrollbar vertical se houver */
            padding: 20px 500px 130px 500px; /* AJUSTADO padding-top (era 120px) para aproximar do t√≠tulo */
            margin-bottom: 1px; /* AJUSTADO (era 10px) */
            position: relative; /* Necess√°rio para posicionar os pseudo-elementos do esfuma√ßado */
            /* Adicionando perspectiva para transforma√ß√µes 3D dos cards */
            perspective: 1200px;
            transform-style: preserve-3d; /* Garante que os filhos sejam tratados em 3D */
            /* Estilizando a scrollbar horizontal para o trilho */
            scrollbar-width: thin; /* Firefox */
            scrollbar-color: var(--color-sidebar-elements, rgba(70, 40, 86, 0.9)) var(--color-primary-end, rgba(30, 18, 40, 0.7)); /* Firefox: thumb track - Sistema de cores */
        }
        .carousel-track::-webkit-scrollbar {
            height: 12px; /* AJUSTADO (era 8px) */
        }
        .carousel-track::-webkit-scrollbar-track {
            background: var(--color-primary-end, rgba(30, 18, 40, 0.7)) !important; /* Sistema de cores */
        }
        .carousel-track::-webkit-scrollbar-thumb {
            background: var(--color-sidebar-elements, rgba(70, 40, 86, 0.9)) !important; /* Sistema de cores */
            border-radius: 4px;
        }
        .carousel-track::-webkit-scrollbar-thumb:hover {
            background: var(--color-sidebar-hover, rgba(100, 68, 116, 1)) !important; /* Sistema de cores */
        }

        /* Pseudo-elementos para o efeito de esfuma√ßar nas laterais do carrossel */
        .carousel-track::before, .carousel-track::after {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0; 
            width: 280px; /* AUMENTADO: Largura da faixa de esfuma√ßamento (era 180px) */
            z-index: 2; 
            pointer-events: none; 
        }
        .carousel-track::before {
            left: 0;
            /* DIN√ÇMICO: Usa a cor de fundo do main que muda com a cor escolhida */
            background: linear-gradient(to right, var(--color-bg-dark) 60%, color-mix(in srgb, var(--color-bg-dark) 65%, transparent) 85%, transparent 100%);
        }
        .carousel-track::after {
            right: 0;
            /* DIN√ÇMICO: Usa a cor de fundo do main que muda com a cor escolhida */
            background: linear-gradient(to left, var(--color-bg-dark) 60%, color-mix(in srgb, var(--color-bg-dark) 65%, transparent) 85%, transparent 100%);
        }

        .course-card { 
            background: var(--color-sidebar-elements, rgba(63, 44, 80, 0.95)) !important; /* MAIS DESTACADO: era alpha 0.7, agora 0.95 s√≥lido */
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 2px solid var(--color-sidebar-hover, rgba(80, 48, 96, 0.9)) !important; /* MAIS DESTACADO: borda mais grossa e cor hover */
            border-radius: 8px; 
            overflow:hidden; 
            box-shadow: 0 6px 15px rgba(0,0,0,0.4), 0 0 10px var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important; /* MAIS DESTACADO: sombra dupla com glow */
            cursor: pointer; 
            color: #e5e5e5;
            width: 308px; /* AUMENTADO 40% (de 220px) */
            flex-shrink: 0; 
            margin-right: 2px; /* MARGEM M√çNIMA para evitar que colem totalmente sem transform */
            transition: transform 0.4s ease-in-out, box-shadow 0.4s ease-in-out, opacity 0.4s ease-in-out, filter 0.4s ease-in-out, z-index 0s 0.2s; 
            opacity: 0.1; 
            filter: brightness(0.1); 
            /* Transform inicial: recuado e menor. translateX e rotateY ser√£o via JS para vizinhos */
            transform: translateZ(-200px) scale(0.8);
            transform-origin: center center; 
        }
        .course-card:last-child {
            margin-right: 0; 
        }
        .course-card:hover {
            /* Hover mant√©m uma escala mais pr√≥xima do 'normal' mas ainda se destaca dos distantes */
            transform: scale(1.12); /* Mant√©m scale uniforme no hover, sem espremer */
            box-shadow: 0 8px 20px rgba(0,0,0,0.5), 0 0 15px var(--color-sidebar-hover, rgba(80, 48, 96, 0.6)) !important; /* MAIS DESTACADO: sombra maior com glow colorido */
            border-color: var(--color-sidebar-hover, rgba(80, 48, 96, 1)) !important; /* BORDA MAIS VIBRANTE no hover */
            z-index: 10; 
            opacity: 0.95; 
            filter: brightness(0.9); 
        }
        /* Nova classe para o card focado no centro do carrossel */
        .course-card.focused-card {
            /* EFEITO 3D: Card focado vem para frente e aumenta */
            transform: translateZ(60px) scale(1.12); /* Leve ajuste no scale/translateZ do focado */
            box-shadow: 0 25px 50px rgba(0,0,0,0.8), 0 0 20px var(--color-sidebar-hover, rgba(80, 48, 96, 0.8)) !important; /* MAIS DESTACADO: sombra maior com glow mais forte */
            border-color: var(--color-sidebar-hover, rgba(80, 48, 96, 1)) !important; /* BORDA VIBRANTE no focado */
            z-index: 20; 
            opacity: 1; 
            filter: brightness(1); 
        }
        /* Classe para cards adjacentes (n√≠vel 1) ao focado - Usada para opacidade/brilho */
        .course-card.adjacent-style {
            opacity: 0.6; 
            filter: brightness(0.6); 
            /* transform √© aplicado via JS */
        }
        /* Classe para cards vizinhos de segundo n√≠vel - Usada para opacidade/brilho */
        .course-card.secondary-neighbor-style {
            opacity: 0.3;
            filter: brightness(0.3);
            /* transform √© aplicado via JS */
        }
        .course-card img { 
            width: 60px; /* AJUSTADO: Tamanho expl√≠cito para o √≠cone */
            height: 60px; /* AJUSTADO: Tamanho expl√≠cito para o √≠cone */
            object-fit: contain; /* AJUSTADO: Garante que o √≠cone se ajuste sem cortar */
            border-bottom: none; /* REMOVIDO: Borda inferior para √≠cones */
            margin: 15px auto 10px auto; /* AJUSTADO: Centraliza e adiciona margem */
            display: block; /* Garante que seja um bloco para centralizar */
        }
        .course-card .info { 
            padding:15px; 
        }
        .course-card h3 { 
            margin:0 0 10px; 
            font-size:1.05em; 
            color: var(--color-text-on-sidebar, #fff) !important; /* Contraste autom√°tico */
            height: 56px; /* AUMENTADO 40% (de 40px) */
            overflow: hidden;
        }
        .course-card p { 
            font-size:0.85em; 
            color: var(--color-text-on-sidebar, #ccc) !important; /* Contraste autom√°tico */
            opacity: 0.8; /* Reduzir opacidade para descri√ß√£o */
            margin:0; 
            line-height: 1.3;
            height: 70px; /* AUMENTADO 40% (de 50px) */
            overflow: hidden;
        }
        /* Modal */
        .modal { 
            position: fixed; 
            top:0; 
            left:0; 
            width:100%; 
            height:100%; 
            background: rgba(0,0,0,0.8); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            z-index: 1001; /* Mais alto que o header */
        }
        .modal.hidden { display: none; }
        .modal-content { 
            background: linear-gradient(135deg, var(--color-bg-dark, #100818), var(--color-primary-dark-border, #2A1A3A)) !important; /* MAIS ESCURO: gradiente similar ao fundo */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: #fff;
            width: 90%; 
            max-width: 700px; 
            padding: 25px; 
            border-radius:6px; 
            border: 2px solid var(--color-sidebar-hover, rgba(80, 48, 96, 0.8)) !important; /* BORDA MAIS DESTACADA */
            position: relative; 
            max-height: 90vh; 
            overflow-y: auto; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.7), 0 0 20px var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important; /* SOMBRA MAIS FORTE com glow */
        }
        .modal-content img { 
            width:100%; 
            height:auto; 
            margin-bottom:20px; 
            border-radius: 4px; 
        }
        .modal-content h2 { 
            margin-top: 0; 
            font-size: 1.6em;
            margin-bottom: 15px;
        }
        .modal-content p {
            font-size: 1em;
            line-height: 1.6;
            color: #e0e0e0;
            margin-bottom: 10px;
        }
        .close { 
            position: absolute; 
            top: 15px; 
            right: 20px; 
            font-size: 1.8em; 
            color: #aaa; 
            cursor: pointer; 
            transition: color 0.2s ease;
        }
        .close:hover {
            color: #fff;
        }
        
        /* === BOT√ïES DOS MODAIS COM SISTEMA DE CORES === */
        /* Bot√µes principais (Sim, Salvar, Confirmar, etc.) */
        #curateYes,
        #curateContinue, 
        #curateFinish,
        #confirmEditMode,
        #saveItemEdit,
        #saveCardEdit,
        #saveSimpleItemEdit,
        #saveAddFavorite,
        button[id*="save"],
        button[id*="confirm"] {
            background: var(--color-primary-solid, #503060) !important;
            color: white !important;
            border: none !important;
            padding: 12px 20px !important;
            margin: 5px !important;
            border-radius: 4px !important;
            cursor: pointer !important;
            font-weight: bold !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3) !important;
        }
        
        #curateYes:hover,
        #curateContinue:hover, 
        #curateFinish:hover,
        #confirmEditMode:hover,
        #saveItemEdit:hover,
        #saveCardEdit:hover,
        #saveSimpleItemEdit:hover,
        #saveAddFavorite:hover,
        button[id*="save"]:hover,
        button[id*="confirm"]:hover {
            background: var(--color-primary-darker, #402050) !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4) !important;
        }
        
        /* Bot√µes secund√°rios (N√£o, Cancelar, Voltar, etc.) */
        #curateNo,
        #curateBack,
        #cancelEditMode,
        #cancelItemEdit,
        #cancelCardEdit,
        #cancelSimpleItemEdit,
        #cancelAddFavorite,
        #cancelReplace,
        button[id*="cancel"],
        button[id*="back"] {
            background: var(--color-secondary-darker, #666) !important;
            color: white !important;
            border: none !important;
            padding: 12px 20px !important;
            margin: 5px !important;
            border-radius: 4px !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3) !important;
        }
        
        #curateNo:hover,
        #curateBack:hover,
        #cancelEditMode:hover,
        #cancelItemEdit:hover,
        #cancelCardEdit:hover,
        #cancelSimpleItemEdit:hover,
        #cancelAddFavorite:hover,
        #cancelReplace:hover,
        button[id*="cancel"]:hover,
        button[id*="back"]:hover {
            background: var(--color-secondary-darker, #555) !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4) !important;
        }
        
        /* Bot√£o especial "Acessar Agora" */
        #accessNowBtn {
            background: linear-gradient(45deg, var(--color-primary-solid, #503060), var(--color-primary-darker, #402050)) !important;
            color: white !important;
            border: none !important;
            padding: 12px 20px !important;
            margin: 5px !important;
            border-radius: 4px !important;
            cursor: pointer !important;
            font-weight: bold !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3) !important;
        }
        
        #accessNowBtn:hover {
            transform: translateY(-1px) scale(1.02) !important;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4) !important;
        }
        
        /* Bot√µes com cores espec√≠ficas que devem usar o sistema */
        .replace-favorite-btn {
            background: var(--color-primary-alpha, rgba(80, 48, 96, 0.8)) !important;
            color: white !important;
            border: 1px solid var(--color-primary-solid, #503060) !important;
            transition: all 0.3s ease !important;
        }
        
        .replace-favorite-btn:hover {
            background: var(--color-primary-solid, #503060) !important;
            transform: translateY(-1px) !important;
        }
        
        /* === SOBRESCREVER ESTILOS INLINE DOS BOT√ïES === */
        /* For√ßa o sistema de cores mesmo com estilos inline */
        button[style*="background-color: #ff6b35"],
        button[style*="background: #4CAF50"],
        button[style*="background-color: #4CAF50"] {
            background: var(--color-primary-solid, #503060) !important;
        }
        
        button[style*="background-color: #666"],
        button[style*="background: #666"] {
            background: var(--color-secondary-darker, #666) !important;
        }
        
        button[style*="background-color: #ff6b35"]:hover,
        button[style*="background: #4CAF50"]:hover,
        button[style*="background-color: #4CAF50"]:hover {
            background: var(--color-primary-darker, #402050) !important;
        }
        
        button[style*="background-color: #666"]:hover,
        button[style*="background: #666"]:hover {
            background: var(--color-secondary-darker, #555) !important;
        }
        
        /* For√ßa estilo para bot√µes espec√≠ficos mesmo com inline styles */
        button#confirmEditMode[style],
        button#saveItemEdit[style],
        button#saveCardEdit[style],
        button#saveSimpleItemEdit[style],
        button#saveAddFavorite[style] {
            background: var(--color-primary-solid, #503060) !important;
            border: none !important;
            color: white !important;
        }
        
        button#cancelEditMode[style],
        button#cancelItemEdit[style],
        button#cancelCardEdit[style],
        button#cancelSimpleItemEdit[style],
        button#cancelAddFavorite[style],
                button#cancelReplace[style] {
            background: var(--color-secondary-darker, #666) !important;
            border: none !important;
            color: white !important;
        }
        
        /* === INPUTS E ELEMENTOS DOS MODAIS === */
        /* Inputs dos modais com sistema de cores */
        .modal input[type="text"],
        .modal input[type="url"],
        .modal textarea {
            background: var(--color-bg-dark, rgba(16, 8, 24, 0.9)) !important; /* MAIS ESCURO: consistente com o fundo */
            border: 1px solid var(--color-sidebar-hover, rgba(80, 48, 96, 0.8)) !important; /* BORDA MAIS DESTACADA */
            color: var(--color-text-on-background, white) !important;
            transition: border-color 0.3s ease, box-shadow 0.3s ease !important;
        }
        
        .modal input[type="text"]:focus,
        .modal input[type="url"]:focus,
        .modal textarea:focus {
            border-color: var(--color-primary-solid, #503060) !important;
            box-shadow: 0 0 0 2px var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important;
            outline: none !important;
        }
        
        /* Labels dos modais */
        .modal label {
            color: var(--color-text-on-background, #e0e0e0) !important;
        }
        
        /* √Åreas de destaque nos modais */
        .modal div[style*="background: rgba(255, 107, 53"],
        .modal div[style*="background: rgba(76, 175, 80"] {
            background: var(--color-primary-light, rgba(80, 48, 96, 0.2)) !important;
            border-color: var(--color-primary-solid, #503060) !important;
        }
        
        /* Textos de destaque nos modais */
        .modal p[style*="color: #ffcc80"],
        .modal p[style*="color: #81C784"] {
            color: var(--color-text-highlight, #e0e0e0) !important;
        }
        /* Scrollbar customizada (Webkit) - Sistema de Cores */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--color-primary-end, rgba(42, 26, 58, 0.5)); /* Fundo do sistema */
        }
        ::-webkit-scrollbar-thumb {
            background: var(--color-sidebar-elements, rgba(80, 48, 96, 0.8)); /* Cores do sistema */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--color-sidebar-hover, rgba(100, 68, 116, 1)); /* Hover do sistema */
        }
        
        /* Scrollbars espec√≠ficas para carrossel de cards */
        .carousel-track::-webkit-scrollbar,
        main::-webkit-scrollbar,
        aside::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        .carousel-track::-webkit-scrollbar-track,
        main::-webkit-scrollbar-track,
        aside::-webkit-scrollbar-track {
            background: var(--color-primary-end, rgba(42, 26, 58, 0.5));
        }
        .carousel-track::-webkit-scrollbar-thumb,
        main::-webkit-scrollbar-thumb,
        aside::-webkit-scrollbar-thumb {
            background: var(--color-sidebar-elements, rgba(80, 48, 96, 0.8));
            border-radius: 4px;
        }
        .carousel-track::-webkit-scrollbar-thumb:hover,
        main::-webkit-scrollbar-thumb:hover,
        aside::-webkit-scrollbar-thumb:hover {
            background: var(--color-sidebar-hover, rgba(100, 68, 116, 1));
        }

        /* Estilos para Acorde√£o na Sidebar */
        aside .accordion-item {
            border-bottom: 1px solid var(--color-sidebar-elements, rgba(80, 48, 96, 0.7));
            margin-bottom: 25px; /* AJUSTADO: Maior espa√ßamento entre os itens principais */
        }

        aside .accordion-header { /* Estilo para os H2 que s√£o cabe√ßalhos de acorde√£o */
            cursor: pointer;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            width: 100%;
            padding-bottom: 15px; /* AJUSTADO: Mais espa√ßo abaixo do cabe√ßalho */
            padding-right: 25px; /* Espa√ßo para a seta */
            margin-bottom: 0;
            font-size: 0.99em;
            color: var(--color-text-on-background, #fff) !important; /* Contraste autom√°tico */
            margin-top: 0; /* Garante que n√£o haja margem superior extra */
            border-radius: 6px;
            padding-left: 10px;
            padding-top: 10px;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        aside .accordion-header:hover,
        aside .accordion-header.active {
            background: var(--color-sidebar-elements-alpha, rgba(80, 48, 96, 0.8)) !important;
            box-shadow: 0 2px 8px var(--color-primary-light, rgba(80, 48, 96, 0.4)) !important;
        }
        
        aside .accordion-header.active {
            background: var(--color-sidebar-hover-alpha, rgba(100, 68, 116, 0.9)) !important;
        }
        
        /* Removemos o estilo global de aside h2 para n√£o conflitar com accordion-header */
        /* aside h2 { ... } */


        aside .accordion-icon {
            font-size: 0.8em;
            margin-left: auto;
            flex-shrink: 0;
        }

        aside .accordion-content {
            padding-left: 10px; 
            padding-top: 5px; 
            padding-bottom: 10px; 
            display: none; /* Come√ßa fechado */
        }
        aside .accordion-content ul { /* Para #categoriesList e #toolsCategoriesList */
            padding: 0; 
            margin:0;
            list-style: none; /* Garante que n√£o haja marcadores de lista padr√£o */
        }
        aside .accordion-content ul li {
            margin-bottom: 15px; /* AJUSTADO: Espa√ßamento entre itens das subcategorias */
        }
        /* Fim Estilos Acorde√£o */

        /* Estilos para Sub-Acorde√µes dentro de EXCLUSIVO */
        .sub-accordion-item {
            margin-bottom: 15px;
        }
        
        .sub-accordion-header {
            width: 100%;
            background: transparent;
            border: none;
            color: var(--color-text-on-background, #d3d3d3) !important; /* Contraste autom√°tico */
            cursor: pointer;
            padding: 8px 25px 8px 15px; /* Ajustado: mais padding √† direita para a seta */
            text-align: left;
            border-radius: 4px;
            font-size: 0.9em;
            transition: background-color 0.2s ease, color 0.2s ease;
            display: flex;
            justify-content: flex-start;
            align-items: center;
        }
        
        .sub-accordion-header:hover,
        .sub-accordion-header.active {
            background: var(--color-sidebar-elements-alpha, rgba(80, 48, 96, 0.7)) !important;
            color: #fff !important;
        }
        
        .sub-accordion-content {
            padding-left: 20px;
            padding-top: 10px;
        }
        
        .sub-accordion-icon {
            font-size: 0.7em;
            margin-left: auto;
            flex-shrink: 0;
        }
        
        /* Estilos para Terceiro N√≠vel - Cards no Menu */
        .sub-sub-accordion-item {
            margin-bottom: 8px;
            margin-left: 15px;
        }
        
        .sub-sub-accordion-header {
            width: 100%;
            background: transparent;
            border: none;
            color: var(--color-text-on-background, #b8b8b8) !important; /* Contraste autom√°tico */
            cursor: pointer;
            padding: 6px 20px 6px 10px;
            text-align: left;
            border-radius: 3px;
            font-size: 0.85em;
            transition: background-color 0.2s ease, color 0.2s ease;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            border-left: 2px solid var(--color-sidebar-elements, rgba(128, 76, 154, 0.3));
        }
        
        .sub-sub-accordion-header:hover,
        .sub-sub-accordion-header.active {
            background: var(--color-sidebar-elements-alpha, rgba(128, 76, 154, 0.4)) !important;
            color: #fff !important;
            border-left-color: var(--color-sidebar-hover, rgba(128, 76, 154, 0.8)) !important;
        }
        
        .sub-sub-accordion-content {
            padding-left: 15px;
            padding-top: 5px;
        }
        
        .card-menu-item {
            display: flex;
            align-items: center;
            padding: 4px 8px;
            margin: 2px 0;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8em;
            color: #a8a8a8;
            transition: all 0.2s ease;
            border-left: 2px solid transparent;
        }
        
        .card-menu-item:hover {
            background: var(--color-sidebar-hover-alpha, rgba(128, 76, 154, 0.6)) !important; /* MAIS DESTACADO: era 0.2, agora 0.6 */
            color: #fff !important;
            border-left-color: var(--color-sidebar-hover, rgba(128, 76, 154, 1)) !important; /* MAIS DESTACADO: era sidebar-elements */
            transform: translateX(3px) !important; /* EFEITO: leve movimento para a direita */
            transition: all 0.3s ease !important;
        }
        
        .card-menu-item.active {
            background: var(--color-sidebar-hover-alpha, rgba(128, 76, 154, 0.8)) !important; /* MAIS DESTACADO: era 0.3, agora 0.8 */
            color: #fff !important;
            border-left-color: var(--color-sidebar-hover, rgba(128, 76, 154, 1)) !important;
            transform: translateX(5px) !important; /* EFEITO: movimento mais acentuado para ativo */
        }

        .card-menu-item.menu-hover-highlight {
            background: rgba(255, 193, 7, 0.2) !important;
            color: #FFD700 !important;
            border-left: 2px solid #FFD700 !important;
            transition: all 0.3s ease !important;
        }
        
        .card-menu-icon {
            width: 14px;
            height: 14px;
            margin-right: 6px;
            opacity: 0.7;
        }
        /* Fim Estilos Terceiro N√≠vel */

        /* Ajustes para o Modal de Curadoria - GERiAH Style */
        #curationModal .modal-content {
            /* Herda a maioria dos estilos de .modal-content */
            background: linear-gradient(135deg, var(--color-bg-dark, #100818), var(--color-primary-dark-border, #2A1A3A)) !important; /* MAIS ESCURO: igual ao modal padr√£o */
        }
        /* Estilos para o Modal P.A.I (Painel de Acesso Imediato) */
        #paiModal .modal-content {
            /* Herda o fundo escuro do modal padr√£o */
            background: linear-gradient(135deg, var(--color-bg-dark, #100818), var(--color-primary-dark-border, #2A1A3A)) !important; /* MAIS ESCURO: consistente */
            height: 90%; /* Ajustar conforme necessidade */
            width: 90%; /* Ajustar conforme necessidade */
            max-width: 1400px; /* Um pouco maior para ferramentas complexas */
            display: flex; /* Para organizar t√≠tulo e iframe */
            flex-direction: column; /* T√≠tulo acima, iframe abaixo */
        }
        #paiModal iframe {
            flex-grow: 1; /* Iframe ocupa o espa√ßo restante */
            border-radius: 0 0 6px 6px; /* Se o modal-content tiver border-radius */
        }

        #curationModal h2 {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #fff;
        }
        #curationConfirm p, #curationReview h3, #curationList li {
            color: #e5e5e5;
        }
        #curationConfirm button, #curationReview button {
            background-color: var(--color-primary-solid, rgba(100, 68, 116, 0.9)) !important;
            border: 1px solid var(--color-primary-light, rgba(120, 88, 136, 1)) !important;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease;
            color: #fff !important;
        }
        #curationConfirm button:hover, #curationReview button:hover {
            background-color: var(--color-primary-light, rgba(120, 88, 136, 1)) !important;
            border-color: var(--color-secondary-solid, rgba(140, 108, 156, 1)) !important;
        }
        #curationConfirm button#curateNo, #curationReview button#curateBack { /* Bot√£o secund√°rio */
            background-color: rgba(70, 70, 70, 0.8);
            border-color: rgba(90,90,90,1);
        }
        #curationConfirm button#curateNo:hover, #curationReview button#curateBack:hover {
            background-color: rgba(90, 90, 90, 0.9);
            border-color: rgba(110,110,110,1);
        }
        #curationList input[type=checkbox] {
            margin-right: 8px;
            accent-color: var(--color-primary-solid, #804C9A) !important;
        }

        /* Media Query para Telas Pequenas (Mobile) */
        @media (max-width: 768px) {
            body { padding-top: 70px; } /* Ajusta padding do body */
            header {
                justify-content: flex-start; /* Alinha itens √† esquerda */
            }
            .menu-toggle {
                display: block; /* Mostra o bot√£o hamburger no mobile */
                color: #ffffff !important; /* Cor branca para contraste no mobile */
                text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5); /* Sombra para melhor legibilidade */
            }
            aside {
                transform: translateX(-100%); /* Esconde a sidebar por padr√£o no mobile */
                left: 0; /* Garante que o ponto de partida seja 0 */
                box-shadow: 2px 0 5px rgba(0,0,0,0.3); /* Sombra para destacar quando aberta */
            }
            main {
                margin-left: 0; /* Main ocupa largura total quando sidebar est√° oculta */
            }

            /* Estado: Sidebar aberta */
            body.sidebar-open aside {
                transform: translateX(0); /* Mostra a sidebar */
            }
            body.sidebar-open main {
                margin-left: 250px; /* Main √© empurrado para a direita pela sidebar */
            }
            /* Opcional: Adicionar um overlay escuro quando a sidebar estiver aberta */
            body.sidebar-open::after {
                content: '';
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0,0,0,0.5);
                z-index: 980; /* Abaixo da sidebar, acima do main */
            }

            /* Ajustes para o bot√£o de Meus Cursos no mobile */
            #myCoursesBtn {
                margin-left: auto; /* Empurra para a direita para alinhar ao final do header */
            }

            .carousel-track {
                /* Reduzir padding para telas menores */
                padding: 80px 60px 80px 60px;
            }

            .carousel-track::before,
            .carousel-track::after {
                width: 100px; /* Largura do esfuma√ßado reduzida */
            }

            .carousel-track::before {
                background: linear-gradient(to right, #100818 30%, rgba(16, 8, 24, 0.65) 75%, rgba(16, 8, 24, 0) 100%);
            }

            .carousel-track::after {
                background: linear-gradient(to left, #100818 30%, rgba(16, 8, 24, 0.65) 75%, rgba(16, 8, 24, 0) 100%);
            }
            
            /* Ajustar posi√ß√£o da lista de resultados no mobile */
            .search-results {
                left: 260px !important;
                width: 300px !important;
                max-width: calc(100vw - 270px);
                top: 75px !important;
                max-height: 350px;
            }
            
            /* Quando sidebar est√° fechada no mobile, lista fica mais √† esquerda */
            body:not(.sidebar-open) .search-results {
                left: 10px !important;
                width: 280px !important;
                max-width: calc(100vw - 20px);
            }
        }

        .access-course-button {
            background-color: var(--color-primary-solid, #804C9A) !important;
            border: none;
            padding: 8px 15px;
            margin-top: 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            display: block; /* Ocupa a largura total */
            width: calc(100% - 0px); /* Ajusta para preencher o info div */
            text-align: center;
            text-decoration: none; /* Remove underline para links */
            color: #fff !important;
        }
        .access-course-button:hover {
            background-color: var(--color-primary-light, #6C3D82) !important;
        }
        /* Fim Novos estilos para bot√£o Acessar */

        /* Estilos para Sub-Acorde√µes dentro de EXCLUSIVO */

        /* Estilo para mensagens de instru√ß√£o */
        .instruction-message {
            color: #ccc;
            text-align: left;
            margin: 80px 30px 50px 30px;
            font-size: 1.2em;
            line-height: 1.4;
        }
        
        /* Logo discreto de suporte */
        .support-logo {
            width: 48px;
            height: 48px;
            opacity: 1.0; /* Totalmente opaco/aceso */
            cursor: pointer;
            transition: opacity 0.3s ease, transform 0.3s ease;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            margin-left: auto;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .support-logo:hover {
            opacity: 1.0; /* Mant√©m totalmente opaco no hover */
            transform: scale(1.1);
        }
        
        .support-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 6px;
        }
        
        /* Quando o toggle est√° vis√≠vel, logo fica mais vis√≠vel */
        .support-logo.toggle-visible {
            opacity: 1.0; /* Totalmente vis√≠vel */
            background: rgba(255, 107, 53, 0.2);
            border: 2px solid rgba(255, 107, 53, 0.5);
        }
        
        .support-logo.toggle-visible:hover {
            opacity: 1.0; /* Mant√©m totalmente vis√≠vel */
            background: rgba(255, 107, 53, 0.3);
        }
        
        /* Ajustar posicionamento no header */
        header .support-logo {
            position: relative;
        }
        
        /* Logo vis√≠vel mesmo no modo de edi√ß√£o */
        body.edit-mode .support-logo {
            opacity: 0.8; /* Mais vis√≠vel no modo de edi√ß√£o */
            background: rgba(255, 107, 53, 0.1);
        }
        
        body.edit-mode .support-logo:hover {
            opacity: 1.0; /* Totalmente vis√≠vel no hover do modo de edi√ß√£o */
        }
        
        /* Estilos para itens personalizados */
        .customized-item {
            position: relative;
            background: rgba(76, 175, 80, 0.1) !important;
            border-left: 3px solid #4CAF50 !important;
        }
        
        .customized-item::before {
            content: "‚ú®";
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
            opacity: 0.7;
        }
        
        body.edit-mode .customized-item {
            background: rgba(255, 193, 7, 0.2) !important;
            border-left: 3px solid #FFC107 !important;
        }
        
        body.edit-mode .customized-item::before {
            content: "‚úèÔ∏è";
        }
        
        /* Estilos para badges do menu Meus Apps */
        .check-icon {
            background: linear-gradient(45deg, #4CAF50, #66BB6A);
            font-size: 0.8em;
            padding: 2px 5px;
            border-radius: 50%;
            margin-right: 8px;
            width: 18px;
            height: 18px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(76, 175, 80, 0.3);
            animation: check-glow 3s infinite;
        }
        
        /* √çcone de check para apps individuais funcionais */
        .app-check {
            color: #4CAF50;
            font-size: 0.9em;
            margin-right: 6px;
            text-shadow: 0 1px 2px rgba(76, 175, 80, 0.3);
        }
        
        /* √çcone de pendente para apps n√£o testados ainda */
        .app-pending {
            color: #FF9800;
            font-size: 0.9em;
            margin-right: 6px;
            text-shadow: 0 1px 2px rgba(255, 152, 0, 0.3);
        }
        
        .apps-counter {
            color: #4CAF50;
            font-size: 0.9em;
            margin-right: 100px !important;
        }
        
        @keyframes check-glow {
            0%, 100% { 
                box-shadow: 0 2px 4px rgba(76, 175, 80, 0.3);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 2px 8px rgba(76, 175, 80, 0.6);
                transform: scale(1.05);
            }
        }
        
        /* Hover effect para o header Meus Apps */
        .accordion-header:has(.check-icon):hover .check-icon {
            background: linear-gradient(45deg, #66BB6A, #81C784);
            transform: scale(1.1);
        }
        
        .accordion-header:has(.apps-counter):hover .apps-counter {
            background: rgba(76, 175, 80, 1);
            transform: scale(1.05);
        }
        
        /* Indicadores de status das subcategorias */
        .subcat-status {
            font-size: 0.8em;
            margin-right: 6px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .subcat-status.complete {
            color: #4CAF50; /* Verde - todos os apps funcionam */
        }
        
        .subcat-status.partial {
            color: #FF9800; /* Laranja - alguns apps reservados */
        }
        
        .subcat-status.empty {
            color: #757575; /* Cinza - nenhum app funcional */
        }
        
        /* Estilo para subcategorias n√£o implementadas - visual desbotado */
        .sub-accordion-header:has(.subcat-status.empty) {
            opacity: 0.5;
            color: #999999 !important;
        }
        
        .sub-accordion-header:has(.subcat-status.empty) img {
            opacity: 0.4;
            filter: grayscale(50%);
        }
        
        .sub-accordion-header:has(.subcat-status.empty):hover {
            opacity: 0.7;
            background: var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important;
        }

        /* Esconder contadores quando modo de edi√ß√£o est√° inativo */
        body:not(.edit-mode) .apps-counter {
            display: none !important;
        }
        
        /* Mostrar contadores apenas quando modo de edi√ß√£o est√° ativo */
        body.edit-mode .apps-counter {
            display: inline !important;
        }

        /* Badge USER */
        .user-badge {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: rgba(76, 175, 80, 0.9);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            z-index: 999;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(76, 175, 80, 0.3);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            opacity: 0.7;
            pointer-events: none;
        }

        .user-badge:hover {
            opacity: 1;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }


        /* Estilos para categoria MEUS FAVORITOS */
        .add-favorite-placeholder {
            list-style: none;
            margin: 10px 0;
        }

        .add-favorite-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--color-primary-darker, #4A148C), var(--color-primary-solid, #6A1B9A)); /* DIN√ÇMICO: Gradiente com cores do sistema */
            border: none;
            padding: 12px 15px;
            cursor: pointer;
            font-size: 0.9rem;
            color: #ffffff; /* Texto branco para contraste */
            font-weight: 500; /* Texto mais destacado */
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border-radius: 6px; /* Bordas arredondadas */
        }

        /* S√≠mbolo "+" do bot√£o adicionar favorito - DIN√ÇMICO */
        .add-favorite-btn span {
            color: var(--text-brightness-color, #ffffff) !important; /* DIN√ÇMICO: usa exatamente a mesma vari√°vel do contraste do usu√°rio */
            filter: brightness(1.2) saturate(1.1); /* Leve destaque no s√≠mbolo */
            transition: all 0.3s ease;
        }

        .add-favorite-btn:hover {
            background: linear-gradient(135deg, var(--color-primary-solid, #6A1B9A), var(--color-sidebar-hover, #7B1FA2)); /* DIN√ÇMICO: Gradiente hover com cores do sistema */
            transform: translateY(-1px);
            box-shadow: 0 4px 12px var(--color-primary-shadow, rgba(74, 20, 140, 0.4)); /* DIN√ÇMICO: Sombra com cor do sistema */
        }

        /* Efeito especial no s√≠mbolo "+" durante hover - DIN√ÇMICO */
        .add-favorite-btn:hover span {
            transform: scale(1.1) rotate(90deg); /* Efeito de rota√ß√£o e escala no hover */
            filter: brightness(1.5) saturate(1.3) drop-shadow(0 0 8px var(--text-brightness-color, #ffffff)); /* Brilho e glow din√¢mico */
            color: var(--text-brightness-color, #ffffff) !important;
        }

        .add-favorite-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Favoritos individuais */
        .favorite-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            margin: 8px 0;
            padding: 10px;
            transition: all 0.3s ease;
            position: relative;
        }

        .favorite-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 215, 0, 0.5);
        }

        .favorite-item .favorite-link {
            color: #e5e5e5;
            text-decoration: none;
            display: block;
            font-weight: 500;
        }

        .favorite-item .favorite-link:hover {
            color: #FFD700;
        }

        .favorite-delete-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255, 0, 0, 0.7);
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
            display: none;
        }

        body.edit-mode .favorite-delete-btn {
            display: block;
        }

        /* Estilos para o bot√£o de toggle do menu (hamburger) */

        /* Badge USER integrado no sidebar - ATUALIZADO para usar vari√°veis CSS */
        .sidebar-user-header {
            position: sticky;
            top: 0;
            background: var(--color-primary-alpha, rgba(80, 48, 96, 0.95));
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--color-text-white, #fff);
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1em;
            border-bottom: 2px solid var(--color-primary-solid, #503060);
            z-index: 101;
            margin: 0;
        }

        .sidebar-user-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
            pointer-events: none;
        }

        /* Remover badge fixo */
        .user-badge {
            display: none;
        }

        /* Estilos para Sub-Acorde√µes dentro de EXCLUSIVO */

        /* Estilos para o campo de busca do menu - ATUALIZADO para usar vari√°veis CSS */
        .menu-search-container {
            position: sticky;
            top: 0;
            background: var(--color-primary-light, rgba(80, 48, 96, 0.7));
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            margin: 0;
            padding: 15px;
            border-bottom: 1px solid var(--color-border-light, rgba(255, 255, 255, 0.1));
            border-radius: 6px;
            z-index: 100;
        }
        
        /* Container do conte√∫do do menu com scroll */
        .menu-content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 0 15px 20px 15px;
        }
        
        .search-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        #menuSearchInput {
            width: 100%;
            padding: 10px 35px 10px 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 0.9em;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        
        #menuSearchInput:focus {
            outline: none;
            border-color: var(--color-primary-solid, #804C9A);
            background: var(--color-primary-light, rgba(128, 76, 154, 0.15));
            box-shadow: 0 0 10px var(--color-primary-light, rgba(128, 76, 154, 0.3));
        }
        
        #menuSearchInput::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .clear-search-btn {
            position: absolute;
            right: 8px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 18px;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 3px;
            transition: all 0.2s ease;
        }
        
        .clear-search-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }
        
        .search-results {
            position: fixed;
            top: 70px;
            left: 250px;
            width: 350px;
            background: var(--color-sidebar-elements-alpha, rgba(59, 32, 74, 0.98));
            border: 1px solid var(--color-primary-light, rgba(128, 76, 154, 0.4));
            border-radius: 8px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 9999;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            margin: 10px;
            color: var(--color-text-on-sidebar, #ffffff);
        }
        
        .search-result-item {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: background-color 0.2s ease;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .search-result-item:last-child {
            border-bottom: none;
        }
        
        .search-result-item:hover {
            background: var(--color-primary-light, rgba(128, 76, 154, 0.2));
        }
        
        .search-result-item:active {
            background: var(--color-primary-solid, rgba(128, 76, 154, 0.4));
            transform: translateX(2px);
        }
        
        .search-result-item.clicked {
            background: rgba(255, 215, 0, 0.2);
            border-left: 3px solid #FFD700;
            animation: itemClicked 0.3s ease;
        }
        
        @keyframes itemClicked {
            0% { transform: translateX(0); }
            50% { transform: translateX(4px); }
            100% { transform: translateX(0); }
        }
        
        .search-result-name {
            color: var(--color-text-on-sidebar, #fff);
            font-weight: 500;
            font-size: 0.9em;
        }
        
        .search-result-path {
            color: var(--color-text-on-sidebar, rgba(255, 255, 255, 0.7));
            font-size: 0.8em;
            font-style: italic;
        }
        
        .search-no-results {
            padding: 15px;
            text-align: center;
            color: var(--color-text-on-sidebar, rgba(255, 255, 255, 0.6));
            font-style: italic;
        }
        
        /* Highlight do termo pesquisado */
        .search-highlight {
            background: var(--color-primary-light, rgba(255, 235, 59, 0.3));
            color: var(--color-text-on-main, #fff);
            padding: 1px 2px;
            border-radius: 2px;
        }
        
        /* Destaque dos itens encontrados no menu */
        .search-highlighted-item {
            background: var(--color-primary-light, rgba(255, 235, 59, 0.2)) !important;
            border-left: 3px solid var(--color-primary-solid, #FFD700) !important;
            box-shadow: 0 0 8px var(--color-primary-light, rgba(255, 215, 0, 0.4)) !important;
            animation: searchPulse 1.5s ease-in-out infinite;
            color: var(--color-text-on-sidebar, #ffffff) !important;
            opacity: var(--text-brightness, 1) !important;
        }
        
        @keyframes searchPulse {
            0%, 100% { 
                box-shadow: 0 0 8px var(--color-primary-light, rgba(255, 215, 0, 0.4));
            }
            50% { 
                box-shadow: 0 0 12px var(--color-primary-solid, rgba(255, 215, 0, 0.6));
            }
        }

        /* Estilo para mensagens de instru√ß√£o */
        .instruction-message {
            color: #ccc;
            text-align: left;
            margin: 80px 30px 50px 30px;
            font-size: 1.2em;
            line-height: 1.4;
        }

        /* ================ ESTILOS PARA FAVORITOS ================ */
        .favorite-star {
            display: inline-block;
            font-size: 20px;
            color: #999;
            cursor: pointer;
            margin-right: 8px;
            transition: all 0.3s ease;
            user-select: none;
            width: 24px;
            height: 24px;
            text-align: center;
            line-height: 24px;
            border: 1px solid #999;
            border-radius: 3px;
            background: rgba(255,255,255,0.1);
        }

        .favorite-star:hover {
            color: #FFD700;
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.2);
            transform: scale(1.1);
        }

        .favorite-star.favorited {
            color: #FFD700;
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.3);
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
        }

        .favorite-star.favorited:hover {
            color: #FFA500;
            border-color: #FFA500;
            background: rgba(255, 165, 0, 0.3);
        }

        /* Estilos espec√≠ficos para diferentes tipos de itens do menu */
        .sub-accordion-header .favorite-star {
            position: absolute;
            right: 35px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }

        .sub-accordion-header.has-favorite {
            padding-right: 55px;
        }

        .sub-sub-accordion-header .favorite-star {
            position: absolute;
            right: 35px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }

        .sub-sub-accordion-header.has-favorite {
            padding-right: 55px;
        }

        .card-menu-item .favorite-star {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1000;
            font-size: 18px;
            width: 22px;
            height: 22px;
            line-height: 20px;
            pointer-events: auto;
        }

        .card-menu-item.has-favorite {
            padding-right: 35px;
            position: relative;
        }

        /* Garantir que estrelas sejam clic√°veis */
        .favorite-star {
            pointer-events: auto !important;
            z-index: 1000 !important;
        }

        /* Anima√ß√£o quando adiciona/remove favorito */
        @keyframes favoriteAdded {
            0% { transform: scale(1); }
            50% { transform: scale(1.5); color: #FFD700; }
            100% { transform: scale(1); }
        }

        .favorite-star.animate-favorite {
            animation: favoriteAdded 0.6s ease;
        }

        /* Toast de notifica√ß√£o para favoritos */
        .favorite-toast {
            position: fixed;
            top: 90px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: #FFD700;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 10000;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.3s ease;
            border: 1px solid #FFD700;
        }

        .favorite-toast.show {
            opacity: 1;
            transform: translateX(0);
        }

        .favorite-toast.removing {
            opacity: 0;
            transform: translateX(100px);
        }

        /* Estilos limpos para favoritos */
        .clean-favorite-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border-radius: 6px;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05);
            margin-bottom: 2px;
        }

        .clean-favorite-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .favorite-item-name {
            flex: 1;
            margin-left: 8px;
            font-size: 14px;
            color: #e0e0e0;
        }

        .clean-star {
            position: absolute !important;
            right: 8px !important;
            top: 50% !important;
            transform: translateY(-50%) !important;
            width: 20px !important;
            height: 20px !important;
            font-size: 14px !important;
            background: rgba(255, 255, 255, 0.1) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 50% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            color: #999 !important;
            transition: all 0.2s ease !important;
        }

        .clean-star:hover {
            background: rgba(255, 0, 0, 0.2) !important;
            color: #ff6b6b !important;
            border-color: #ff6b6b !important;
        }

        .clean-add-btn {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px dashed rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #ccc;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .clean-add-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
            color: #fff;
        }

        /* √çcones dos favoritos com cor amarela */
        .favorite-icon-selected {
            filter: hue-rotate(45deg) brightness(1.5) contrast(1.2) !important;
            opacity: 0.9 !important;
        }

        .favorite-icon-added {
            filter: hue-rotate(45deg) brightness(1.5) contrast(1.2) !important;
            opacity: 0.9 !important;
        }

        /* Controle de visibilidade do modo edi√ß√£o */
        .edit-mode-only {
            display: none !important;
        }

        body.edit-mode .edit-mode-only {
            display: flex !important;
        }

        /* Estilos para modal de substitui√ß√£o */
        .existing-favorites-list {
            padding: 10px;
        }

        .replace-favorite-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .replace-favorite-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .replace-favorite-item:last-child {
            margin-bottom: 0;
        }

        .replace-favorite-item img {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            border-radius: 4px;
        }

        .replace-favorite-info {
            flex: 1;
        }

        .replace-favorite-name {
            font-weight: bold;
            color: #e0e0e0;
            margin-bottom: 4px;
        }

        .replace-favorite-type {
            font-size: 12px;
            color: #999;
        }

        .replace-favorite-btn {
            background: #ff6b35;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .replace-favorite-btn:hover {
            background: #e55a2b;
        }

        .new-favorite-info {
            display: flex;
            align-items: center;
        }

        .new-favorite-info img {
            width: 32px;
            height: 32px;
            margin-right: 15px;
            border-radius: 6px;
        }

        .new-favorite-details h4 {
            margin: 0 0 5px 0;
            color: #4CAF50;
            font-size: 16px;
        }

        .new-favorite-details p {
            margin: 0;
            color: #81C784;
            font-size: 14px;
        }

        /* Estilos para o Modal de Busca de Treinamentos */
        .training-filter-btn {
            background: linear-gradient(45deg, var(--color-primary-solid), var(--color-primary-light));
            color: white;
            border: 1px solid var(--color-primary-light);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        /* === APLICA√á√ÉO DO CONTRASTE AUTOM√ÅTICO EM TODOS OS TEXTOS === */
        aside, aside *,
        aside h1, aside h2, aside h3, aside h4, aside h5, aside h6,
        aside p, aside span, aside div, aside button, aside label, aside a,
        .accordion-header, .sub-accordion-header, .sub-sub-accordion-header,
        .card-menu-item, .search-results, .menu-item,
        .search-result-item, .search-result-name,
        .search-highlighted-item, .card-highlighted,
        .sidebar-user-header, .sidebar-user-header *,
        .menu-search-container, .menu-search-container *,
        .search-input, .search-placeholder,
        .color-customization-panel, .color-customization-panel *,
        .brightness-preview, .brightness-info, .color-info-text,
        .color-control-label, .brightness-label,
        /* Elementos espec√≠ficos que podem estar faltando */
        .user-type-display, #userTypeLabel,
        .menu-section, .menu-section *,
        .accordion-content, .accordion-content *,
        .sub-accordion-content, .sub-accordion-content *,
        .course-card, .course-card *,
        /* Todos os elementos dentro da sidebar */
        nav, nav *, 
        .sidebar, .sidebar *,
        /* Elementos de lista e navega√ß√£o */
        ul, ul *, li, li *,
        /* Input e form elements */
        input[type="text"], input[type="search"], textarea,
        /* Qualquer texto restante */
        .text, .label, .title, .subtitle, .description {
            color: var(--text-brightness-color, #ffffff) !important;
        }
        
        /* REGRA CATCH-ALL: Todos os elementos dentro da sidebar */
        aside *:not(input[type="color"]):not(input[type="range"]):not(button):not(select) {
            color: var(--text-brightness-color, #ffffff) !important;
        }
        
        /* Bot√µes e elementos interativos tamb√©m devem seguir o contraste */
        aside button, aside select, .contrast-btn {
            color: var(--text-brightness-color, #ffffff) !important;
        }
        
        /* Elementos espec√≠ficos que precisam manter hierarquia visual */
        .search-result-path {
            color: var(--text-brightness-color, #ffffff) !important;
            filter: brightness(0.7);
        }
        
        .search-no-results {
            color: var(--text-brightness-color, #ffffff) !important;
            filter: brightness(0.6);
            
            /* === CORES DE SISTEMA === */
            --color-header-bg: linear-gradient(135deg, var(--color-primary-solid), var(--color-sidebar-elements)); /* DIN√ÇMICO: header gradient */
            --color-border-light: rgba(255, 255, 255, 0.1); /* Bordas claras */
            --color-shadow: rgba(0, 0, 0, 0.3); /* Sombras */
        }
        
        /* === TEMAS ALTERNATIVOS (EXEMPLO) === */
        /* Para usar: adicione a classe no <body>, ex: <body class="theme-blue"> */
        
        .theme-blue {
            --color-primary-start: #2E5BBA;     /* Azul gradiente inicial */
            --color-primary-end: #1E3A5F;       /* Azul gradiente final */
            --color-primary-solid: #2E5BBA;     /* Azul s√≥lido */
            --color-primary-alpha: rgba(46, 91, 186, 0.9);
            --color-edit-accent: #FF9500;       /* Laranja para edi√ß√£o */
        }
        
        .theme-green {
            --color-primary-start: #2D5016;     /* Verde gradiente inicial */
            --color-primary-end: #1A3009;       /* Verde gradiente final */
            --color-primary-solid: #2D5016;     /* Verde s√≥lido */
            --color-primary-alpha: rgba(45, 80, 22, 0.9);
            --color-edit-accent: #FF6B35;       /* Mant√©m laranja para edi√ß√£o */
        }
        
        .theme-gray {
            --color-primary-start: #606060;     /* Cinza gradiente inicial */
            --color-primary-end: #404040;       /* Cinza gradiente final */
            --color-primary-solid: #606060;     /* Cinza s√≥lido */
            --color-primary-alpha: rgba(96, 96, 96, 0.9);
            --color-edit-accent: #FF6B35;       /* Mant√©m laranja para edi√ß√£o */
        }
        
        /* Reset de overflow para layout fixo */
        html, body { height: 100%; margin: 0; padding: 0; }
        body { 
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-image: linear-gradient(to bottom, var(--color-primary-start), var(--color-primary-end));
            background-color: var(--color-primary-end); /* Fallback */
            color: var(--color-text-primary); /* Cor de texto padr√£o clara */
            padding-top: 70px !important; /* Espa√ßo para o header fixo */
        }
        /* Header fixo GERiAH */
        header { 
            position: fixed !important; 
            top: 0 !important; 
            left: 0 !important; 
            right: 0 !important; 
            height: 70px; 
            background: linear-gradient(135deg, var(--color-primary-solid, #503060), var(--color-sidebar-elements, #503060)) !important; /* DIN√ÇMICO: gradiente com cores do sistema */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--color-text-white); 
            display: flex; 
            align-items: center; 
            padding: 0 30px; /* Aumentado de 20px para 30px para mais espa√ßamento */
            z-index: 9999 !important; /* Z-index alto */
            border-bottom: 1px solid var(--color-sidebar-hover, rgba(80, 48, 96, 0.7)) !important; /* DIN√ÇMICO: borda com cor do sistema */
            gap: 15px; /* Adiciona espa√ßamento entre elementos do header */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3), 0 0 20px var(--color-primary-light, rgba(80, 48, 96, 0.2)) !important; /* EFEITO: sombra com glow */
        }
        header h3 { /* Ajuste no t√≠tulo do header */
            margin: 0; 
            font-size: 1.2em; 
            font-weight: normal;
        }
        /* Estilos para o toggle de modo de edi√ß√£o */
        .edit-mode-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: auto;
            margin-right: 15px;
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.3);
            transition: 0.3s;
            border-radius: 24px;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 2px;
            bottom: 2px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: #ff6b35;
            border-color: #ff6b35;
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        
        #toggleLabel {
            font-size: 0.9em;
            font-weight: normal;
            white-space: nowrap;
        }
        
        /* Modo de edi√ß√£o ativo */
        body.edit-mode {
            background-image: linear-gradient(to bottom, var(--color-edit-start), var(--color-edit-end));
        }
        
        body.edit-mode header {
            background-color: var(--color-edit-alpha);
        }
        
        body.edit-mode #headerTitle {
            color: #ffcc80;
        }
        
        /* Ajuste de font-size para o headerTitle - aumentado 50% */
        #headerTitle {
            font-size: 1.05em; /* 50% maior que o padr√£o original */
            margin: 0 15px; /* Mais espa√ßamento lateral */
        }
        
        body.edit-mode aside {
            background: rgba(74, 47, 22, 0.8);
            border-right: 1px solid rgba(107, 68, 35, 0.7);
        }
        
        body.edit-mode main {
            background-color: var(--color-edit-bg);
        }
        
        /* Bot√µes edit√°veis no modo de edi√ß√£o */
        body.edit-mode .editable-item {
            border: 2px dashed var(--color-edit-accent) !important;
            position: relative;
        }
        
        body.edit-mode .editable-item::after {
            content: "‚úèÔ∏è";
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 12px;
            background: var(--color-edit-accent);
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        /* Estilos para o bot√£o de toggle do menu (hamburger) */
        .menu-toggle {
            display: block !important; /* For√ßa a exibi√ß√£o do bot√£o hamburger */
            background: transparent;
            border: none;
            font-size: 2em;
            color: #ffffff !important; /* Cor branca para contraste */
            cursor: pointer;
            padding: 5px 10px;
            z-index: 10000 !important; /* Garante que fique acima de outros elementos do header */
            margin-right: 15px;
            line-height: 1;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5); /* Sombra para melhor legibilidade */
            transition: color 0.3s ease, text-shadow 0.3s ease;
        }
        
        .menu-toggle:hover {
            color: #e0e0e0 !important; /* Cor ligeiramente mais escura no hover */
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.7);
        }
        
        /* Cor espec√≠fica para modo de edi√ß√£o */
        body.edit-mode .menu-toggle {
            color: #ffffff !important; /* Mant√©m branco no modo de edi√ß√£o */
            text-shadow: 0 1px 3px rgba(255, 107, 53, 0.5); /* Sombra laranja no modo de edi√ß√£o */
        }
        
        body.edit-mode .menu-toggle:hover {
            color: #fff3e0 !important; /* Tom mais quente no hover do modo de edi√ß√£o */
            text-shadow: 0 2px 4px rgba(255, 107, 53, 0.8);
        }
        
        /* === PAINEL DE PERSONALIZA√á√ÉO DE CORES (MODO EDI√á√ÉO) === */
        .color-customization-panel {
            position: fixed;
            top: 70px;
            right: 20px;
            width: 300px;
            background: var(--color-edit-alpha);
            border: 2px solid var(--color-edit-accent);
            border-radius: 8px;
            padding: 20px;
            z-index: 1000;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            display: none;
        }
        
        body.edit-mode .color-customization-panel {
            display: block;
        }
        
        .color-panel-header {
            font-size: 1.1em;
            font-weight: bold;
            color: var(--color-edit-accent);
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 1px solid var(--color-edit-accent);
            padding-bottom: 8px;
        }
        
        .color-control-group {
            margin-bottom: 15px;
        }
        
        .color-control-label {
            display: block;
            color: #fff;
            font-size: 0.9em;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        .color-control {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .color-picker {
            width: 50px;
            height: 35px;
            border: 2px solid var(--color-edit-accent);
            border-radius: 4px;
            cursor: pointer;
            background: none;
            outline: none;
        }
        
        .color-preview {
            flex: 1;
            height: 35px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }
        
        .color-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .color-btn {
            flex: 1;
            padding: 8px 12px;
            background: var(--color-edit-accent);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
            font-weight: bold;
            transition: background 0.3s ease;
        }
        
        .color-btn:hover {
            background: #e55a2b;
        }
        
        .color-btn.secondary {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .color-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        /* === CSS PARA PREVIEWS AUTOM√ÅTICOS === */
        .auto-colors-info {
            margin: 20px 0;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .auto-color-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .auto-color-item:last-child {
            margin-bottom: 0;
        }
        
        .auto-color-label {
            color: #fff;
            font-size: 0.85em;
            font-weight: bold;
            min-width: 140px;
        }
        
        .auto-color-preview {
            flex: 1;
            height: 25px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            font-family: monospace;
        }
        
        .color-info-text {
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 235, 59, 0.1);
            border: 1px solid rgba(255, 235, 59, 0.3);
            border-radius: 4px;
            color: #fff;
            font-size: 0.85em;
            text-align: center;
        }
        
        /* === CSS PARA CONTROLE DE CLARIDADE DO TEXTO === */
        .text-brightness-control {
            margin-top: 8px;
        }
        
        .brightness-slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .brightness-label {
            color: #fff;
            font-size: 0.8em;
            min-width: 45px;
            text-align: center;
        }
        
        .brightness-slider {
            flex: 1;
            height: 6px;
            background: linear-gradient(to right, rgba(255,255,255,0.3), rgba(255,255,255,1));
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }
        
        .brightness-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--color-edit-accent, #ff6b35);
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .brightness-slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: var(--color-edit-accent, #ff6b35);
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .brightness-preview {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            padding: 8px 12px;
            text-align: center;
            color: #fff;
            font-size: 0.8em;
            font-family: monospace;
        }
        
        .brightness-info {
            margin-top: 10px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            color: #ccc;
            font-size: 0.75em;
            text-align: center;
        }
        
        /* === ESTILOS PARA EXPORT/IMPORT === */
        .export-import-section {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .export-import-actions {
            display: flex;
            gap: 10px;
            margin: 10px 0;
        }
        
        .export-btn, .import-btn {
            flex: 1;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 10px;
            border-radius: 6px;
            font-weight: bold;
            border: none;
            font-size: 0.9em;
        }
        
        .export-btn {
            background: linear-gradient(45deg, #2196F3, #1976D2);
            color: white;
        }
        
        .export-btn:hover {
            background: linear-gradient(45deg, #1976D2, #1565C0);
            transform: translateY(-1px);
        }
        
        .import-btn {
            background: linear-gradient(45deg, #4CAF50, #388E3C);
            color: white;
            display: inline-block;
            text-decoration: none;
        }
        
        .import-btn:hover {
            background: linear-gradient(45deg, #388E3C, #2E7D32);
            transform: translateY(-1px);
        }
        
        /* === ESTILOS PARA LOGO EDIT√ÅVEL === */
        .support-logo.editable {
            border: 2px dashed rgba(255, 107, 53, 0.5);
            background: rgba(255, 107, 53, 0.1);
        }
        
        .support-logo.editable:hover {
            border-color: rgba(255, 107, 53, 0.8);
            background: rgba(255, 107, 53, 0.2);
            cursor: pointer;
        }
        
        .logo-edit-tooltip {
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7em;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1001;
        }
        
        .support-logo.editable:hover .logo-edit-tooltip {
            opacity: 1;
        }
        
        /* === CSS PARA ELEMENTOS AFETADOS PELA COR PRINCIPAL === */
        .sidebar-user-header {
            background: var(--color-primary-alpha, rgba(80, 48, 96, 0.9));
            color: var(--color-text-white);
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1em;
            border-bottom: 2px solid var(--color-primary-solid, #503060);
            margin-bottom: 10px;
            position: relative;
        }
        
        /* === EDI√á√ÉO DE NOMENCLATURA INDIVIDUAL === */
        #userTypeLabel {
            transition: all 0.3s ease;
            padding: 2px 4px;
            border-radius: 4px;
            cursor: default;
            display: inline-block;
            min-width: 100px;
        }
        
        /* Estilo quando edit√°vel (modo edi√ß√£o) */
        #userTypeLabel.editable {
            cursor: text;
            background: rgba(255, 255, 255, 0.1);
            border: 1px dashed rgba(255, 255, 255, 0.3);
            outline: none;
        }
        
        #userTypeLabel.editable:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.5);
        }
        
        #userTypeLabel.editable:focus {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid var(--color-primary-solid, #503060);
            box-shadow: 0 0 5px var(--color-primary-light, rgba(80, 48, 96, 0.4));
        }
        
        /* Tooltip para modo de edi√ß√£o */
        .sidebar-user-header.edit-mode::after {
            content: "‚úèÔ∏è Clique para editar";
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.7em;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1001;
        }
        
        .sidebar-user-header.edit-mode:hover::after {
            opacity: 1;
        }
        
        /* === EDI√á√ÉO DO LOGO DO USU√ÅRIO === */
        #userTypeLogo {
            transition: all 0.3s ease;
            border-radius: 4px;
        }
        
        body.edit-mode #userTypeLogo {
            border: 1px dashed rgba(255, 107, 53, 0.5);
            padding: 2px;
            cursor: pointer;
            position: relative;
        }
        
        body.edit-mode #userTypeLogo::after {
            content: '‚úèÔ∏è';
            position: absolute;
            top: -5px;
            right: -5px;
            background: rgba(255, 107, 53, 0.9);
            border-radius: 50%;
            width: 12px;
            height: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            color: white;
            z-index: 10;
        }
        
        body.edit-mode #userTypeLogo:hover {
            background: rgba(255, 107, 53, 0.2);
            border-color: #ff6b35;
            transform: scale(1.1);
        }
        
        .sidebar-user-header {
            position: relative;
        }
        
        .user-logo-edit-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            top: -30px;
            left: 0;
        }
        
        body.edit-mode .sidebar-user-header:hover .user-logo-edit-tooltip {
            opacity: 1;
        }
        
        .menu-search-container {
            background: var(--color-primary-light, rgba(80, 48, 96, 0.7));
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 6px;
        }
        
        .search-input-wrapper input {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--color-primary-solid, #503060);
            color: #333;
        }
        
        .search-input-wrapper input:focus {
            border-color: var(--color-primary-solid, #503060);
            box-shadow: 0 0 0 2px var(--color-primary-light, rgba(80, 48, 96, 0.3));
        }
        
        /* === CARDS DE NAVEGA√á√ÉO CONECTADOS √Ä COR PRINCIPAL === */
        /* Sobrescrever bordas dos cards com as vari√°veis de cor */
        .course-card {
            border: 1px solid var(--color-primary-light, rgba(80, 48, 96, 0.9)) !important;
        }
        
        .course-card.focused-card {
            border: 2px solid var(--color-primary-solid, #503060) !important;
            box-shadow: 0 20px 45px rgba(0,0,0,0.8), 0 0 20px var(--color-primary-light, rgba(80, 48, 96, 0.4)) !important;
        }
        
        /* IMPORTANTE: Hover priorit√°rio com especificidade alta */
        .course-card:hover {
            border-color: var(--color-primary-solid, #503060) !important;
            box-shadow: 0 6px 12px rgba(0,0,0,0.4), 0 0 15px var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important;
            /* Mant√©m outras propriedades do hover original */
            transform: scale(1.12) !important;
            z-index: 10 !important;
            opacity: 0.95 !important;
            filter: brightness(0.9) !important;
        }
        
        /* Bot√µes e elementos ativos dos cards */
        .course-card .course-action,
        .course-card button,
        .card-menu-item.active {
            background: var(--color-primary-alpha, rgba(80, 48, 96, 0.9)) !important;
            border-color: var(--color-primary-solid, #503060) !important;
        }
        
        .course-card .course-action:hover,
        .course-card button:hover {
            background: var(--color-primary-solid, #503060) !important;
        }
        
        /* === HOVERS ESPEC√çFICOS DOS CARDS === */
        .course-card .course-title,
        .course-card h3,
        .course-card .card-title {
            transition: color 0.3s ease !important;
        }
        
        .course-card:hover .course-title,
        .course-card:hover h3,
        .course-card:hover .card-title {
            color: var(--color-primary-solid, #503060) !important;
        }
        
        .course-card .course-description,
        .course-card .card-description,
        .course-card p {
            transition: color 0.3s ease !important;
        }
        
        .course-card:hover .course-description,
        .course-card:hover .card-description {
            color: #fff !important;
        }
        
        /* Cards de recursos e outros tipos */
        .resource-card,
        .card,
        .content-card {
            border: 1px solid var(--color-primary-light, rgba(80, 48, 96, 0.4)) !important;
            transition: all 0.3s ease !important;
        }
        
        .resource-card:hover,
        .card:hover,
        .content-card:hover {
            border-color: var(--color-primary-solid, #503060) !important;
            box-shadow: 0 6px 20px rgba(0,0,0,0.3), 0 0 15px var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important;
            transform: translateY(-2px) !important;
        }
        
        .resource-card.focused,
        .card.focused,
        .content-card.focused {
            border: 2px solid var(--color-primary-solid, #503060) !important;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4), 0 0 25px var(--color-primary-light, rgba(80, 48, 96, 0.5)) !important;
        }
        
        /* Sidebar abaixo do header */
        aside {
            position: fixed;
            top: 70px;
            left: 0;
            width: 250px;
            height: calc(100vh - 70px);
            background: var(--color-primary-alpha);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--color-text-primary);
            z-index: 990;
            border-right: 1px solid var(--color-border-light);
            overflow-y: auto;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
        }
        /* Adicionado para espa√ßar a primeira categoria do topo da sidebar */
        aside .accordion-item:first-of-type {
            margin-top: 20px; /* Espa√ßo do topo da sidebar */
        }
        /* Novo estilo para o separador cego */
        .category-separator {
            height: 15px; /* Altura do espa√ßador */
            background-color: rgba(26, 15, 33, 0.3); /* AJUSTADO: P√∫rpura mais escuro com 30% de transpar√™ncia */
            margin: 15px 0; /* Margem vertical para espa√ßar */
            border-radius: 3px;
        }
        aside h2 { 
            margin-top: 0; /* Garante que o h2 respeite o margin-bottom do bot√£o acima */
            font-size: 1.1em; 
            color: var(--color-text-white); 
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--color-primary-light);
        }
        #categoriesList {
            list-style: none; 
            /* padding: 0; Removido daqui, ser√° tratado pelo .accordion-content */
        }
        #categoriesList li { margin-bottom: 8px; }
        /* #categoriesList button { // Comentado para usar o seletor mais gen√©rico abaixo
            width: 100%; 
            padding: 10px 15px; 
            text-align: left; 
            border: none; 
            background: transparent; 
            color: #d3d3d3; 
            cursor: pointer; 
            border-radius: 4px; 
            font-size: 0.95em;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        #categoriesList button.active, #categoriesList button:hover { 
            background: var(--color-primary-alpha, rgba(80, 48, 96, 0.9)); 
            color: #fff; 
        } */

        /* Novo seletor gen√©rico para bot√µes dentro dos acorde√µes da sidebar */
        aside .accordion-content ul li button {
            width: 100%; 
            padding: 10px 15px; 
            text-align: left; 
            border: none; 
            background: transparent; 
            color: #d3d3d3; /* Lightgray para itens n√£o ativos */
            cursor: pointer; 
            border-radius: 4px; 
            font-size: 1.0125em;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        aside .accordion-content ul li button:hover,
        aside .accordion-content ul li button.active { /* .active ainda √© √∫til para categorias */
            background: var(--color-primary-alpha); /* Roxo mais forte para ativo/hover */
            color: var(--color-text-white); 
        }

        #myCoursesBtn { 
            /* Estilos de posicionamento fixo na aside removidos */
            /* z-index: 10; */
            /* background-color: #2A1A3A; */ 

            /* width:100%; */ /* N√£o mais 100% da aside */
            padding: 8px 15px; /* Padding ajustado para o header */
            color:#fff; 
            border: 1px solid #fff; 
            border-radius:4px; 
            background: transparent; /* Fundo transparente no header */
            cursor:pointer; 
            margin-left: auto; /* Empurra o bot√£o para a direita do header */
            margin-right: 10px; /* Pequena margem da borda direita do header */
            /* margin-bottom removido pois n√£o √© mais relevante para o fluxo da aside */
            font-size: 0.9em; /* Levemente reduzido para o header */
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        #myCoursesBtn:hover { 
            background: rgba(255,255,255,0.1); /* Hover sutil no header */
            color: #fff;
        }
        /* Conte√∫do ao lado da sidebar, abaixo do header */
        main { 
            margin-left: 250px; /* Largura da sidebar */
            padding: 70px 30px 20px 30px; /* AJUSTADO padding-top para 70px (era 8px) */
            background-color: var(--color-bg-dark); /* MAIS ESCURO: Fundo s√≥lido para o main, pr√≥ximo ao preto */
            transition: margin-left 0.3s ease-in-out; /* Transi√ß√£o para o push/pull */
        }
        main h1 { /* Este √© o #mainTitle - agora usado apenas se necess√°rio ou pode ser removido do JS */
            margin-top: 0; 
            color: #fff; 
        }
        /* Estilo para o t√≠tulo da categoria quando exibido acima do carrossel */
        .category-title-header {
            font-size: 0.9em; 
            color: #fff; 
            margin-bottom: 10px; /* AJUSTADO (era 30px) para aproximar ainda mais o carrossel do t√≠tulo */
            padding-bottom: 10px; 
            border-bottom: 1px solid rgba(80, 48, 96, 0.7);
        }

        /* Removido .courses-grid, agora usamos .carousel-track */
        .carousel-track {
            display: flex;
            overflow-x: auto;
            overflow-y: hidden; /* Esconde scrollbar vertical se houver */
            padding: 20px 500px 130px 500px; /* AJUSTADO padding-top (era 120px) para aproximar do t√≠tulo */
            margin-bottom: 1px; /* AJUSTADO (era 10px) */
            position: relative; /* Necess√°rio para posicionar os pseudo-elementos do esfuma√ßado */
            /* Adicionando perspectiva para transforma√ß√µes 3D dos cards */
            perspective: 1200px;
            transform-style: preserve-3d; /* Garante que os filhos sejam tratados em 3D */
            /* Estilizando a scrollbar horizontal para o trilho */
            scrollbar-width: thin; /* Firefox */
            scrollbar-color: var(--color-sidebar-elements, rgba(70, 40, 86, 0.9)) var(--color-primary-end, rgba(30, 18, 40, 0.7)); /* Firefox: thumb track - Sistema de cores */
        }
        .carousel-track::-webkit-scrollbar {
            height: 12px; /* AJUSTADO (era 8px) */
        }
        .carousel-track::-webkit-scrollbar-track {
            background: var(--color-primary-end, rgba(30, 18, 40, 0.7)) !important; /* Sistema de cores */
        }
        .carousel-track::-webkit-scrollbar-thumb {
            background: var(--color-sidebar-elements, rgba(70, 40, 86, 0.9)) !important; /* Sistema de cores */
            border-radius: 4px;
        }
        .carousel-track::-webkit-scrollbar-thumb:hover {
            background: var(--color-sidebar-hover, rgba(100, 68, 116, 1)) !important; /* Sistema de cores */
        }

        /* Pseudo-elementos para o efeito de esfuma√ßar nas laterais do carrossel */
        .carousel-track::before, .carousel-track::after {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0; 
            width: 280px; /* AUMENTADO: Largura da faixa de esfuma√ßamento (era 180px) */
            z-index: 2; 
            pointer-events: none; 
        }
        .carousel-track::before {
            left: 0;
            /* DIN√ÇMICO: Usa a cor de fundo do main que muda com a cor escolhida */
            background: linear-gradient(to right, var(--color-bg-dark) 60%, color-mix(in srgb, var(--color-bg-dark) 65%, transparent) 85%, transparent 100%);
        }
        .carousel-track::after {
            right: 0;
            /* DIN√ÇMICO: Usa a cor de fundo do main que muda com a cor escolhida */
            background: linear-gradient(to left, var(--color-bg-dark) 60%, color-mix(in srgb, var(--color-bg-dark) 65%, transparent) 85%, transparent 100%);
        }

        .course-card { 
            background: var(--color-sidebar-elements, rgba(63, 44, 80, 0.95)) !important; /* MAIS DESTACADO: era alpha 0.7, agora 0.95 s√≥lido */
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 2px solid var(--color-sidebar-hover, rgba(80, 48, 96, 0.9)) !important; /* MAIS DESTACADO: borda mais grossa e cor hover */
            border-radius: 8px; 
            overflow:hidden; 
            box-shadow: 0 6px 15px rgba(0,0,0,0.4), 0 0 10px var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important; /* MAIS DESTACADO: sombra dupla com glow */
            cursor: pointer; 
            color: #e5e5e5;
            width: 308px; /* AUMENTADO 40% (de 220px) */
            flex-shrink: 0; 
            margin-right: 2px; /* MARGEM M√çNIMA para evitar que colem totalmente sem transform */
            transition: transform 0.4s ease-in-out, box-shadow 0.4s ease-in-out, opacity 0.4s ease-in-out, filter 0.4s ease-in-out, z-index 0s 0.2s; 
            opacity: 0.1; 
            filter: brightness(0.1); 
            /* Transform inicial: recuado e menor. translateX e rotateY ser√£o via JS para vizinhos */
            transform: translateZ(-200px) scale(0.8);
            transform-origin: center center; 
        }
        .course-card:last-child {
            margin-right: 0; 
        }
        .course-card:hover {
            /* Hover mant√©m uma escala mais pr√≥xima do 'normal' mas ainda se destaca dos distantes */
            transform: scale(1.12); /* Mant√©m scale uniforme no hover, sem espremer */
            box-shadow: 0 8px 20px rgba(0,0,0,0.5), 0 0 15px var(--color-sidebar-hover, rgba(80, 48, 96, 0.6)) !important; /* MAIS DESTACADO: sombra maior com glow colorido */
            border-color: var(--color-sidebar-hover, rgba(80, 48, 96, 1)) !important; /* BORDA MAIS VIBRANTE no hover */
            z-index: 10; 
            opacity: 0.95; 
            filter: brightness(0.9); 
        }
        /* Nova classe para o card focado no centro do carrossel */
        .course-card.focused-card {
            /* EFEITO 3D: Card focado vem para frente e aumenta */
            transform: translateZ(60px) scale(1.12); /* Leve ajuste no scale/translateZ do focado */
            box-shadow: 0 25px 50px rgba(0,0,0,0.8), 0 0 20px var(--color-sidebar-hover, rgba(80, 48, 96, 0.8)) !important; /* MAIS DESTACADO: sombra maior com glow mais forte */
            border-color: var(--color-sidebar-hover, rgba(80, 48, 96, 1)) !important; /* BORDA VIBRANTE no focado */
            z-index: 20; 
            opacity: 1; 
            filter: brightness(1); 
        }
        /* Classe para cards adjacentes (n√≠vel 1) ao focado - Usada para opacidade/brilho */
        .course-card.adjacent-style {
            opacity: 0.6; 
            filter: brightness(0.6); 
            /* transform √© aplicado via JS */
        }
        /* Classe para cards vizinhos de segundo n√≠vel - Usada para opacidade/brilho */
        .course-card.secondary-neighbor-style {
            opacity: 0.3;
            filter: brightness(0.3);
            /* transform √© aplicado via JS */
        }
        .course-card img { 
            width: 60px; /* AJUSTADO: Tamanho expl√≠cito para o √≠cone */
            height: 60px; /* AJUSTADO: Tamanho expl√≠cito para o √≠cone */
            object-fit: contain; /* AJUSTADO: Garante que o √≠cone se ajuste sem cortar */
            border-bottom: none; /* REMOVIDO: Borda inferior para √≠cones */
            margin: 15px auto 10px auto; /* AJUSTADO: Centraliza e adiciona margem */
            display: block; /* Garante que seja um bloco para centralizar */
        }
        .course-card .info { 
            padding:15px; 
        }
        .course-card h3 { 
            margin:0 0 10px; 
            font-size:1.05em; 
            color: var(--color-text-on-sidebar, #fff) !important; /* Contraste autom√°tico */
            height: 56px; /* AUMENTADO 40% (de 40px) */
            overflow: hidden;
        }
        .course-card p { 
            font-size:0.85em; 
            color: var(--color-text-on-sidebar, #ccc) !important; /* Contraste autom√°tico */
            opacity: 0.8; /* Reduzir opacidade para descri√ß√£o */
            margin:0; 
            line-height: 1.3;
            height: 70px; /* AUMENTADO 40% (de 50px) */
            overflow: hidden;
        }
        /* Modal */
        .modal { 
            position: fixed; 
            top:0; 
            left:0; 
            width:100%; 
            height:100%; 
            background: rgba(0,0,0,0.8); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            z-index: 1001; /* Mais alto que o header */
        }
        .modal.hidden { display: none; }
        .modal-content { 
            background: linear-gradient(135deg, var(--color-bg-dark, #100818), var(--color-primary-dark-border, #2A1A3A)) !important; /* MAIS ESCURO: gradiente similar ao fundo */
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: #fff;
            width: 90%; 
            max-width: 700px; 
            padding: 25px; 
            border-radius:6px; 
            border: 2px solid var(--color-sidebar-hover, rgba(80, 48, 96, 0.8)) !important; /* BORDA MAIS DESTACADA */
            position: relative; 
            max-height: 90vh; 
            overflow-y: auto; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.7), 0 0 20px var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important; /* SOMBRA MAIS FORTE com glow */
        }
        .modal-content img { 
            width:100%; 
            height:auto; 
            margin-bottom:20px; 
            border-radius: 4px; 
        }
        .modal-content h2 { 
            margin-top: 0; 
            font-size: 1.6em;
            margin-bottom: 15px;
        }
        .modal-content p {
            font-size: 1em;
            line-height: 1.6;
            color: #e0e0e0;
            margin-bottom: 10px;
        }
        .close { 
            position: absolute; 
            top: 15px; 
            right: 20px; 
            font-size: 1.8em; 
            color: #aaa; 
            cursor: pointer; 
            transition: color 0.2s ease;
        }
        .close:hover {
            color: #fff;
        }
        
        /* === BOT√ïES DOS MODAIS COM SISTEMA DE CORES === */
        /* Bot√µes principais (Sim, Salvar, Confirmar, etc.) */
        #curateYes,
        #curateContinue, 
        #curateFinish,
        #confirmEditMode,
        #saveItemEdit,
        #saveCardEdit,
        #saveSimpleItemEdit,
        #saveAddFavorite,
        button[id*="save"],
        button[id*="confirm"] {
            background: var(--color-primary-solid, #503060) !important;
            color: white !important;
            border: none !important;
            padding: 12px 20px !important;
            margin: 5px !important;
            border-radius: 4px !important;
            cursor: pointer !important;
            font-weight: bold !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3) !important;
        }
        
        #curateYes:hover,
        #curateContinue:hover, 
        #curateFinish:hover,
        #confirmEditMode:hover,
        #saveItemEdit:hover,
        #saveCardEdit:hover,
        #saveSimpleItemEdit:hover,
        #saveAddFavorite:hover,
        button[id*="save"]:hover,
        button[id*="confirm"]:hover {
            background: var(--color-primary-darker, #402050) !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4) !important;
        }
        
        /* Bot√µes secund√°rios (N√£o, Cancelar, Voltar, etc.) */
        #curateNo,
        #curateBack,
        #cancelEditMode,
        #cancelItemEdit,
        #cancelCardEdit,
        #cancelSimpleItemEdit,
        #cancelAddFavorite,
        #cancelReplace,
        button[id*="cancel"],
        button[id*="back"] {
            background: var(--color-secondary-darker, #666) !important;
            color: white !important;
            border: none !important;
            padding: 12px 20px !important;
            margin: 5px !important;
            border-radius: 4px !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3) !important;
        }
        
        #curateNo:hover,
        #curateBack:hover,
        #cancelEditMode:hover,
        #cancelItemEdit:hover,
        #cancelCardEdit:hover,
        #cancelSimpleItemEdit:hover,
        #cancelAddFavorite:hover,
        #cancelReplace:hover,
        button[id*="cancel"]:hover,
        button[id*="back"]:hover {
            background: var(--color-secondary-darker, #555) !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4) !important;
        }
        
        /* Bot√£o especial "Acessar Agora" */
        #accessNowBtn {
            background: linear-gradient(45deg, var(--color-primary-solid, #503060), var(--color-primary-darker, #402050)) !important;
            color: white !important;
            border: none !important;
            padding: 12px 20px !important;
            margin: 5px !important;
            border-radius: 4px !important;
            cursor: pointer !important;
            font-weight: bold !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3) !important;
        }
        
        #accessNowBtn:hover {
            transform: translateY(-1px) scale(1.02) !important;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4) !important;
        }
        
        /* Bot√µes com cores espec√≠ficas que devem usar o sistema */
        .replace-favorite-btn {
            background: var(--color-primary-alpha, rgba(80, 48, 96, 0.8)) !important;
            color: white !important;
            border: 1px solid var(--color-primary-solid, #503060) !important;
            transition: all 0.3s ease !important;
        }
        
        .replace-favorite-btn:hover {
            background: var(--color-primary-solid, #503060) !important;
            transform: translateY(-1px) !important;
        }
        
        /* === SOBRESCREVER ESTILOS INLINE DOS BOT√ïES === */
        /* For√ßa o sistema de cores mesmo com estilos inline */
        button[style*="background-color: #ff6b35"],
        button[style*="background: #4CAF50"],
        button[style*="background-color: #4CAF50"] {
            background: var(--color-primary-solid, #503060) !important;
        }
        
        button[style*="background-color: #666"],
        button[style*="background: #666"] {
            background: var(--color-secondary-darker, #666) !important;
        }
        
        button[style*="background-color: #ff6b35"]:hover,
        button[style*="background: #4CAF50"]:hover,
        button[style*="background-color: #4CAF50"]:hover {
            background: var(--color-primary-darker, #402050) !important;
        }
        
        button[style*="background-color: #666"]:hover,
        button[style*="background: #666"]:hover {
            background: var(--color-secondary-darker, #555) !important;
        }
        
        /* For√ßa estilo para bot√µes espec√≠ficos mesmo com inline styles */
        button#confirmEditMode[style],
        button#saveItemEdit[style],
        button#saveCardEdit[style],
        button#saveSimpleItemEdit[style],
        button#saveAddFavorite[style] {
            background: var(--color-primary-solid, #503060) !important;
            border: none !important;
            color: white !important;
        }
        
        button#cancelEditMode[style],
        button#cancelItemEdit[style],
        button#cancelCardEdit[style],
        button#cancelSimpleItemEdit[style],
        button#cancelAddFavorite[style],
                button#cancelReplace[style] {
            background: var(--color-secondary-darker, #666) !important;
            border: none !important;
            color: white !important;
        }
        
        /* === INPUTS E ELEMENTOS DOS MODAIS === */
        /* Inputs dos modais com sistema de cores */
        .modal input[type="text"],
        .modal input[type="url"],
        .modal textarea {
            background: var(--color-bg-dark, rgba(16, 8, 24, 0.9)) !important; /* MAIS ESCURO: consistente com o fundo */
            border: 1px solid var(--color-sidebar-hover, rgba(80, 48, 96, 0.8)) !important; /* BORDA MAIS DESTACADA */
            color: var(--color-text-on-background, white) !important;
            transition: border-color 0.3s ease, box-shadow 0.3s ease !important;
        }
        
        .modal input[type="text"]:focus,
        .modal input[type="url"]:focus,
        .modal textarea:focus {
            border-color: var(--color-primary-solid, #503060) !important;
            box-shadow: 0 0 0 2px var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important;
            outline: none !important;
        }
        
        /* Labels dos modais */
        .modal label {
            color: var(--color-text-on-background, #e0e0e0) !important;
        }
        
        /* √Åreas de destaque nos modais */
        .modal div[style*="background: rgba(255, 107, 53"],
        .modal div[style*="background: rgba(76, 175, 80"] {
            background: var(--color-primary-light, rgba(80, 48, 96, 0.2)) !important;
            border-color: var(--color-primary-solid, #503060) !important;
        }
        
        /* Textos de destaque nos modais */
        .modal p[style*="color: #ffcc80"],
        .modal p[style*="color: #81C784"] {
            color: var(--color-text-highlight, #e0e0e0) !important;
        }
        /* Scrollbar customizada (Webkit) - Sistema de Cores */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--color-primary-end, rgba(42, 26, 58, 0.5)); /* Fundo do sistema */
        }
        ::-webkit-scrollbar-thumb {
            background: var(--color-sidebar-elements, rgba(80, 48, 96, 0.8)); /* Cores do sistema */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--color-sidebar-hover, rgba(100, 68, 116, 1)); /* Hover do sistema */
        }
        
        /* Scrollbars espec√≠ficas para carrossel de cards */
        .carousel-track::-webkit-scrollbar,
        main::-webkit-scrollbar,
        aside::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        .carousel-track::-webkit-scrollbar-track,
        main::-webkit-scrollbar-track,
        aside::-webkit-scrollbar-track {
            background: var(--color-primary-end, rgba(42, 26, 58, 0.5));
        }
        .carousel-track::-webkit-scrollbar-thumb,
        main::-webkit-scrollbar-thumb,
        aside::-webkit-scrollbar-thumb {
            background: var(--color-sidebar-elements, rgba(80, 48, 96, 0.8));
            border-radius: 4px;
        }
        .carousel-track::-webkit-scrollbar-thumb:hover,
        main::-webkit-scrollbar-thumb:hover,
        aside::-webkit-scrollbar-thumb:hover {
            background: var(--color-sidebar-hover, rgba(100, 68, 116, 1));
        }

        /* Estilos para Acorde√£o na Sidebar */
        aside .accordion-item {
            border-bottom: 1px solid var(--color-sidebar-elements, rgba(80, 48, 96, 0.7));
            margin-bottom: 25px; /* AJUSTADO: Maior espa√ßamento entre os itens principais */
        }

        aside .accordion-header { /* Estilo para os H2 que s√£o cabe√ßalhos de acorde√£o */
            cursor: pointer;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            width: 100%;
            padding-bottom: 15px; /* AJUSTADO: Mais espa√ßo abaixo do cabe√ßalho */
            padding-right: 25px; /* Espa√ßo para a seta */
            margin-bottom: 0;
            font-size: 0.99em;
            color: var(--color-text-on-background, #fff) !important; /* Contraste autom√°tico */
            margin-top: 0; /* Garante que n√£o haja margem superior extra */
            border-radius: 6px;
            padding-left: 10px;
            padding-top: 10px;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        aside .accordion-header:hover,
        aside .accordion-header.active {
            background: var(--color-sidebar-elements-alpha, rgba(80, 48, 96, 0.8)) !important;
            box-shadow: 0 2px 8px var(--color-primary-light, rgba(80, 48, 96, 0.4)) !important;
        }
        
        aside .accordion-header.active {
            background: var(--color-sidebar-hover-alpha, rgba(100, 68, 116, 0.9)) !important;
        }
        
        /* Removemos o estilo global de aside h2 para n√£o conflitar com accordion-header */
        /* aside h2 { ... } */


        aside .accordion-icon {
            font-size: 0.8em;
            margin-left: auto;
            flex-shrink: 0;
        }

        aside .accordion-content {
            padding-left: 10px; 
            padding-top: 5px; 
            padding-bottom: 10px; 
            display: none; /* Come√ßa fechado */
        }
        aside .accordion-content ul { /* Para #categoriesList e #toolsCategoriesList */
            padding: 0; 
            margin:0;
            list-style: none; /* Garante que n√£o haja marcadores de lista padr√£o */
        }
        aside .accordion-content ul li {
            margin-bottom: 15px; /* AJUSTADO: Espa√ßamento entre itens das subcategorias */
        }
        /* Fim Estilos Acorde√£o */

        /* Estilos para Sub-Acorde√µes dentro de EXCLUSIVO */
        .sub-accordion-item {
            margin-bottom: 15px;
        }
        
        .sub-accordion-header {
            width: 100%;
            background: transparent;
            border: none;
            color: var(--color-text-on-background, #d3d3d3) !important; /* Contraste autom√°tico */
            cursor: pointer;
            padding: 8px 25px 8px 15px; /* Ajustado: mais padding √† direita para a seta */
            text-align: left;
            border-radius: 4px;
            font-size: 0.9em;
            transition: background-color 0.2s ease, color 0.2s ease;
            display: flex;
            justify-content: flex-start;
            align-items: center;
        }
        
        .sub-accordion-header:hover,
        .sub-accordion-header.active {
            background: var(--color-sidebar-elements-alpha, rgba(80, 48, 96, 0.7)) !important;
            color: #fff !important;
        }
        
        .sub-accordion-content {
            padding-left: 20px;
            padding-top: 10px;
        }
        
        .sub-accordion-icon {
            font-size: 0.7em;
            margin-left: auto;
            flex-shrink: 0;
        }
        
        /* Estilos para Terceiro N√≠vel - Cards no Menu */
        .sub-sub-accordion-item {
            margin-bottom: 8px;
            margin-left: 15px;
        }
        
        .sub-sub-accordion-header {
            width: 100%;
            background: transparent;
            border: none;
            color: var(--color-text-on-background, #b8b8b8) !important; /* Contraste autom√°tico */
            cursor: pointer;
            padding: 6px 20px 6px 10px;
            text-align: left;
            border-radius: 3px;
            font-size: 0.85em;
            transition: background-color 0.2s ease, color 0.2s ease;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            border-left: 2px solid var(--color-sidebar-elements, rgba(128, 76, 154, 0.3));
        }
        
        .sub-sub-accordion-header:hover,
        .sub-sub-accordion-header.active {
            background: var(--color-sidebar-elements-alpha, rgba(128, 76, 154, 0.4)) !important;
            color: #fff !important;
            border-left-color: var(--color-sidebar-hover, rgba(128, 76, 154, 0.8)) !important;
        }
        
        .sub-sub-accordion-content {
            padding-left: 15px;
            padding-top: 5px;
        }
        
        .card-menu-item {
            display: flex;
            align-items: center;
            padding: 4px 8px;
            margin: 2px 0;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8em;
            color: #a8a8a8;
            transition: all 0.2s ease;
            border-left: 2px solid transparent;
        }
        
        .card-menu-item:hover {
            background: var(--color-sidebar-hover-alpha, rgba(128, 76, 154, 0.6)) !important; /* MAIS DESTACADO: era 0.2, agora 0.6 */
            color: #fff !important;
            border-left-color: var(--color-sidebar-hover, rgba(128, 76, 154, 1)) !important; /* MAIS DESTACADO: era sidebar-elements */
            transform: translateX(3px) !important; /* EFEITO: leve movimento para a direita */
            transition: all 0.3s ease !important;
        }
        
        .card-menu-item.active {
            background: var(--color-sidebar-hover-alpha, rgba(128, 76, 154, 0.8)) !important; /* MAIS DESTACADO: era 0.3, agora 0.8 */
            color: #fff !important;
            border-left-color: var(--color-sidebar-hover, rgba(128, 76, 154, 1)) !important;
            transform: translateX(5px) !important; /* EFEITO: movimento mais acentuado para ativo */
        }

        .card-menu-item.menu-hover-highlight {
            background: rgba(255, 193, 7, 0.2) !important;
            color: #FFD700 !important;
            border-left: 2px solid #FFD700 !important;
            transition: all 0.3s ease !important;
        }
        
        .card-menu-icon {
            width: 14px;
            height: 14px;
            margin-right: 6px;
            opacity: 0.7;
        }
        /* Fim Estilos Terceiro N√≠vel */

        /* Ajustes para o Modal de Curadoria - GERiAH Style */
        #curationModal .modal-content {
            /* Herda a maioria dos estilos de .modal-content */
            background: linear-gradient(135deg, var(--color-bg-dark, #100818), var(--color-primary-dark-border, #2A1A3A)) !important; /* MAIS ESCURO: igual ao modal padr√£o */
        }
        /* Estilos para o Modal P.A.I (Painel de Acesso Imediato) */
        #paiModal .modal-content {
            /* Herda o fundo escuro do modal padr√£o */
            background: linear-gradient(135deg, var(--color-bg-dark, #100818), var(--color-primary-dark-border, #2A1A3A)) !important; /* MAIS ESCURO: consistente */
            height: 90%; /* Ajustar conforme necessidade */
            width: 90%; /* Ajustar conforme necessidade */
            max-width: 1400px; /* Um pouco maior para ferramentas complexas */
            display: flex; /* Para organizar t√≠tulo e iframe */
            flex-direction: column; /* T√≠tulo acima, iframe abaixo */
        }
        #paiModal iframe {
            flex-grow: 1; /* Iframe ocupa o espa√ßo restante */
            border-radius: 0 0 6px 6px; /* Se o modal-content tiver border-radius */
        }

        #curationModal h2 {
            font-size: 1.5em;
            margin-bottom: 20px;
            color: #fff;
        }
        #curationConfirm p, #curationReview h3, #curationList li {
            color: #e5e5e5;
        }
        #curationConfirm button, #curationReview button {
            background-color: var(--color-primary-solid, rgba(100, 68, 116, 0.9)) !important;
            border: 1px solid var(--color-primary-light, rgba(120, 88, 136, 1)) !important;
            padding: 10px 15px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease;
            color: #fff !important;
        }
        #curationConfirm button:hover, #curationReview button:hover {
            background-color: var(--color-primary-light, rgba(120, 88, 136, 1)) !important;
            border-color: var(--color-secondary-solid, rgba(140, 108, 156, 1)) !important;
        }
        #curationConfirm button#curateNo, #curationReview button#curateBack { /* Bot√£o secund√°rio */
            background-color: rgba(70, 70, 70, 0.8);
            border-color: rgba(90,90,90,1);
        }
        #curationConfirm button#curateNo:hover, #curationReview button#curateBack:hover {
            background-color: rgba(90, 90, 90, 0.9);
            border-color: rgba(110,110,110,1);
        }
        #curationList input[type=checkbox] {
            margin-right: 8px;
            accent-color: var(--color-primary-solid, #804C9A) !important;
        }

        /* Media Query para Telas Pequenas (Mobile) */
        @media (max-width: 768px) {
            body { padding-top: 70px; } /* Ajusta padding do body */
            header {
                justify-content: flex-start; /* Alinha itens √† esquerda */
            }
            .menu-toggle {
                display: block; /* Mostra o bot√£o hamburger no mobile */
                color: #ffffff !important; /* Cor branca para contraste no mobile */
                text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5); /* Sombra para melhor legibilidade */
            }
            aside {
                transform: translateX(-100%); /* Esconde a sidebar por padr√£o no mobile */
                left: 0; /* Garante que o ponto de partida seja 0 */
                box-shadow: 2px 0 5px rgba(0,0,0,0.3); /* Sombra para destacar quando aberta */
            }
            main {
                margin-left: 0; /* Main ocupa largura total quando sidebar est√° oculta */
            }

            /* Estado: Sidebar aberta */
            body.sidebar-open aside {
                transform: translateX(0); /* Mostra a sidebar */
            }
            body.sidebar-open main {
                margin-left: 250px; /* Main √© empurrado para a direita pela sidebar */
            }
            /* Opcional: Adicionar um overlay escuro quando a sidebar estiver aberta */
            body.sidebar-open::after {
                content: '';
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: rgba(0,0,0,0.5);
                z-index: 980; /* Abaixo da sidebar, acima do main */
            }

            /* Ajustes para o bot√£o de Meus Cursos no mobile */
            #myCoursesBtn {
                margin-left: auto; /* Empurra para a direita para alinhar ao final do header */
            }

            .carousel-track {
                /* Reduzir padding para telas menores */
                padding: 80px 60px 80px 60px;
            }

            .carousel-track::before,
            .carousel-track::after {
                width: 100px; /* Largura do esfuma√ßado reduzida */
            }

            .carousel-track::before {
                background: linear-gradient(to right, #100818 30%, rgba(16, 8, 24, 0.65) 75%, rgba(16, 8, 24, 0) 100%);
            }

            .carousel-track::after {
                background: linear-gradient(to left, #100818 30%, rgba(16, 8, 24, 0.65) 75%, rgba(16, 8, 24, 0) 100%);
            }
            
            /* Ajustar posi√ß√£o da lista de resultados no mobile */
            .search-results {
                left: 260px !important;
                width: 300px !important;
                max-width: calc(100vw - 270px);
                top: 75px !important;
                max-height: 350px;
            }
            
            /* Quando sidebar est√° fechada no mobile, lista fica mais √† esquerda */
            body:not(.sidebar-open) .search-results {
                left: 10px !important;
                width: 280px !important;
                max-width: calc(100vw - 20px);
            }
        }

        .access-course-button {
            background-color: var(--color-primary-solid, #804C9A) !important;
            border: none;
            padding: 8px 15px;
            margin-top: 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            display: block; /* Ocupa a largura total */
            width: calc(100% - 0px); /* Ajusta para preencher o info div */
            text-align: center;
            text-decoration: none; /* Remove underline para links */
            color: #fff !important;
        }
        .access-course-button:hover {
            background-color: var(--color-primary-light, #6C3D82) !important;
        }
        /* Fim Novos estilos para bot√£o Acessar */

        /* Estilos para Sub-Acorde√µes dentro de EXCLUSIVO */

        /* Estilo para mensagens de instru√ß√£o */
        .instruction-message {
            color: #ccc;
            text-align: left;
            margin: 80px 30px 50px 30px;
            font-size: 1.2em;
            line-height: 1.4;
        }
        
        /* Logo discreto de suporte */
        .support-logo {
            width: 48px;
            height: 48px;
            opacity: 1.0; /* Totalmente opaco/aceso */
            cursor: pointer;
            transition: opacity 0.3s ease, transform 0.3s ease;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            margin-left: auto;
            margin-right: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .support-logo:hover {
            opacity: 1.0; /* Mant√©m totalmente opaco no hover */
            transform: scale(1.1);
        }
        
        .support-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 6px;
        }
        
        /* Quando o toggle est√° vis√≠vel, logo fica mais vis√≠vel */
        .support-logo.toggle-visible {
            opacity: 1.0; /* Totalmente vis√≠vel */
            background: rgba(255, 107, 53, 0.2);
            border: 2px solid rgba(255, 107, 53, 0.5);
        }
        
        .support-logo.toggle-visible:hover {
            opacity: 1.0; /* Mant√©m totalmente vis√≠vel */
            background: rgba(255, 107, 53, 0.3);
        }
        
        /* Ajustar posicionamento no header */
        header .support-logo {
            position: relative;
        }
        
        /* Logo vis√≠vel mesmo no modo de edi√ß√£o */
        body.edit-mode .support-logo {
            opacity: 0.8; /* Mais vis√≠vel no modo de edi√ß√£o */
            background: rgba(255, 107, 53, 0.1);
        }
        
        body.edit-mode .support-logo:hover {
            opacity: 1.0; /* Totalmente vis√≠vel no hover do modo de edi√ß√£o */
        }
        
        /* Estilos para itens personalizados */
        .customized-item {
            position: relative;
            background: rgba(76, 175, 80, 0.1) !important;
            border-left: 3px solid #4CAF50 !important;
        }
        
        .customized-item::before {
            content: "‚ú®";
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 10px;
            opacity: 0.7;
        }
        
        body.edit-mode .customized-item {
            background: rgba(255, 193, 7, 0.2) !important;
            border-left: 3px solid #FFC107 !important;
        }
        
        body.edit-mode .customized-item::before {
            content: "‚úèÔ∏è";
        }
        
        /* Estilos para badges do menu Meus Apps */
        .check-icon {
            background: linear-gradient(45deg, #4CAF50, #66BB6A);
            font-size: 0.8em;
            padding: 2px 5px;
            border-radius: 50%;
            margin-right: 8px;
            width: 18px;
            height: 18px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(76, 175, 80, 0.3);
            animation: check-glow 3s infinite;
        }
        
        /* √çcone de check para apps individuais funcionais */
        .app-check {
            color: #4CAF50;
            font-size: 0.9em;
            margin-right: 6px;
            text-shadow: 0 1px 2px rgba(76, 175, 80, 0.3);
        }
        
        /* √çcone de pendente para apps n√£o testados ainda */
        .app-pending {
            color: #FF9800;
            font-size: 0.9em;
            margin-right: 6px;
            text-shadow: 0 1px 2px rgba(255, 152, 0, 0.3);
        }
        
        .apps-counter {
            color: #4CAF50;
            font-size: 0.9em;
            margin-right: 100px !important;
        }
        
        @keyframes check-glow {
            0%, 100% { 
                box-shadow: 0 2px 4px rgba(76, 175, 80, 0.3);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 2px 8px rgba(76, 175, 80, 0.6);
                transform: scale(1.05);
            }
        }
        
        /* Hover effect para o header Meus Apps */
        .accordion-header:has(.check-icon):hover .check-icon {
            background: linear-gradient(45deg, #66BB6A, #81C784);
            transform: scale(1.1);
        }
        
        .accordion-header:has(.apps-counter):hover .apps-counter {
            background: rgba(76, 175, 80, 1);
            transform: scale(1.05);
        }
        
        /* Indicadores de status das subcategorias */
        .subcat-status {
            font-size: 0.8em;
            margin-right: 6px;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .subcat-status.complete {
            color: #4CAF50; /* Verde - todos os apps funcionam */
        }
        
        .subcat-status.partial {
            color: #FF9800; /* Laranja - alguns apps reservados */
        }
        
        .subcat-status.empty {
            color: #757575; /* Cinza - nenhum app funcional */
        }
        
        /* Estilo para subcategorias n√£o implementadas - visual desbotado */
        .sub-accordion-header:has(.subcat-status.empty) {
            opacity: 0.5;
            color: #999999 !important;
        }
        
        .sub-accordion-header:has(.subcat-status.empty) img {
            opacity: 0.4;
            filter: grayscale(50%);
        }
        
        .sub-accordion-header:has(.subcat-status.empty):hover {
            opacity: 0.7;
            background: var(--color-primary-light, rgba(80, 48, 96, 0.3)) !important;
        }

        /* Esconder contadores quando modo de edi√ß√£o est√° inativo */
        body:not(.edit-mode) .apps-counter {
            display: none !important;
        }
        
        /* Mostrar contadores apenas quando modo de edi√ß√£o est√° ativo */
        body.edit-mode .apps-counter {
            display: inline !important;
        }

        /* Badge USER */
        .user-badge {
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: rgba(76, 175, 80, 0.9);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            z-index: 999;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(76, 175, 80, 0.3);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
            opacity: 0.7;
            pointer-events: none;
        }

        .user-badge:hover {
            opacity: 1;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
        }


        /* Estilos para categoria MEUS FAVORITOS */
        .add-favorite-placeholder {
            list-style: none;
            margin: 10px 0;
        }

        .add-favorite-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--color-primary-darker, #4A148C), var(--color-primary-solid, #6A1B9A)); /* DIN√ÇMICO: Gradiente com cores do sistema */
            border: none;
            padding: 12px 15px;
            cursor: pointer;
            font-size: 0.9rem;
            color: #ffffff; /* Texto branco para contraste */
            font-weight: 500; /* Texto mais destacado */
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border-radius: 6px; /* Bordas arredondadas */
        }

        /* S√≠mbolo "+" do bot√£o adicionar favorito - DIN√ÇMICO */
        .add-favorite-btn span {
            color: var(--text-brightness-color, #ffffff) !important; /* DIN√ÇMICO: usa exatamente a mesma vari√°vel do contraste do usu√°rio */
            filter: brightness(1.2) saturate(1.1); /* Leve destaque no s√≠mbolo */
            transition: all 0.3s ease;
        }

        .add-favorite-btn:hover {
            background: linear-gradient(135deg, var(--color-primary-solid, #6A1B9A), var(--color-sidebar-hover, #7B1FA2)); /* DIN√ÇMICO: Gradiente hover com cores do sistema */
            transform: translateY(-1px);
            box-shadow: 0 4px 12px var(--color-primary-shadow, rgba(74, 20, 140, 0.4)); /* DIN√ÇMICO: Sombra com cor do sistema */
        }

        /* Efeito especial no s√≠mbolo "+" durante hover - DIN√ÇMICO */
        .add-favorite-btn:hover span {
            transform: scale(1.1) rotate(90deg); /* Efeito de rota√ß√£o e escala no hover */
            filter: brightness(1.5) saturate(1.3) drop-shadow(0 0 8px var(--text-brightness-color, #ffffff)); /* Brilho e glow din√¢mico */
            color: var(--text-brightness-color, #ffffff) !important;
        }

        .add-favorite-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Favoritos individuais */
        .favorite-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            margin: 8px 0;
            padding: 10px;
            transition: all 0.3s ease;
            position: relative;
        }

        .favorite-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 215, 0, 0.5);
        }

        .favorite-item .favorite-link {
            color: #e5e5e5;
            text-decoration: none;
            display: block;
            font-weight: 500;
        }

        .favorite-item .favorite-link:hover {
            color: #FFD700;
        }

        .favorite-delete-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255, 0, 0, 0.7);
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
            display: none;
        }

        body.edit-mode .favorite-delete-btn {
            display: block;
        }

        /* Estilos para o bot√£o de toggle do menu (hamburger) */

        /* Badge USER integrado no sidebar - ATUALIZADO para usar vari√°veis CSS */
        .sidebar-user-header {
            position: sticky;
            top: 0;
            background: var(--color-primary-alpha, rgba(80, 48, 96, 0.95));
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            color: var(--color-text-white, #fff);
            padding: 15px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1em;
            border-bottom: 2px solid var(--color-primary-solid, #503060);
            z-index: 101;
            margin: 0;
        }

        .sidebar-user-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 30%, rgba(255, 255, 255, 0.1) 50%, transparent 70%);
            pointer-events: none;
        }

        /* Remover badge fixo */
        .user-badge {
            display: none;
        }

        /* Estilos para Sub-Acorde√µes dentro de EXCLUSIVO */

        /* Estilos para o campo de busca do menu - ATUALIZADO para usar vari√°veis CSS */
        .menu-search-container {
            position: sticky;
            top: 0;
            background: var(--color-primary-light, rgba(80, 48, 96, 0.7));
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            margin: 0;
            padding: 15px;
            border-bottom: 1px solid var(--color-border-light, rgba(255, 255, 255, 0.1));
            border-radius: 6px;
            z-index: 100;
        }
        
        /* Container do conte√∫do do menu com scroll */
        .menu-content {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 0 15px 20px 15px;
        }
        
        .search-input-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        #menuSearchInput {
            width: 100%;
            padding: 10px 35px 10px 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 0.9em;
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        
        #menuSearchInput:focus {
            outline: none;
            border-color: var(--color-primary-solid, #804C9A);
            background: var(--color-primary-light, rgba(128, 76, 154, 0.15));
            box-shadow: 0 0 10px var(--color-primary-light, rgba(128, 76, 154, 0.3));
        }
        
        #menuSearchInput::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }
        
        .clear-search-btn {
            position: absolute;
            right: 8px;
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.6);
            font-size: 18px;
            cursor: pointer;
            padding: 2px 6px;
            border-radius: 3px;
            transition: all 0.2s ease;
        }
        
        .clear-search-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }
        
        .search-results {
            position: fixed;
            top: 70px;
            left: 250px;
            width: 350px;
            background: var(--color-sidebar-elements-alpha, rgba(59, 32, 74, 0.98));
            border: 1px solid var(--color-primary-light, rgba(128, 76, 154, 0.4));
            border-radius: 8px;
            max-height: 400px;
            overflow-y: auto;
            z-index: 9999;
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
            margin: 10px;
            color: var(--color-text-on-sidebar, #ffffff);
        }
        
        .search-result-item {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: background-color 0.2s ease;
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .search-result-item:last-child {
            border-bottom: none;
        }
        
        .search-result-item:hover {
            background: var(--color-primary-light, rgba(128, 76, 154, 0.2));
        }
        
        .search-result-item:active {
            background: var(--color-primary-solid, rgba(128, 76, 154, 0.4));
            transform: translateX(2px);
        }
        
        .search-result-item.clicked {
            background: rgba(255, 215, 0, 0.2);
            border-left: 3px solid #FFD700;
            animation: itemClicked 0.3s ease;
        }
        
        @keyframes itemClicked {
            0% { transform: translateX(0); }
            50% { transform: translateX(4px); }
            100% { transform: translateX(0); }
        }
        
        .search-result-name {
            color: var(--color-text-on-sidebar, #fff);
            font-weight: 500;
            font-size: 0.9em;
        }
        
        .search-result-path {
            color: var(--color-text-on-sidebar, rgba(255, 255, 255, 0.7));
            font-size: 0.8em;
            font-style: italic;
        }
        
        .search-no-results {
            padding: 15px;
            text-align: center;
            color: var(--color-text-on-sidebar, rgba(255, 255, 255, 0.6));
            font-style: italic;
        }
        
        /* Highlight do termo pesquisado */
        .search-highlight {
            background: var(--color-primary-light, rgba(255, 235, 59, 0.3));
            color: var(--color-text-on-main, #fff);
            padding: 1px 2px;
            border-radius: 2px;
        }
        
        /* Destaque dos itens encontrados no menu */
        .search-highlighted-item {
            background: var(--color-primary-light, rgba(255, 235, 59, 0.2)) !important;
            border-left: 3px solid var(--color-primary-solid, #FFD700) !important;
            box-shadow: 0 0 8px var(--color-primary-light, rgba(255, 215, 0, 0.4)) !important;
            animation: searchPulse 1.5s ease-in-out infinite;
            color: var(--color-text-on-sidebar, #ffffff) !important;
            opacity: var(--text-brightness, 1) !important;
        }
        
        @keyframes searchPulse {
            0%, 100% { 
                box-shadow: 0 0 8px var(--color-primary-light, rgba(255, 215, 0, 0.4));
            }
            50% { 
                box-shadow: 0 0 12px var(--color-primary-solid, rgba(255, 215, 0, 0.6));
            }
        }

        /* Estilo para mensagens de instru√ß√£o */
        .instruction-message {
            color: #ccc;
            text-align: left;
            margin: 80px 30px 50px 30px;
            font-size: 1.2em;
            line-height: 1.4;
        }

        /* ================ ESTILOS PARA FAVORITOS ================ */
        .favorite-star {
            display: inline-block;
            font-size: 20px;
            color: #999;
            cursor: pointer;
            margin-right: 8px;
            transition: all 0.3s ease;
            user-select: none;
            width: 24px;
            height: 24px;
            text-align: center;
            line-height: 24px;
            border: 1px solid #999;
            border-radius: 3px;
            background: rgba(255,255,255,0.1);
        }

        .favorite-star:hover {
            color: #FFD700;
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.2);
            transform: scale(1.1);
        }

        .favorite-star.favorited {
            color: #FFD700;
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.3);
            text-shadow: 0 0 8px rgba(255, 215, 0, 0.5);
        }

        .favorite-star.favorited:hover {
            color: #FFA500;
            border-color: #FFA500;
            background: rgba(255, 165, 0, 0.3);
        }

        /* Estilos espec√≠ficos para diferentes tipos de itens do menu */
        .sub-accordion-header .favorite-star {
            position: absolute;
            right: 35px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }

        .sub-accordion-header.has-favorite {
            padding-right: 55px;
        }

        .sub-sub-accordion-header .favorite-star {
            position: absolute;
            right: 35px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 10;
        }

        .sub-sub-accordion-header.has-favorite {
            padding-right: 55px;
        }

        .card-menu-item .favorite-star {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1000;
            font-size: 18px;
            width: 22px;
            height: 22px;
            line-height: 20px;
            pointer-events: auto;
        }

        .card-menu-item.has-favorite {
            padding-right: 35px;
            position: relative;
        }

        /* Garantir que estrelas sejam clic√°veis */
        .favorite-star {
            pointer-events: auto !important;
            z-index: 1000 !important;
        }

        /* Anima√ß√£o quando adiciona/remove favorito */
        @keyframes favoriteAdded {
            0% { transform: scale(1); }
            50% { transform: scale(1.5); color: #FFD700; }
            100% { transform: scale(1); }
        }

        .favorite-star.animate-favorite {
            animation: favoriteAdded 0.6s ease;
        }

        /* Toast de notifica√ß√£o para favoritos */
        .favorite-toast {
            position: fixed;
            top: 90px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: #FFD700;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 10000;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.3s ease;
            border: 1px solid #FFD700;
        }

        .favorite-toast.show {
            opacity: 1;
            transform: translateX(0);
        }

        .favorite-toast.removing {
            opacity: 0;
            transform: translateX(100px);
        }

        /* Estilos limpos para favoritos */
        .clean-favorite-item {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border-radius: 6px;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.05);
            margin-bottom: 2px;
        }

        .clean-favorite-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .favorite-item-name {
            flex: 1;
            margin-left: 8px;
            font-size: 14px;
            color: #e0e0e0;
        }

        .clean-star {
            position: absolute !important;
            right: 8px !important;
            top: 50% !important;
            transform: translateY(-50%) !important;
            width: 20px !important;
            height: 20px !important;
            font-size: 14px !important;
            background: rgba(255, 255, 255, 0.1) !important;
            border: 1px solid rgba(255, 255, 255, 0.2) !important;
            border-radius: 50% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            color: #999 !important;
            transition: all 0.2s ease !important;
        }

        .clean-star:hover {
            background: rgba(255, 0, 0, 0.2) !important;
            color: #ff6b6b !important;
            border-color: #ff6b6b !important;
        }

        .clean-add-btn {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px dashed rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: #ccc;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
        }

        .clean-add-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
            color: #fff;
        }

        /* √çcones dos favoritos com cor amarela */
        .favorite-icon-selected {
            filter: hue-rotate(45deg) brightness(1.5) contrast(1.2) !important;
            opacity: 0.9 !important;
        }

        .favorite-icon-added {
            filter: hue-rotate(45deg) brightness(1.5) contrast(1.2) !important;
            opacity: 0.9 !important;
        }

        /* Controle de visibilidade do modo edi√ß√£o */
        .edit-mode-only {
            display: none !important;
        }

        body.edit-mode .edit-mode-only {
            display: flex !important;
        }

        /* Estilos para modal de substitui√ß√£o */
        .existing-favorites-list {
            padding: 10px;
        }

        .replace-favorite-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .replace-favorite-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
        }

        .replace-favorite-item:last-child {
            margin-bottom: 0;
        }

        .replace-favorite-item img {
            width: 24px;
            height: 24px;
            margin-right: 12px;
            border-radius: 4px;
        }

        .replace-favorite-info {
            flex: 1;
        }

        .replace-favorite-name {
            font-weight: bold;
            color: #e0e0e0;
            margin-bottom: 4px;
        }

        .replace-favorite-type {
            font-size: 12px;
            color: #999;
        }

        .replace-favorite-btn {
            background: #ff6b35;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
        }

        .replace-favorite-btn:hover {
            background: #e55a2b;
        }

        .new-favorite-info {
            display: flex;
            align-items: center;
        }

        .new-favorite-info img {
            width: 32px;
            height: 32px;
            margin-right: 15px;
            border-radius: 6px;
        }

        .new-favorite-details h4 {
            margin: 0 0 5px 0;
            color: #4CAF50;
            font-size: 16px;
        }

        .new-favorite-details p {
            margin: 0;
            color: #81C784;
            font-size: 14px;
        }

        /* Estilos para o Modal de Busca de Treinamentos */
        .training-filter-btn {
            background: linear-gradient(45deg, var(--color-primary-solid), var(--color-primary-light));
            color: white;
            border: 1px solid var(--color-primary-light);
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .training-filter-btn:hover {
            background: linear-gradient(45deg, var(--color-primary-light), var(--color-sidebar-hover));
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .training-filter-btn.active {
            background: linear-gradient(45deg, var(--color-sidebar-hover), var(--color-primary-light));
            box-shadow: 0 0 15px var(--color-primary-light);
        }

        .training-result-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .training-result-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--color-primary-light);
            transform: translateY(-2px);
        }

        .training-result-title {
            color: #fff;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .training-result-description {
            color: #ccc;
            font-size: 14px;
            margin-bottom: 8px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .training-result-meta {
            color: #999;
            font-size: 12px;
            display: flex;
            gap: 15px;
        }
    </style>

</head>
<body>
    <header>
        <button id="menuToggle" class="menu-toggle">‚ò∞</button>
        <h3 id="headerTitle">Acessos</h3>
        <div id="supportLogo" class="support-logo">
            <img id="logoImage" src="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png" 
                alt="GERiAH Support" 
                title="Clique para acessar ferramentas de suporte">
            <div class="logo-edit-tooltip">üñºÔ∏è Clique para alterar logo</div>
        </div>

        <!-- Bot√£o Gerar HTML - INDEPENDENTE do modo de edi√ß√£o -->
        <button id="generateClientHtmlBtn" style="
            background: linear-gradient(45deg, #ff6b35, #ff8555);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8em;
            font-weight: bold;
            margin-right: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        " title="üì¶ Gerar HTML Personalizado para Cliente"
        onmouseover="this.style.transform='scale(1.05)'; this.style.boxShadow='0 4px 8px rgba(0,0,0,0.3)';"
        onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.2)';">
            üì¶ Gerar
        </button>

        <div class="edit-mode-toggle" id="editModeToggleContainer" style="display: none;">
            <label class="toggle-switch">
                <input type="checkbox" id="editModeToggle">
                <span class="toggle-slider"></span>
            </label>
            <span id="toggleLabel">Editar</span>
        </div>
        <button id="myCoursesBtn">iA</button>
    </header>
    <aside>
        <div class="sidebar-user-header">
            <img id="userTypeLogo" src="https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png" alt="User Logo" style="width: 40px; height: 40px; margin-right: 8px; vertical-align: middle; cursor: pointer; border-radius: 3px; object-fit: cover;">
            <div class="user-logo-edit-tooltip">üñºÔ∏è Clique para alterar logo principal</div>
            <span id="userTypeLabel">INDIVIDUAL</span>
        </div>
        
        <!-- Campo de busca do menu -->
        <div class="menu-search-container">
            <div class="search-input-wrapper">
                <input type="text" id="menuSearchInput" placeholder="üîç Buscar no menu..." autocomplete="off">
                <button id="clearSearchBtn" class="clear-search-btn" style="display: none;">&times;</button>
            </div>
        </div>
        
        <!-- Conte√∫do do menu com scroll -->
        <div class="menu-content">
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <img src="https://api.iconify.design/tabler/apps.svg?color=%23e5e5e5" alt="MeusApps Logo" style="width: 24px; height: 24px; margin-right: 10px; vertical-align: middle;">
                    CEL APPS 
                    <span class="apps-counter">45</span>
                    <span class="accordion-icon">‚ñ∫</span>
                </h2>
                <div class="accordion-content">
                    <ul id="meusAppsMainItemsList">
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/health-recognition.svg?color=%23e5e5e5" alt="Sa√∫de Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    <span class="subcat-status partial">‚óè</span>
                                    Sa√∫de
                                    <span class="apps-counter" style="padding-right: 200px !important; margin-right: 0 !important;">4</span>
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <ul id="saudeItemsList"><li>Carregando...</li></ul>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/message.svg?color=%23e5e5e5" alt="Comunicar Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    <span class="subcat-status partial">‚óè</span>
                                    Comunicar
                                    <span class="apps-counter" style="padding-right: 200px !important; margin-right: 0 !important;">6</span>
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <ul id="comunicacaoItemsList"><li>Carregando...</li></ul>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/credit-card.svg?color=%23e5e5e5" alt="Banco Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    <span class="subcat-status partial">‚óè</span>
                                    Banco
                                    <span class="apps-counter" style="padding-right: 200px !important; margin-right: 0 !important;">6</span>
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <ul id="bancoItemsList"><li>Carregando...</li></ul>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/pizza.svg?color=%23e5e5e5" alt="Alimenta√ß√£o Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    <span class="subcat-status partial">‚óè</span>
                                    Alimenta√ß√£o
                                    <span class="apps-counter" style="padding-right: 200px !important; margin-right: 0 !important;">2</span>
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <ul id="alimentacaoItemsList"><li>Carregando...</li></ul>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/tool.svg?color=%23e5e5e5" alt="Utilidades Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    <span class="subcat-status partial">‚óè</span>
                                    Utilidades
                                    <span class="apps-counter" style="padding-right: 200px !important; margin-right: 0 !important;">20</span>
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <ul id="utilidadesItemsList"><li>Carregando...</li></ul>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/device-gamepad.svg?color=%23e5e5e5" alt="Lazer Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    <span class="subcat-status partial">‚óè</span>
                                    Lazer
                                    <span class="apps-counter" style="padding-right: 200px !important; margin-right: 0 !important;">5</span>
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <ul id="lazerItemsList"><li>Carregando...</li></ul>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/car.svg?color=%23e5e5e5" alt="Transporte Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    <span class="subcat-status partial">‚óè</span>
                                    Transporte
                                    <span class="apps-counter" style="padding-right: 200px !important; margin-right: 0 !important;">4</span>
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <ul id="transporteItemsList"><li>Carregando...</li></ul>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="category-separator"></div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <img src="https://api.iconify.design/tabler/gift.svg?color=%23e5e5e5" alt="Exclusivo Logo" style="width: 24px; height: 24px; margin-right: 10px; vertical-align: middle;">
                    EXCLUSIVO 
                    <span class="accordion-icon">‚ñ∫</span>
                </h2>
                <div class="accordion-content">
                    <ul id="paiMainItemsList">
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/video.svg?color=%23e5e5e5" alt="Videos Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    Videos Dispon√≠veis
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <ul id="videosItemsList"><li>Carregando...</li></ul>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/school.svg?color=%23e5e5e5" alt="Conteudo de Apoio Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    Conte√∫do de Apoio
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <div class="card-menu-item search-training-card" onclick="openTrainingSearchModal()" style="margin-bottom: 10px; cursor: pointer; background: linear-gradient(45deg, #4CAF50, #45a049); border: 1px solid #4CAF50;">
                                        <img src="https://api.iconify.design/tabler/search.svg?color=%23ffffff" alt="Buscar" class="card-menu-icon" style="filter: brightness(1.2);">
                                        üîç Buscar Treinamentos
                                    </div>
                                    <ul id="categoriesList"><li>Carregando...</li></ul>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/tools.svg?color=%23e5e5e5" alt="Ferramentas Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    Ferramentas & Neg√≥cios
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <ul id="paiItemsList">
                                        <li>
                                            <div class="sub-sub-accordion-item">
                                                <button class="sub-sub-accordion-header">
                                                    <img src="https://api.iconify.design/tabler/briefcase.svg?color=%23b8b8b8" alt="FNW Assessoria Logo" style="width: 16px; height: 16px; margin-right: 6px; vertical-align: middle;">
                                                    FNW Assessoria
                                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                                </button>
                                                <div class="sub-sub-accordion-content" style="display: none;">
                                                    <div class="card-menu-item has-favorite" data-card-name="FNW - Formul√°rio Estrat√©gico">
                                                        <span class="favorite-star" data-item-name="FNW - Formul√°rio Estrat√©gico" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'FNW - Formul√°rio Estrat√©gico')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/file-text.svg?color=%23a8a8a8" alt="Formul√°rio" class="card-menu-icon">
                                                        FNW - Formul√°rio Estrat√©gico
                                                    </div>
                                                    <div class="card-menu-item has-favorite" data-card-name="FNW - ROI Maker">
                                                        <span class="favorite-star" data-item-name="FNW - ROI Maker" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'FNW - ROI Maker')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/calculator.svg?color=%23a8a8a8" alt="ROI" class="card-menu-icon">
                                                        FNW - ROI Maker
                                                    </div>
                                                    <div class="card-menu-item has-favorite" data-card-name="Painel ETO">
                                                        <span class="favorite-star" data-item-name="Painel ETO" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'Painel ETO')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/layout-dashboard.svg?color=%23a8a8a8" alt="Painel" class="card-menu-icon">
                                                        Painel ETO
                                                    </div>
                                                    <div class="card-menu-item has-favorite" data-card-name="MKT HUB">
                                                        <span class="favorite-star" data-item-name="MKT HUB" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'MKT HUB')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/code.svg?color=%23a8a8a8" alt="MKT HUB" class="card-menu-icon">
                                                        MKT HUB
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="sub-sub-accordion-item">
                                                <button class="sub-sub-accordion-header">
                                                    <img src="https://api.iconify.design/tabler/users-group.svg?color=%23b8b8b8" alt="50+ Logo" style="width: 16px; height: 16px; margin-right: 6px; vertical-align: middle;">
                                                    50+ | Maduros e Idosos
                                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                                </button>
                                                <div class="sub-sub-accordion-content" style="display: none;">
                                                    <div class="card-menu-item has-favorite" data-card-name="Longevidade">
                                                        <span class="favorite-star" data-item-name="Longevidade" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'Longevidade')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/plant.svg?color=%23a8a8a8" alt="Longevidade" class="card-menu-icon">
                                                        Longevidade
                                                    </div>
                                                    <div class="card-menu-item has-favorite" data-card-name="Analise CNIS">
                                                        <span class="favorite-star" data-item-name="Analise CNIS" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'Analise CNIS')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/file-text.svg?color=%23a8a8a8" alt="CNIS" class="card-menu-icon">
                                                        Analise CNIS
                                                    </div>
                                                    <div class="card-menu-item has-favorite" data-card-name="CNIS Suporte">
                                                        <span class="favorite-star" data-item-name="CNIS Suporte" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'CNIS Suporte')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/tool.svg?color=%23a8a8a8" alt="Suporte" class="card-menu-icon">
                                                        CNIS Suporte
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/brain.svg?color=%23e5e5e5" alt="Suporte IA Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    Suporte - IA
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <ul id="suporteIaItemsList">
                                        <li>
                                            <div class="sub-sub-accordion-item">
                                                <button class="sub-sub-accordion-header">
                                                    <img src="https://api.iconify.design/tabler/wand.svg?color=%23b8b8b8" alt="Wizzards Logo" style="width: 16px; height: 16px; margin-right: 6px; vertical-align: middle;">
                                                    Wizzards
                                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                                </button>
                                                <div class="sub-sub-accordion-content" style="display: none;">
                                                    <div class="card-menu-item has-favorite" data-card-name="IA Prompt Wizzard">
                                                        <span class="favorite-star" data-item-name="IA Prompt Wizzard" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'IA Prompt Wizzard')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/wand.svg?color=%23a8a8a8" alt="IA Prompt" class="card-menu-icon">
                                                        IA Prompt Wizzard
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="sub-sub-accordion-item">
                                                <button class="sub-sub-accordion-header">
                                                    <img src="https://api.iconify.design/tabler/robot.svg?color=%23b8b8b8" alt="Assistentes Logo" style="width: 16px; height: 16px; margin-right: 6px; vertical-align: middle;">
                                                    Assistentes
                                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                                </button>
                                                <div class="sub-sub-accordion-content" style="display: none;">
                                                    <div class="card-menu-item has-favorite" data-card-name="Chat Rosio Livia Geriah">
                                                        <span class="favorite-star" data-item-name="Chat Rosio Livia Geriah" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'Chat Rosio Livia Geriah')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/message-dots.svg?color=%23a8a8a8" alt="Chat Rosio" class="card-menu-icon">
                                                        Chat Rosio Livia Geriah
                                                    </div>
                                                    <div class="card-menu-item has-favorite" data-card-name="HumanIA">
                                                        <span class="favorite-star" data-item-name="HumanIA" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'HumanIA')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/users-group.svg?color=%23a8a8a8" alt="HumanIA" class="card-menu-icon">
                                                        HumanIA
                                                    </div>
                                                    <div class="card-menu-item has-favorite" data-card-name="London Lord">
                                                        <span class="favorite-star" data-item-name="London Lord" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'London Lord')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/user-hexagon.svg?color=%23a8a8a8" alt="London Lord" class="card-menu-icon">
                                                        London Lord
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="category-separator"></div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <img src="https://api.iconify.design/tabler/users.svg?color=%23e5e5e5" alt="Participe Logo" style="width: 24px; height: 24px; margin-right: 10px; vertical-align: middle;">
                    PARTICIPE 
                    <span class="accordion-icon">‚ñ∫</span>
                </h2>
                <div class="accordion-content">
                    <ul id="participeItemsList">
                        <li>
                            <div class="sub-accordion-item">
                                <button class="sub-accordion-header">
                                    <img src="https://api.iconify.design/tabler/handshake.svg?color=%23e5e5e5" alt="Parcerias Logo" style="width: 20px; height: 20px; margin-right: 8px; vertical-align: middle;">
                                    Parcerias
                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                </button>
                                <div class="sub-accordion-content" style="display: none;">
                                    <ul>
                                        <li>
                                            <div class="sub-sub-accordion-item">
                                                <button class="sub-sub-accordion-header">
                                                    <img src="https://api.iconify.design/tabler/building-store.svg?color=%23b8b8b8" alt="Empresas Logo" style="width: 16px; height: 16px; margin-right: 6px; vertical-align: middle;">
                                                    Empresas Parceiras
                                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                                </button>
                                                <div class="sub-sub-accordion-content" style="display: none;">
                                                    <div class="card-menu-item has-favorite" data-card-name="FNW Sinergias">
                                                        <span class="favorite-star" data-item-name="FNW Sinergias" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'FNW Sinergias')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/home.svg?color=%23a8a8a8" alt="FNW Sinergias" class="card-menu-icon">
                                                        FNW Sinergias
                                                    </div>
                                                    <div class="card-menu-item has-favorite" data-card-name="IDEIA21">
                                                        <span class="favorite-star" data-item-name="IDEIA21" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'IDEIA21')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/user.svg?color=%23a8a8a8" alt="IDEIA21" class="card-menu-icon">
                                                        IDEIA21
                                                    </div>
                                                    <div class="card-menu-item has-favorite" data-card-name="IPSOLON">
                                                        <span class="favorite-star" data-item-name="IPSOLON" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'IPSOLON')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/git-fork.svg?color=%23a8a8a8" alt="IPSOLON" class="card-menu-icon">
                                                        IPSOLON
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="sub-sub-accordion-item">
                                                <button class="sub-sub-accordion-header">
                                                    <img src="https://api.iconify.design/tabler/edit.svg?color=%23b8b8b8" alt="Feito Por Voc√™ Logo" style="width: 16px; height: 16px; margin-right: 6px; vertical-align: middle;">
                                                    Feito Por Voc√™
                                                    <span class="sub-accordion-icon">‚ñ∫</span>
                                                </button>
                                                <div class="sub-sub-accordion-content" style="display: none;">
                                                    <div class="card-menu-item has-favorite" data-card-name="Feito Por Voc√™">
                                                        <span class="favorite-star" data-item-name="Feito Por Voc√™" data-item-type="app" title="Adicionar aos favoritos" onclick="toggleFavoriteSimple(this, 'Feito Por Voc√™')">‚òÜ</span>
                                                        <img src="https://api.iconify.design/tabler/edit.svg?color=%23a8a8a8" alt="Feito Por Voc√™" class="card-menu-icon">
                                                        Feito Por Voc√™
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="category-separator"></div>
            <div class="accordion-item">
                <h2 class="accordion-header">
                    <img src="https://api.iconify.design/tabler/star.svg?color=%23FFD700" alt="Favoritos Logo" style="width: 24px; height: 24px; margin-right: 10px; vertical-align: middle;">
                    MEUS FAVORITOS 
                    <span class="apps-counter" id="favoritosCounter">0/7</span>
                    <span class="accordion-icon">‚ñ∫</span>
                </h2>
                <div class="accordion-content">
                    <ul id="favoritosItemsList">
                        <li class="add-favorite-placeholder">
                            <button class="add-favorite-btn" id="addFavoriteBtn">
                                <span style="font-size: 1.2em;">‚ûï</span>
                                Adicionar Favorito
                            </button> 
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </aside>
    
    <!-- Lista de resultados de busca lateral (fora do sidebar) -->
    <div id="searchResults" class="search-results" style="display: none;"></div>
    
    <main>
        <h1 id="mainTitle"></h1>
        <div id="coursesContainer"><p class="instruction-message">Selecione uma categoria no Menu e acesse os recursos.</p></div>
    </main>

    <!-- Painel de Personaliza√ß√£o de Cores (Modo Edi√ß√£o) -->
    <div class="color-customization-panel" id="colorCustomizationPanel">
        <div class="color-panel-header">
            üé® Personaliza√ß√£o de Cores
        </div>
        
        <div class="color-control-group">
            <label class="color-control-label">üé® Escolha sua Cor Principal</label>
            <div class="color-control">
                <input type="color" class="color-picker" id="primaryColorPicker" value="#503060">
                <div class="color-preview" id="primaryColorPreview" style="background: #503060;">
                    #503060
                </div>
            </div>
        </div>
        
        <div class="auto-colors-info">
            <div class="auto-color-item">
                <span class="auto-color-label">üéØ Elementos Principais:</span>
                <div class="auto-color-preview" id="autoMainPreview" style="background: #503060;"></div>
            </div>
            <div class="auto-color-item">
                <span class="auto-color-label">‚öôÔ∏è Elementos Secund√°rios:</span>
                <div class="auto-color-preview" id="autoSecondaryPreview" style="background: rgba(80, 48, 96, 0.7);"></div>
            </div>
            <div class="auto-color-item">
                <span class="auto-color-label">üåÖ Fundo da Aplica√ß√£o:</span>
                <div class="auto-color-preview" id="autoBackgroundPreview" style="background: #3B204A;"></div>
            </div>
        </div>
        
        <div class="color-info-text">
            üí° <strong>Autom√°tico:</strong> Ajustamos automaticamente os tons mais claros e escuros para uma harmonia perfeita!
        </div>
        
        <div class="color-control-group">
            <label class="color-control-label">‚ú® Contraste do Texto</label>
            <div class="text-brightness-control">
                <div class="brightness-slider-container">
                    <button type="button" class="contrast-btn" id="autoContrastBtn" style="
                        background: linear-gradient(45deg, #4CAF50, #45a049);
                        border: none;
                        padding: 8px 16px;
                        color: white;
                        border-radius: 4px;
                        cursor: pointer;
                        font-weight: bold;
                        margin-right: 10px;
                    ">ü§ñ Autom√°tico</button>
                    <button type="button" class="contrast-btn" id="manualContrastBtn" style="
                        background: #666;
                        border: none;
                        padding: 8px 16px;
                        color: white;
                        border-radius: 4px;
                        cursor: pointer;
                        margin-right: 10px;
                    ">‚úã Manual</button>
                    <select id="manualTextColor" style="
                        background: #333;
                        border: 1px solid #666;
                        color: white;
                        padding: 8px;
                        border-radius: 4px;
                        display: none;
                    ">
                        <option value="#ffffff">‚ö™ Branco</option>
                        <option value="#000000">‚ö´ Preto</option>
                        <option value="#cccccc">üîò Cinza Claro</option>
                        <option value="#666666">‚ö´ Cinza Escuro</option>
                    </select>
                </div>
                <div class="brightness-preview" id="textBrightnessPreview">
                    Modo: Autom√°tico (Detecta o melhor contraste)
                </div>
            </div>
            <div class="brightness-info">
                üí° Autom√°tico: detecta se precisa de texto preto ou branco | Manual: voc√™ escolhe
            </div>
        </div>
        
        <div class="color-actions">
            <button class="color-btn" id="applyColorsBtn">üíæ Salvar</button>
            <button class="color-btn secondary" id="resetColorsBtn">üîÑ Resetar</button>
        </div>
        
        <!-- Bot√µes de Export/Import -->
        <div class="export-import-section">
            <div style="margin: 20px 0 10px 0; color: #e0e0e0; font-weight: bold; font-size: 0.9em;">
                üì§üì• Backup & Restaura√ß√£o
            </div>
            <div class="export-import-actions">
                                                <button class="color-btn export-btn" id="exportConfigBtn">üì§ Fazer Backup</button>
                                                <label for="importConfigFile" class="color-btn import-btn">üì• Restaurar</label>
                <input type="file" id="importConfigFile" accept=".json" style="display: none;">
            </div>
            <div style="margin: 10px 0; color: #999; font-size: 0.8em;">
                üí° Inclui: cores, contraste, textos personalizados e logo
            </div>
        </div>

        <!-- Nota: Bot√£o de gera√ß√£o foi movido para o header (independente do modo de edi√ß√£o) -->
    </div>

    <div id="modal" class="modal hidden">
        <div class="modal-content">
            <span id="modalClose" class="close">&times;</span>
            <div id="courseDetails"></div>
        </div>
    </div>

    <!-- Modal de Curadoria -->
    <div id="curationModal" class="modal hidden">
    <div class="modal-content">
        <h2>Curadoria de Recursos</h2>
        <!-- Passo 1: adicionar/ignorar -->
        <div id="curationConfirm">
        <p id="curationMessage"></p>
        <p id="curationRemaining" style="font-weight:bold; margin:5px 0;"></p>
        <button id="curateYes">Sim</button>
        <button id="curateNo">N√£o</button>
        <button id="accessNowBtn" style="display:none;">Acessar Agora</button>
        </div>
        <!-- Passo 2: rever sele√ß√£o com nome/email -->
        <div id="curationReview" style="display:none; margin-top:15px;">
        <h3>Revise sua sele√ß√£o</h3>
        <ul id="curationList"></ul>
        <div style="margin-top:10px;">
            <button id="curateBack">Voltar</button>
            <button id="curateContinue">Continuar</button>
            <button id="curateFinish">Finalizar</button>
        </div>
        </div>
    </div>
    </div>

    <!-- NOVO Modal P.A.I. -->
    <div id="paiModal" class="modal hidden">
        <div class="modal-content pai-modal-content">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; padding-bottom:10px; border-bottom: 1px solid rgba(80, 48, 96, 0.7);">
                <h2 id="paiModalTitle" style="margin:0; font-size:1.4em; color: #fff;"></h2>
                <span id="paiModalClose" class="close" style="font-size:1.8em; cursor:pointer; color: #aaa;">&times;</span>
            </div>
            <iframe id="paiModalIframe" style="width:100%; height:100%; border:none; background-color: #fff;"></iframe>
        </div>
    </div>

    <!-- Modal de Confirma√ß√£o do Modo de Edi√ß√£o -->
    <div id="editModeConfirmModal" class="modal hidden">
        <div class="modal-content">
            <span id="editModeConfirmClose" class="close">&times;</span>
            <h2>üîß Ativar Modo de Edi√ß√£o</h2>
            <p>No modo de edi√ß√£o voc√™ poder√°:</p>
            <ul style="text-align: left; margin: 20px 0; color: #e0e0e0;">
                <li>‚úèÔ∏è Personalizar nomes dos aplicativos</li>
                <li>üîó Alterar URLs para seus sites preferidos</li>
                <li>üé® Modificar √≠cones (futuro)</li>
                <li>üíæ Salvar suas configura√ß√µes</li>
            </ul>
            <p style="color: #ffcc80; font-weight: bold;">‚ö†Ô∏è Suas altera√ß√µes ser√£o salvas automaticamente</p>
            <div style="margin-top: 25px;">
                <button id="confirmEditMode">Ativar Modo de Edi√ß√£o</button>
                <button id="cancelEditMode">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Edi√ß√£o Individual -->
    <div id="itemEditModal" class="modal hidden">
        <div class="modal-content">
            <span id="itemEditClose" class="close">&times;</span>
            <h2>‚úèÔ∏è Editar Item</h2>
            <div style="margin: 20px 0;">
                <label style="display: block; margin-bottom: 10px; color: #e0e0e0; font-weight: bold;">
                    üìù Nome do Aplicativo:
                </label>
                <input type="text" id="editItemName" style="width: 100%; padding: 10px; border: 1px solid #666; border-radius: 4px; background: #2a2a2a; color: white; font-size: 16px;" placeholder="Digite o nome do aplicativo">
                
                <label style="display: block; margin: 20px 0 10px 0; color: #e0e0e0; font-weight: bold;">
                    üîó URL de Destino:
                </label>
                <input type="url" id="editItemUrl" style="width: 100%; padding: 10px; border: 1px solid #666; border-radius: 4px; background: #2a2a2a; color: white; font-size: 16px;" placeholder="https://exemplo.com">
                
                <div style="margin: 20px 0; padding: 15px; background: rgba(255, 107, 53, 0.1); border: 1px solid rgba(255, 107, 53, 0.3); border-radius: 4px;">
                    <p style="margin: 0; color: #ffcc80; font-size: 14px;">
                        üí° <strong>Dica:</strong> Certifique-se de incluir "https://" no in√≠cio da URL
                    </p>
                </div>
            </div>
            
            <div style="margin-top: 25px; text-align: right;">
                <button id="cancelItemEdit">Cancelar</button>
                <button id="saveItemEdit">üíæ Salvar Altera√ß√µes</button>
            </div>
        </div>
    </div>

    <!-- Modal de App (para Play Store) -->
    <div id="appModal" class="modal hidden">
        <div class="modal-content">
            <span id="appModalClose" class="close">&times;</span>
            <div style="text-align: center; padding: 20px;">
                <h2 id="appModalTitle" style="margin-bottom: 20px; color: #fff;"></h2>
                <div style="background: rgba(255, 255, 255, 0.1); border-radius: 8px; padding: 20px; margin: 20px 0;">
                    <p style="color: #e0e5e5; margin-bottom: 15px;">üì± Este √© um aplicativo m√≥vel oficial</p>
                    <p style="color: #ccc; font-size: 0.9em; margin-bottom: 20px;">Clique no bot√£o abaixo para:</p>
                    <ul style="color: #ccc; text-align: left; margin: 15px 0; padding-left: 20px;">
                        <li>‚úÖ Abrir o app se j√° estiver instalado</li>
                        <li>üì• Ir para a loja para download se n√£o estiver instalado</li>
                    </ul>
                </div>
                <button id="openAppButton" style="
                    background: linear-gradient(45deg, #4CAF50, #45a049);
                    border: none;
                    padding: 15px 30px;
                    font-size: 16px;
                    cursor: pointer;
                    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
                    transition: transform 0.2s ease;
                " onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                    üöÄ Abrir Aplicativo
                </button>
                <p style="color: #999; font-size: 0.8em; margin-top: 15px;">
                    üí° Voc√™ permanecer√° no GERiAH at√© clicar no bot√£o
                </p>
            </div>
        </div>
    </div>

    <!-- Modal de Edi√ß√£o de Cards -->
    <div id="cardEditModal" class="modal hidden">
        <div class="modal-content">
            <span id="cardEditModalClose" class="close">&times;</span>
            <h2>Editar Card</h2>
            <form id="cardEditForm">
                <div style="margin-bottom: 15px;">
                    <label for="editCardTitle" style="display: block; margin-bottom: 5px; color: #fff;">T√≠tulo:</label>
                    <input type="text" id="editCardTitle" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label for="editCardImage" style="display: block; margin-bottom: 5px; color: #fff;">URL da Imagem:</label>
                    <input type="url" id="editCardImage" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label for="editCardUrl" style="display: block; margin-bottom: 5px; color: #fff;">URL de Acesso:</label>
                    <input type="url" id="editCardUrl" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label for="editCardDescription" style="display: block; margin-bottom: 5px; color: #fff;">Descri√ß√£o:</label>
                    <textarea id="editCardDescription" rows="3" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; resize: vertical;"></textarea>
                </div>
                <div style="text-align: right;">
                    <button type="button" id="cancelCardEdit" style="margin-right: 10px; padding: 8px 16px; background: #666; color: white; border: none; border-radius: 4px; cursor: pointer;">Cancelar</button>
                    <button type="button" id="saveCardEdit" style="padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Edi√ß√£o de Itens Simples -->
    <div id="simpleItemEditModal" class="modal hidden">
        <div class="modal-content">
            <span id="simpleItemEditModalClose" class="close">&times;</span>
            <h2>Editar Item</h2>
            <form id="simpleItemEditForm">
                <div style="margin-bottom: 15px;">
                    <label for="editSimpleItemName" style="display: block; margin-bottom: 5px; color: #fff;">Nome:</label>
                    <input type="text" id="editSimpleItemName" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                </div>
                <div style="margin-bottom: 15px;">
                    <label for="editSimpleItemUrl" style="display: block; margin-bottom: 5px; color: #fff;">URL de Acesso:</label>
                    <input type="url" id="editSimpleItemUrl" style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
                </div>
                <div style="text-align: right;">
                    <button type="button" id="cancelSimpleItemEdit" style="margin-right: 10px; padding: 8px 16px; background: #666; color: white; border: none; border-radius: 4px; cursor: pointer;">Cancelar</button>
                    <button type="button" id="saveSimpleItemEdit" style="padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Adicionar Favorito -->
    <div id="addFavoriteModal" class="modal hidden">
        <div class="modal-content">
            <span id="addFavoriteModalClose" class="close">&times;</span>
            <h2>‚≠ê Adicionar aos Meus Favoritos</h2>
            <div style="margin: 20px 0;">
                <label style="display: block; margin-bottom: 10px; color: #e0e0e0; font-weight: bold;">
                    üìù Nome do Favorito:
                </label>
                <input type="text" id="addFavoriteName" style="width: 100%; padding: 10px; border: 1px solid #666; border-radius: 4px; background: #2a2a2a; color: white; font-size: 16px;" placeholder="Ex: Meu Site Favorito">
                
                <label style="display: block; margin: 20px 0 10px 0; color: #e0e0e0; font-weight: bold;">
                    üîó URL de Destino:
                </label>
                <input type="url" id="addFavoriteUrl" style="width: 100%; padding: 10px; border: 1px solid #666; border-radius: 4px; background: #2a2a2a; color: white; font-size: 16px;" placeholder="https://exemplo.com">
                
                <label style="display: block; margin: 20px 0 10px 0; color: #e0e0e0; font-weight: bold;">
                    üìÑ Descri√ß√£o (opcional):
                </label>
                <textarea id="addFavoriteDescription" style="width: 100%; padding: 10px; border: 1px solid #666; border-radius: 4px; background: #2a2a2a; color: white; font-size: 16px; resize: vertical;" rows="3" placeholder="Breve descri√ß√£o do site ou ferramenta"></textarea>
                
                <div style="margin: 25px 0; padding: 20px; background: rgba(76, 175, 80, 0.1); border: 1px solid rgba(76, 175, 80, 0.3); border-radius: 8px;">
                    <p style="margin: 0; color: #81C784; font-size: 15px; line-height: 1.6; text-align: center;">
                        ‚≠ê <strong>Vers√£o INDIVIDUAL:</strong> Voc√™ pode adicionar at√© <strong>7 favoritos</strong> personalizados.<br><br>
                        üí° Quando atingir o limite, voc√™ poder√° <strong>substituir</strong> um favorito existente ou fazer <strong>upgrade para PERSONALIZADO</strong>!
                    </p>
                </div>
            </div>
            
            <div style="margin-top: 25px; text-align: right;">
                <button id="cancelAddFavorite" style="background-color: #666; color: white; border: none; padding: 12px 20px; margin: 5px; border-radius: 4px; cursor: pointer;">Cancelar</button>
                <button id="saveAddFavorite" style="background-color: #4CAF50; color: white; border: none; padding: 12px 20px; margin: 5px; border-radius: 4px; cursor: pointer; font-weight: bold;">‚≠ê Adicionar Favorito</button>
            </div>
        </div>
    </div>

    <!-- Modal de Substitui√ß√£o de Favoritos -->
    <div id="replaceFavoriteModal" class="modal hidden">
        <div class="modal-content">
            <span id="replaceFavoriteClose" class="close">&times;</span>
            <h2>üîÑ Substituir Favorito</h2>
            <p style="color: #e0e0e0; margin-bottom: 20px;">Voc√™ j√° tem <strong>7 favoritos</strong> (limite m√°ximo).</p>
            <p style="color: #e0e0e0; margin-bottom: 20px;">Deseja <strong>substituir</strong> um favorito existente por:</p>
            <div id="newFavoriteInfo" class="new-favorite-info" style="
                background: rgba(76, 175, 80, 0.1);
                border: 1px solid rgba(76, 175, 80, 0.3);
                border-radius: 8px;
                padding: 15px;
                margin-bottom: 20px;
            ">
                <!-- Ser√° preenchido dinamicamente -->
            </div>
            <h3 style="color: #e0e0e0; margin-bottom: 15px;">Escolha qual favorito substituir:</h3>
            <div id="existingFavoritesList" class="existing-favorites-list" style="
                max-height: 300px;
                overflow-y: auto;
                border: 1px solid rgba(255, 255, 255, 0.1);
                border-radius: 6px;
                background: rgba(0, 0, 0, 0.2);
            ">
                <!-- Lista ser√° preenchida dinamicamente -->
            </div>
            <div style="margin-top: 25px; text-align: right;">
                <button id="cancelReplace" style="background-color: #666; color: white; border: none; padding: 12px 20px; margin: 5px; border-radius: 4px; cursor: pointer;">‚ùå Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal de Busca de Treinamentos -->
    <div id="trainingSearchModal" class="modal hidden">
        <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
            <span id="trainingSearchClose" class="close">&times;</span>
            <h2 style="color: #fff; margin-bottom: 20px;">üîç Buscar Treinamentos</h2>
            
            <!-- √Årea de Busca -->
            <div style="margin-bottom: 20px;">
                <input type="text" id="trainingSearchInput" placeholder="Digite qualquer termo (ex: excel, comunica√ß√£o, lideran√ßa...) - Busca autom√°tica nas √°reas empresariais" 
                       style="width: 100%; padding: 12px; border: 1px solid #555; border-radius: 6px; background: #2a2a2a; color: #fff; font-size: 16px;">
                <div style="margin-top: 10px; display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
                    <span style="color: #ccc; font-size: 14px;">√Åreas de busca:</span>
                    <span style="color: #64B5F6; font-size: 14px;">üè¢ Gest√£o ‚Ä¢ üí∞ Vendas ‚Ä¢ üì¢ Marketing ‚Ä¢ üìû Atendimento ‚Ä¢ üõ†Ô∏è Suporte</span>
                    <button class="training-filter-btn" data-filter="todas" style="background: linear-gradient(45deg, #2196F3, #1976D2); border-color: #2196F3; margin-left: auto;">üåê Buscar em Todas</button>
                </div>
            </div>
            
            <!-- √Årea de Resultados -->
            <div id="trainingSearchResults" style="min-height: 200px;">
                <div style="text-align: center; margin-top: 40px;">
                    <p style="color: #ccc; margin-bottom: 20px;">üîç Digite qualquer termo no campo acima</p>
                    <div style="background: rgba(100, 181, 246, 0.1); border: 1px solid rgba(100, 181, 246, 0.2); border-radius: 8px; padding: 20px; text-align: left; max-width: 500px; margin: 0 auto;">
                        <h4 style="color: #64B5F6; margin: 0 0 15px 0;">üí° Como funciona:</h4>
                        <p style="color: #ccc; margin: 0 0 10px 0; font-size: 14px;">1Ô∏è‚É£ <strong>Digite</strong> qualquer palavra-chave</p>
                        <p style="color: #ccc; margin: 0 0 10px 0; font-size: 14px;">2Ô∏è‚É£ <strong>Busca autom√°tica</strong> nas √°reas empresariais</p>
                        <p style="color: #ccc; margin: 0 0 10px 0; font-size: 14px;">3Ô∏è‚É£ <strong>N√£o encontrou?</strong> Clique em "üåê Buscar em Todas"</p>
                        <p style="color: #64B5F6; margin: 10px 0 0 0; font-size: 13px;">Exemplo: "excel", "powerpoint", "comunica√ß√£o"...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== CARREGAMENTO IMEDIATO DE CORES =====
        (function() {
            console.log('‚ö° Carregamento imediato de cores iniciado...');
            
            const savedColors = localStorage.getItem('customColors');
            if (savedColors) {
                try {
                    const colors = JSON.parse(savedColors);
                    console.log('üé® Cores encontradas para carregamento imediato:', colors);
                    
                    if (colors.primary) {
                        // Fun√ß√£o para gerar varia√ß√µes de cores (copiada para uso imediato)
                        function generateColorVariationsImmediate(primaryColor) {
                            // Converter hex para HSL
                            function hexToHsl(hex) {
                                const r = parseInt(hex.slice(1, 3), 16) / 255;
                                const g = parseInt(hex.slice(3, 5), 16) / 255;
                                const b = parseInt(hex.slice(5, 7), 16) / 255;
                                
                                const max = Math.max(r, g, b);
                                const min = Math.min(r, g, b);
                                let h, s, l = (max + min) / 2;
                                
                                if (max === min) {
                                    h = s = 0;
                                } else {
                                    const d = max - min;
                                    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                                    switch (max) {
                                        case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                                        case g: h = (b - r) / d + 2; break;
                                        case b: h = (r - g) / d + 4; break;
                                    }
                                    h /= 6;
                                }
                                
                                return { h: h * 360, s: s * 100, l: l * 100 };
                            }
                            
                            // Converter HSL para hex
                            function hslToHex(h, s, l) {
                                h /= 360; s /= 100; l /= 100;
                                const hue2rgb = (p, q, t) => {
                                    if (t < 0) t += 1;
                                    if (t > 1) t -= 1;
                                    if (t < 1/6) return p + (q - p) * 6 * t;
                                    if (t < 1/2) return q;
                                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                                    return p;
                                };
                                
                                let r, g, b;
                                if (s === 0) {
                                    r = g = b = l;
                                } else {
                                    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                                    const p = 2 * l - q;
                                    r = hue2rgb(p, q, h + 1/3);
                                    g = hue2rgb(p, q, h);
                                    b = hue2rgb(p, q, h - 1/3);
                                }
                                
                                const toHex = (c) => {
                                    const hex = Math.round(c * 255).toString(16);
                                    return hex.length === 1 ? '0' + hex : hex;
                                };
                                
                                return `#${toHex(r)}${toHex(g)}${toHex(b)}`;
                            }
                            
                                                    const hsl = hexToHsl(primaryColor);
                        
                        return {
                            primarySolid: primaryColor,
                            primaryLight: hslToHex(hsl.h, hsl.s, Math.min(hsl.l + 20, 100)),
                            secondarySolid: hslToHex(hsl.h, hsl.s, Math.max(hsl.l - 50, 0)),
                            primaryAlpha: primaryColor + '80',
                            sidebarElements: hslToHex(hsl.h, hsl.s, Math.min(hsl.l + 10, 100)),
                            sidebarElementsAlpha: hslToHex(hsl.h, hsl.s, Math.min(hsl.l + 10, 100)) + '80',
                            sidebarHover: hslToHex(hsl.h, hsl.s, Math.min(hsl.l + 30, 100)),
                            sidebarHoverAlpha: hslToHex(hsl.h, hsl.s, Math.min(hsl.l + 30, 100)) + '80',
                            // NOVA: cor muito escura para o fundo do main (carrossel)
                            darkBackground: hslToHex(hsl.h, Math.max(10, hsl.s * 0.8), 5),
                            // NOVA: cor escura para bordas do modal (15% de claridade)
                            darkBorder: hslToHex(hsl.h, Math.max(15, hsl.s * 0.9), 15),
                            // NOVA: cor mais escura para gradientes (bot√µes favoritos)
                            primaryDarker: hslToHex(hsl.h, Math.max(15, hsl.s * 0.9), Math.max(10, hsl.l * 0.6)),
                            // NOVA: cor para sombras com alpha
                            shadowColor: `rgba(${parseInt(primaryColor.slice(1, 3), 16)}, ${parseInt(primaryColor.slice(3, 5), 16)}, ${parseInt(primaryColor.slice(5, 7), 16)}, 0.4)`
                        };
                        }
                        
                        const root = document.documentElement;
                        const generatedColors = generateColorVariationsImmediate(colors.primary);
                        
                        // Aplicar TODAS as vari√°veis CSS do sistema
                        root.style.setProperty('--color-primary-solid', generatedColors.primarySolid);
                        root.style.setProperty('--color-primary-light', generatedColors.primaryLight);
                        root.style.setProperty('--color-secondary-solid', generatedColors.secondarySolid);
                        root.style.setProperty('--color-primary-alpha', generatedColors.primaryAlpha);
                        root.style.setProperty('--color-sidebar-elements', generatedColors.sidebarElements);
                        root.style.setProperty('--color-sidebar-elements-alpha', generatedColors.sidebarElementsAlpha);
                        root.style.setProperty('--color-sidebar-hover', generatedColors.sidebarHover);
                        root.style.setProperty('--color-sidebar-hover-alpha', generatedColors.sidebarHoverAlpha);
                        
                        // Vari√°veis adicionais para completar o sistema
                        root.style.setProperty('--color-bg-dark', generatedColors.darkBackground); // DIN√ÇMICO: fundo escuro do carrossel
                        root.style.setProperty('--color-primary-dark-border', generatedColors.darkBorder); // DIN√ÇMICO: borda escura do modal
                        root.style.setProperty('--color-primary-darker', generatedColors.primaryDarker); // DIN√ÇMICO: cor mais escura para gradientes
                        root.style.setProperty('--color-primary-shadow', generatedColors.shadowColor); // DIN√ÇMICO: cor para sombras
                        root.style.setProperty('--color-header-bg', `linear-gradient(135deg, ${generatedColors.primarySolid}, ${generatedColors.sidebarElements})`); // DIN√ÇMICO: header gradient
                        root.style.setProperty('--color-modal-bg', `linear-gradient(135deg, ${generatedColors.darkBackground}, ${generatedColors.darkBorder})`); // DIN√ÇMICO: modal gradient escuro
                        root.style.setProperty('--color-text-primary', '#e5e5e5');
                        root.style.setProperty('--color-text-white', '#ffffff');
                        root.style.setProperty('--color-border-light', generatedColors.primaryLight + '40');
                        root.style.setProperty('--color-primary-end', generatedColors.secondarySolid);
                        
                                                // Aplicar cores nos elementos principais diretamente com FOR√áA M√ÅXIMA
                        const style = document.createElement('style');
                        style.id = 'immediate-color-override';
                        style.textContent = `
                            /* FOR√áA M√ÅXIMA - Sobrescrever TODAS as cores roxas hardcoded */
                            
                            /* Elementos com cores hardcoded espec√≠ficas */
                            [style*="background: #5e4b75"], [style*="background-color: #5e4b75"] {
                                background: ${generatedColors.primarySolid} !important;
                                background-color: ${generatedColors.primarySolid} !important;
                            }
                            
                            [style*="background: #503060"], [style*="background-color: #503060"] {
                                background: ${generatedColors.primarySolid} !important;
                                background-color: ${generatedColors.primarySolid} !important;
                            }
                            
                            [style*="background: #804C9A"], [style*="background-color: #804C9A"] {
                                background: ${generatedColors.primarySolid} !important;
                                background-color: ${generatedColors.primarySolid} !important;
                            }
                            
                            [style*="background: #6C3D82"], [style*="background-color: #6C3D82"] {
                                background: ${generatedColors.primaryLight} !important;
                                background-color: ${generatedColors.primaryLight} !important;
                            }
                            
                            /* For√ßar em todos os cards */
                            .course-card, .resource-card, .content-card, .card {
                                background: ${generatedColors.sidebarElements} !important; /* MAIS S√ìLIDO: removido alpha */
                                border: 2px solid ${generatedColors.sidebarHover} !important; /* MAIS DESTACADO: borda grossa e cor hover */
                                box-shadow: 0 6px 15px rgba(0,0,0,0.4), 0 0 10px ${generatedColors.primaryLight}50 !important; /* GLOW desde o in√≠cio */
                            }
                            .course-card:hover, .resource-card:hover, .content-card:hover, .card:hover {
                                border-color: ${generatedColors.sidebarHover} !important; /* COR HOVER mais vibrante */
                                box-shadow: 0 8px 20px rgba(0,0,0,0.5), 0 0 15px ${generatedColors.sidebarHover}99 !important; /* SOMBRA MAIOR com glow mais forte */
                            }
                            .course-card.focused-card {
                                border-color: ${generatedColors.sidebarHover} !important;
                                box-shadow: 0 25px 50px rgba(0,0,0,0.8), 0 0 20px ${generatedColors.sidebarHover}CC !important; /* FOCO ULTRA DESTACADO */
                            }
                            
                            /* Menu items */
                            .card-menu-item:hover {
                                background: ${generatedColors.sidebarHover}99 !important; /* MAIS DESTACADO: cor hover com opacidade alta */
                                border-left-color: ${generatedColors.sidebarHover} !important; /* COR HOVER ao inv√©s de elements */
                                transform: translateX(3px) !important; /* EFEITO de movimento */
                                transition: all 0.3s ease !important;
                            }
                            .card-menu-item.active {
                                background: ${generatedColors.sidebarHover}CC !important; /* MAIS DESTACADO: ainda mais opaco para ativo */
                                border-left-color: ${generatedColors.sidebarHover} !important;
                                transform: translateX(5px) !important; /* MOVIMENTO MAIOR para ativo */
                            }
                            
                            /* Bot√µes - TODOS */
                            button, .button, #myCoursesBtn, .access-course-button {
                                background: ${generatedColors.primarySolid} !important;
                                background-color: ${generatedColors.primarySolid} !important;
                            }
                            button:hover, .button:hover, #myCoursesBtn:hover, .access-course-button:hover {
                                background: ${generatedColors.primaryLight} !important;
                                background-color: ${generatedColors.primaryLight} !important;
                            }
                            
                            /* Bot√£o Adicionar Favoritos - DIN√ÇMICO */
                            .add-favorite-btn {
                                background: linear-gradient(135deg, ${generatedColors.primaryDarker}, ${generatedColors.primarySolid}) !important;
                            }
                            .add-favorite-btn:hover {
                                background: linear-gradient(135deg, ${generatedColors.primarySolid}, ${generatedColors.sidebarHover}) !important;
                                box-shadow: 0 4px 12px ${generatedColors.shadowColor} !important;
                            }
                            
                            /* S√≠mbolo "+" din√¢mico - FOR√áA M√ÅXIMA */
                            .add-favorite-btn span {
                                color: var(--text-brightness-color, #ffffff) !important; /* DIN√ÇMICO: usa a mesma vari√°vel CSS que o resto do sistema */
                                filter: brightness(1.2) saturate(1.1) !important;
                            }
                            .add-favorite-btn:hover span {
                                filter: brightness(1.5) saturate(1.3) drop-shadow(0 0 8px var(--text-brightness-color, #ffffff)) !important;
                                transform: scale(1.1) rotate(90deg) !important;
                            }
                            
                            /* Modais e confirma√ß√µes */
                            .modal-content {
                                background: linear-gradient(135deg, ${generatedColors.darkBackground}, ${generatedColors.darkBorder}) !important;
                                border: 2px solid ${generatedColors.sidebarHover} !important;
                                box-shadow: 0 8px 25px rgba(0,0,0,0.7), 0 0 20px ${generatedColors.primaryLight}50 !important;
                            }
                            #curationConfirm button, #curationReview button, .modal button {
                                background: ${generatedColors.primarySolid} !important;
                                background-color: ${generatedColors.primarySolid} !important;
                                border-color: ${generatedColors.primaryLight} !important;
                            }
                            #curationConfirm button:hover, #curationReview button:hover, .modal button:hover {
                                background: ${generatedColors.primaryLight} !important;
                                background-color: ${generatedColors.primaryLight} !important;
                            }
                            
                            /* Checkboxes e inputs */
                            input[type=checkbox], #curationList input[type=checkbox] {
                                accent-color: ${generatedColors.primarySolid} !important;
                            }
                            
                            /* Sidebar COMPLETA */
                            aside {
                                background: ${generatedColors.primaryAlpha} !important;
                                border-right-color: ${generatedColors.primaryLight}40 !important;
                            }
                            aside .accordion-content ul li button:hover,
                            aside .accordion-content ul li button.active {
                                background: ${generatedColors.primaryAlpha} !important;
                            }
                            
                            /* Header */
                            header {
                                background: linear-gradient(135deg, ${generatedColors.primarySolid}, ${generatedColors.sidebarElements}) !important;
                                border-bottom-color: ${generatedColors.sidebarHover} !important;
                                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3), 0 0 20px ${generatedColors.primaryLight}33 !important;
                            }
                            
                            /* Scrollbars */
                            .carousel-track::-webkit-scrollbar-track {
                                background: ${generatedColors.secondarySolid} !important;
                            }
                            .carousel-track::-webkit-scrollbar-thumb {
                                background: ${generatedColors.sidebarElements} !important;
                            }
                            .carousel-track::-webkit-scrollbar-thumb:hover {
                                background: ${generatedColors.sidebarHover} !important;
                            }
                            
                            /* Gradientes roxos hardcoded */
                            [style*="linear-gradient"][style*="#4A148C"],
                            [style*="linear-gradient"][style*="#6A1B9A"],
                            [style*="linear-gradient"][style*="#7B1FA2"] {
                                background: linear-gradient(135deg, ${generatedColors.primarySolid}, ${generatedColors.secondarySolid}) !important;
                            }
                            
                            /* For√ßar em elementos inline com style */
                            [style*="rgba(63, 44, 80"] {
                                background: ${generatedColors.sidebarElementsAlpha} !important;
                            }
                        `;
                                                document.head.appendChild(style);
                        
                        // Sistema de observa√ß√£o para for√ßar cores em elementos din√¢micos
                        const observer = new MutationObserver(function(mutations) {
                            mutations.forEach(function(mutation) {
                                if (mutation.type === 'childList') {
                                    mutation.addedNodes.forEach(function(node) {
                                        if (node.nodeType === 1) { // Element node
                                            // For√ßar cores em novos elementos
                                            const elementsWithPurple = node.querySelectorAll ? 
                                                node.querySelectorAll('[style*="#5e4b75"], [style*="#503060"], [style*="#804C9A"], [style*="#6C3D82"]') : [];
                                            
                                            elementsWithPurple.forEach(el => {
                                                el.style.background = generatedColors.primarySolid;
                                                el.style.backgroundColor = generatedColors.primarySolid;
                                            });
                                            
                                            // Se o pr√≥prio elemento tem cor roxa
                                            if (node.style && (
                                                node.style.background.includes('#5e4b75') ||
                                                node.style.background.includes('#503060') ||
                                                node.style.background.includes('#804C9A') ||
                                                node.style.background.includes('#6C3D82')
                                            )) {
                                                node.style.background = generatedColors.primarySolid;
                                                node.style.backgroundColor = generatedColors.primarySolid;
                                            }
                                        }
                                    });
                                }
                            });
                        });
                        
                        // Iniciar observa√ß√£o
                        observer.observe(document.body, {
                            childList: true,
                            subtree: true
                        });
                        
                        // For√ßar aplica√ß√£o imediata em TODOS os elementos existentes
                        setTimeout(() => {
                            // Buscar TODOS os elementos com cores roxas hardcoded
                            const purpleElements = document.querySelectorAll(
                                '[style*="#5e4b75"], [style*="#503060"], [style*="#804C9A"], [style*="#6C3D82"], ' +
                                '[style*="rgba(63, 44, 80"], [style*="rgba(80, 48, 96"]'
                            );
                            
                            purpleElements.forEach(el => {
                                el.style.background = generatedColors.primarySolid + ' !important';
                                el.style.backgroundColor = generatedColors.primarySolid + ' !important';
                            });
                            
                            // For√ßar em bot√µes espec√≠ficos
                            const buttons = document.querySelectorAll('button, .button');
                            buttons.forEach(btn => {
                                if (btn.style.background && (
                                    btn.style.background.includes('#5e4b75') ||
                                    btn.style.background.includes('#503060') ||
                                    btn.style.background.includes('#804C9A')
                                )) {
                                    btn.style.background = generatedColors.primarySolid + ' !important';
                                    btn.style.backgroundColor = generatedColors.primarySolid + ' !important';
                                }
                            });
                            
                            console.log(`üîß For√ßou cores em ${purpleElements.length} elementos roxos encontrados`);
                        }, 100);
                        
                        console.log('‚ö° Cores aplicadas IMEDIATAMENTE + Observer ativo:', colors.primary);
                    }
                } catch (error) {
                    console.error('‚ùå Erro no carregamento imediato de cores:', error);
                }
            } else {
                console.log('‚ÑπÔ∏è Nenhuma cor salva para carregamento imediato');
            }
        })();

        // Vari√°veis para controle do modo de edi√ß√£o - DEFINIDAS NO IN√çCIO
        let isEditMode = false;
        let isToggleVisible = false;
        let currentEditingItem = null;
        let customItemData = {};
        
        const curationList = [];
        const MAX_CURATION = 4;

        // ================ SISTEMA DE FAVORITOS SIMPLES ================
        let userFavorites = JSON.parse(localStorage.getItem('userFavorites')) || [];
        const MAX_USER_FAVORITES = 21;
        let customCardData = {};

        // Mapa de dados dos itens para replicar comportamento
        const itemsDataMap = {
            // 50+ | Maduros e Idosos
            "Longevidade": { 
                url: "https://longevidade.com.br/", 
                image: "https://api.iconify.design/tabler/plant.svg?color=%23a8a8a8" 
            },
            "Analise CNIS": { 
                url: "https://sobralfreenat.github.io/poc_avaliacao_cnis_aposentadoria/", 
                image: "https://api.iconify.design/tabler/file-text.svg?color=%23a8a8a8" 
            },
            "CNIS Suporte": { 
                url: "https://sobralfreenat.github.io/cnis_fluxo02_backoffice/", 
                image: "https://api.iconify.design/tabler/tool.svg?color=%23a8a8a8" 
            },
            // FNW Assessoria
            "FNW - Formul√°rio Estrat√©gico": { 
                url: "https://websim.com/@shiningrainbow72249063/formul-rio-estrat-gico", 
                image: "https://api.iconify.design/tabler/file-text.svg?color=%23a8a8a8" 
            },
            "FNW - ROI Maker": { 
                url: "https://sobralfreenat.github.io/fnw_clevel_roi-maker/", 
                image: "https://api.iconify.design/tabler/calculator.svg?color=%23a8a8a8" 
            },
            "Painel ETO": { 
                url: "https://sobralfreenat.github.io/fnw_connect_panel/", 
                image: "https://api.iconify.design/tabler/layout-dashboard.svg?color=%23a8a8a8" 
            },
            "MKT HUB": { 
                url: "https://construction-marketing-hub.deploypad.app/marketing", 
                image: "https://api.iconify.design/tabler/code.svg?color=%23a8a8a8" 
            },
            // Suporte IA
            "IA Prompt Wizzard": { 
                url: "https://sobralfreenat.github.io/agent_ai_prompt_gen_tool/", 
                image: "https://api.iconify.design/tabler/wand.svg?color=%23a8a8a8" 
            },
            "Chat Rosio Livia Geriah": { 
                url: "https://sobralfreenat.github.io/chat_rosio_livia_geriah/", 
                image: "https://api.iconify.design/tabler/message-dots.svg?color=%23a8a8a8" 
            },
            "HumanIA": { 
                url: "https://dash.superagentes.ai/@humania", 
                image: "https://api.iconify.design/tabler/users-group.svg?color=%23a8a8a8" 
            },
            "London Lord": { 
                url: "https://sobralfreenat.github.io/agb_gabriel_bourne_master/", 
                image: "https://api.iconify.design/tabler/user-hexagon.svg?color=%23a8a8a8" 
            },
            // Participe
            "FNW Sinergias": { 
                url: "https://sobralfreenat.github.io/fnw_parceria_sinergia/", 
                image: "https://api.iconify.design/tabler/home.svg?color=%23a8a8a8" 
            },
            "IDEIA21": { 
                url: "https://websim.com/@shiningrainbow72249063/ideia21-instituto-de-design-estilo-imagem-e-arte", 
                image: "https://api.iconify.design/tabler/user.svg?color=%23a8a8a8" 
            },
            "IPSOLON": { 
                url: "https://websim.com/@shiningrainbow72249063/ipsolon-instituto-de-promo-o-da-sa-de-orientada-lo", 
                image: "https://api.iconify.design/tabler/git-fork.svg?color=%23a8a8a8" 
            },
            "Feito Por Voc√™": { 
                url: "https://forms.gle/kFdaEY5L9gDYCUpC8", 
                image: "https://api.iconify.design/tabler/edit.svg?color=%23a8a8a8" 
            },
            // Favoritos manuais comuns
            "sANDboX W3": { 
                url: "#", 
                image: "https://api.iconify.design/tabler/world.svg?color=%23a8a8a8",
                isManual: true
            }
        };

        // Fun√ß√£o GLOBAL integrada com o sistema existente de favoritos
        function toggleFavoriteSimple(element, itemName) {
            const favoriteIndex = userFavorites.findIndex(fav => fav.name === itemName);
            
            if (favoriteIndex === -1) {
                // ADICIONAR aos favoritos
                if (userFavorites.length >= MAX_USER_FAVORITES) {
                    // Abrir modal de substitui√ß√£o ao inv√©s de apenas mostrar erro
                    openReplaceFavoriteModal(itemName);
                    return;
                }
                
                // Verificar se √© item do sistema ou manual
                const itemData = itemsDataMap[itemName];
                let newFavorite;
                
                if (itemData && !itemData.isManual) {
                    // Item do sistema - navega√ß√£o interna
                    newFavorite = {
                        name: itemName,
                        type: 'aplicativo',
                        url: itemData.url,
                        image: itemData.image,
                        dateAdded: new Date().toISOString()
                    };
                } else {
                    // Item manual ou n√£o mapeado - buscar nos favoritos existentes
                    const existingFavorite = userFavorites.find(fav => fav.name === itemName);
                    if (existingFavorite) {
                        // J√° existe, n√£o adicionar novamente
                        return;
                    }
                    
                    // N√£o permitir adicionar itens n√£o mapeados via estrela
                    showFavoriteToast(`"${itemName}" s√≥ pode ser adicionado manualmente!`, 'error');
                    return;
                }
                
                userFavorites.push(newFavorite);
                
                element.textContent = '‚òÖ';
                element.classList.add('favorited', 'animate-favorite');
                element.title = 'Remover dos favoritos';
                
                showFavoriteToast(`"${itemName}" adicionado aos favoritos!`);
                
            } else {
                // REMOVER dos favoritos
                userFavorites.splice(favoriteIndex, 1);
                
                element.textContent = '‚òÜ';
                element.classList.remove('favorited');
                element.title = 'Adicionar aos favoritos';
                
                showFavoriteToast(`"${itemName}" removido dos favoritos!`);
            }
            
            // Salvar e atualizar
            localStorage.setItem('userFavorites', JSON.stringify(userFavorites));
            updateFavoritesCounter();
            updateFavoritesDisplay();
            
            // Atualizar todas as estrelas do mesmo item na p√°gina
            const allStarsOfItem = document.querySelectorAll(`.favorite-star[data-item-name="${itemName}"]`);
            allStarsOfItem.forEach(star => {
                const isFavorited = userFavorites.some(fav => fav.name === itemName);
                if (isFavorited) {
                    star.textContent = '‚òÖ';
                    star.classList.add('favorited');
                    star.title = 'Remover dos favoritos';
                    star.style.color = '#FFD700';
                } else {
                    star.textContent = '‚òÜ';
                    star.classList.remove('favorited');
                    star.title = 'Adicionar aos favoritos';
                    star.style.color = '#999';
                }
            });
            
            // Remover anima√ß√£o
            setTimeout(() => element.classList.remove('animate-favorite'), 600);
        }

        // Fun√ß√£o para inicializar o estado das estrelas baseado nos favoritos salvos
        function initializeStarsState() {
            console.log('üîÑ Inicializando estado das estrelas...');
            
            // Buscar todas as estrelas na p√°gina
            const allStars = document.querySelectorAll('.favorite-star');
            
            allStars.forEach(star => {
                const itemName = star.getAttribute('data-item-name');
                if (!itemName) return;
                
                // Verificar se o item est√° nos favoritos
                const isFavorited = userFavorites.some(fav => fav.name === itemName);
                
                if (isFavorited) {
                    // Marcar como favorito
                    star.textContent = '‚òÖ';
                    star.classList.add('favorited');
                    star.title = 'Remover dos favoritos';
                    star.style.color = '#FFD700';
                    console.log(`‚≠ê Estrela marcada: ${itemName}`);
                } else {
                    // Marcar como n√£o favorito
                    star.textContent = '‚òÜ';
                    star.classList.remove('favorited');
                    star.title = 'Adicionar aos favoritos';
                    star.style.color = '#999';
                }
            });
            
            console.log(`‚úÖ ${allStars.length} estrelas inicializadas`);
        }

        // Fun√ß√£o para observar mudan√ßas no DOM e inicializar estrelas novas
        function observeStarsChanges() {
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'childList') {
                        // Verificar se novos elementos com estrelas foram adicionados
                        mutation.addedNodes.forEach(function(node) {
                            if (node.nodeType === Node.ELEMENT_NODE) {
                                const newStars = node.querySelectorAll ? node.querySelectorAll('.favorite-star') : [];
                                if (newStars.length > 0) {
                                    console.log(`üîç Novas estrelas detectadas: ${newStars.length}`);
                                    setTimeout(initializeStarsState, 100); // Pequeno delay para garantir que o DOM est√° pronto
                                }
                            }
                        });
                    }
                });
            });

            observer.observe(document.body, {
                childList: true,
                subtree: true
            });
            
            console.log('üëÅÔ∏è Observer de estrelas ativado');
        }

        // Torna as fun√ß√µes dispon√≠veis globalmente
        window.toggleFavoriteSimple = toggleFavoriteSimple;
        window.initializeStarsState = initializeStarsState;

        // ================ SISTEMA DE SUBSTITUI√á√ÉO DE FAVORITOS ================
        
        // Vari√°vel para armazenar o item que quer ser adicionado
        let pendingFavoriteItem = null;

        // Fun√ß√£o para abrir modal de substitui√ß√£o
        function openReplaceFavoriteModal(itemName) {
            // Buscar dados do item
            const itemData = itemsDataMap[itemName];
            if (!itemData) {
                showFavoriteToast(`Item "${itemName}" n√£o encontrado!`, 'error');
                return;
            }

            // Armazenar item pendente
            pendingFavoriteItem = {
                name: itemName,
                type: 'aplicativo',
                url: itemData.url,
                image: itemData.image,
                dateAdded: new Date().toISOString()
            };

            // Preencher informa√ß√µes do novo favorito
            const newFavoriteInfo = document.getElementById('newFavoriteInfo');
            newFavoriteInfo.innerHTML = `
                <img src="${itemData.image}" alt="${itemName}">
                <div class="new-favorite-details">
                    <h4>‚≠ê ${itemName}</h4>
                    <p>üîó Navega√ß√£o interna do sistema</p>
                </div>
            `;

            // Preencher lista de favoritos existentes COM SEPARA√á√ÉO POR TIPO
            const existingFavoritesList = document.getElementById('existingFavoritesList');
            
            // Separar favoritos por tipo
            const selecoes = userFavorites.filter(fav => fav.type === 'aplicativo');
            const adicoes = userFavorites.filter(fav => fav.type === 'manual');
            
            let favoritesHtml = '';
            
            // Se√ß√£o Sele√ß√µes (estrelas) - PRIMEIRO
            if (selecoes.length > 0) {
                favoritesHtml += `
                    <div style="margin-bottom: 15px;">
                        <h4 style="color: #4CAF50; margin: 0 0 10px 0; font-size: 0.9rem; display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 1rem;">‚≠ê</span> Sele√ß√£o (${selecoes.length})
                        </h4>
                `;
                selecoes.forEach((favorite) => {
                    const realIndex = userFavorites.findIndex(fav => fav === favorite);
                    const favoriteImage = favorite.image || "https://api.iconify.design/tabler/star.svg?color=%23FFD700";
                    
                    favoritesHtml += `
                        <div class="replace-favorite-item" style="border: 1px solid #4CAF50; background: rgba(76, 175, 80, 0.1);">
                            <img src="${favoriteImage}" alt="${favorite.name}">
                            <div class="replace-favorite-info">
                                <div class="replace-favorite-name">${favorite.name}</div>
                                <div class="replace-favorite-type" style="color: #4CAF50;">‚≠ê Navega√ß√£o interna</div>
                            </div>
                                                        <button class="replace-favorite-btn" onclick="replaceFavorite(${realIndex})" style="background: #5e4b75; color: white; border: none;">
                                üîÑ Substituir
                            </button>
                        </div>
                    `;
                });
                favoritesHtml += '</div>';
            }
            
            // Se√ß√£o Adi√ß√µes (manuais) - SEGUNDO
            if (adicoes.length > 0) {
                favoritesHtml += `
                    <div>
                        <h4 style="color: #FF9800; margin: 0 0 10px 0; font-size: 0.9rem; display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 1rem;">‚ûï</span> Adi√ß√£o (${adicoes.length})
                        </h4>
                `;
                adicoes.forEach((favorite) => {
                    const realIndex = userFavorites.findIndex(fav => fav === favorite);
                    const favoriteImage = favorite.image || "https://api.iconify.design/tabler/world.svg?color=%23a8a8a8";
                    
                    favoritesHtml += `
                        <div class="replace-favorite-item" style="border: 1px solid #FF9800; background: rgba(255, 152, 0, 0.1);">
                            <img src="${favoriteImage}" alt="${favorite.name}">
                            <div class="replace-favorite-info">
                                <div class="replace-favorite-name">${favorite.name}</div>
                                <div class="replace-favorite-type" style="color: #FF9800;">‚ûï URL externa</div>
                            </div>
                                                        <button class="replace-favorite-btn" onclick="replaceFavorite(${realIndex})" style="background: #5e4b75; color: white; border: none;">
                                üîÑ Substituir
                            </button>
                        </div>
                    `;
                });
                favoritesHtml += '</div>';
            }

            existingFavoritesList.innerHTML = favoritesHtml;

            // Mostrar modal
            document.getElementById('replaceFavoriteModal').classList.remove('hidden');
        }

        // Fun√ß√£o para substituir favorito
        function replaceFavorite(index) {
            if (!pendingFavoriteItem) {
                showFavoriteToast('Erro: Item pendente n√£o encontrado!', 'error');
                return;
            }

            const oldFavorite = userFavorites[index];
            
            // Substituir o favorito
            userFavorites[index] = pendingFavoriteItem;
            
            // Salvar no localStorage
            localStorage.setItem('userFavorites', JSON.stringify(userFavorites));
            
            // Atualizar displays
            updateFavoritesCounter();
            updateFavoritesDisplay();
            initializeStarsState();
            
            // Fechar modal
            closeReplaceFavoriteModal();
            
            // Mostrar confirma√ß√£o
            showFavoriteToast(`"${pendingFavoriteItem.name}" substituiu "${oldFavorite.name}"!`);
        }

        // Fun√ß√£o para fechar modal de substitui√ß√£o
        function closeReplaceFavoriteModal() {
            document.getElementById('replaceFavoriteModal').classList.add('hidden');
            pendingFavoriteItem = null;
        }

        // Tornar fun√ß√µes globais
        window.openReplaceFavoriteModal = openReplaceFavoriteModal;
        window.replaceFavorite = replaceFavorite;
        window.closeReplaceFavoriteModal = closeReplaceFavoriteModal;

        // Fun√ß√£o para mostrar notifica√ß√£o toast
        function showFavoriteToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = 'favorite-toast';
            toast.textContent = message;
            
            if (type === 'error') {
                toast.style.borderColor = '#ff4444';
                toast.style.color = '#ff4444';
            }
            
            document.body.appendChild(toast);
            
            // Mostrar toast
            setTimeout(() => toast.classList.add('show'), 100);
            
            // Remover toast ap√≥s 3 segundos
            setTimeout(() => {
                toast.classList.add('removing');
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 3000);
        }

        // Fun√ß√£o para adicionar/remover favoritos
        function toggleFavorite(itemName, itemType, element) {
            const favoriteIndex = userFavorites.findIndex(fav => fav.name === itemName);
            
            if (favoriteIndex === -1) {
                // Adicionar aos favoritos
                if (userFavorites.length >= MAX_USER_FAVORITES) {
                    showFavoriteToast(`M√°ximo de ${MAX_USER_FAVORITES} favoritos atingido!`, 'error');
                    return;
                }
                
                userFavorites.push({
                    name: itemName,
                    type: itemType,
                    dateAdded: new Date().toISOString()
                });
                
                element.textContent = '‚òÖ';
                element.classList.add('favorited', 'animate-favorite');
                element.title = 'Remover dos favoritos';
                
                showFavoriteToast(`"${itemName}" adicionado aos favoritos!`);
                
            } else {
                // Remover dos favoritos
                userFavorites.splice(favoriteIndex, 1);
                
                element.textContent = '‚òÜ';
                element.classList.remove('favorited');
                element.title = 'Adicionar aos favoritos';
                
                showFavoriteToast(`"${itemName}" removido dos favoritos!`);
            }
            
            // Salvar no localStorage
            localStorage.setItem('userFavorites', JSON.stringify(userFavorites));
            
            // Atualizar contador de favoritos
            updateFavoritesCounter();
            
            // Atualizar lista de favoritos se estiver vis√≠vel
            updateFavoritesDisplay();
            
            // Remover anima√ß√£o ap√≥s completar
            setTimeout(() => element.classList.remove('animate-favorite'), 600);
        }

        // Fun√ß√£o para atualizar o contador de favoritos
        function updateFavoritesCounter() {
            const counter = document.getElementById('favoritosCounter');
            if (counter) {
                counter.textContent = `${userFavorites.length}/${MAX_USER_FAVORITES}`;
            }
        }

        // Fun√ß√£o para atualizar a exibi√ß√£o da lista de favoritos COM SUBCATEGORIAS
        function updateFavoritesDisplay() {
            const favoritosItemsList = document.getElementById('favoritosItemsList');
            if (!favoritosItemsList) return;
            
            if (userFavorites.length === 0) {
                favoritosItemsList.innerHTML = `
                    <li class="add-favorite-placeholder">
                        <button class="add-favorite-btn" onclick="openAddFavoriteModal()">
                            <span style="font-size: 1.2em;">‚ûï</span>
                            Adicionar Favorito
                        </button>
                    </li>`;
                return;
            }
            
            // Separar favoritos por tipo
            const sistemaFavorites = userFavorites.filter(fav => fav.type === 'aplicativo');
            const manualFavorites = userFavorites.filter(fav => fav.type === 'manual');
            
            let favoritesHtml = '';
            
            // SE√á√ÉO: FAVORITOS DO SISTEMA
            if (sistemaFavorites.length > 0) {
                favoritesHtml += `
                    <li>
                        <div class="sub-accordion-item">
                            <button class="sub-accordion-header" style="background: rgba(76, 175, 80, 0.1); border-left: 3px solid #4CAF50;">
                                <img src="https://api.iconify.design/tabler/apps.svg?color=%234CAF50" style="width: 16px; height: 16px; margin-right: 6px;">
                                Sele√ß√£o (${sistemaFavorites.length})
                                <span class="sub-accordion-icon">‚ñ∫</span>
                            </button>
                            <div class="sub-accordion-content" style="display: block;">
                                <ul>`;
                
                sistemaFavorites.forEach((favorite, index) => {
                    const itemImage = favorite.image || "https://api.iconify.design/tabler/star.svg?color=%23FFD700";
                    
                    favoritesHtml += `
                        <li>
                            <div class="card-menu-item has-favorite clean-favorite-item" data-card-name="${favorite.name}" 
                                onclick="loadCardCategory('${favorite.name}')" 
                                style="cursor: pointer; margin-left: 10px; position: relative;">
                                <img src="${itemImage}" alt="${favorite.name}" class="card-menu-icon favorite-icon-selected">
                                <span class="favorite-item-name">${favorite.name}</span>
                                <span class="favorite-star favorited clean-star edit-mode-only" 
                                    data-item-name="${favorite.name}" 
                                    data-item-type="${favorite.type}" 
                                    title="Remover dos favoritos"
                                    onclick="event.stopPropagation(); toggleFavoriteSimple(this, '${favorite.name}')">√ó</span>
                            </div>
                        </li>`;
                });
                
                favoritesHtml += `
                                </ul>
                            </div>
                        </div>
                    </li>`;
            }
            
            // SE√á√ÉO: FAVORITOS MANUAIS
            if (manualFavorites.length > 0) {
                favoritesHtml += `
                    <li>
                        <div class="sub-accordion-item">
                            <button class="sub-accordion-header" style="background: rgba(255, 152, 0, 0.1); border-left: 3px solid #FF9800;">
                                <img src="https://api.iconify.design/tabler/world.svg?color=%23FF9800" style="width: 16px; height: 16px; margin-right: 6px;">
                                Adi√ß√£o (${manualFavorites.length})
                                <span class="sub-accordion-icon">‚ñ∫</span>
                            </button>
                            <div class="sub-accordion-content" style="display: block;">
                                <ul>`;
                
                manualFavorites.forEach((favorite, index) => {
                    const itemImage = favorite.image || "https://api.iconify.design/tabler/world.svg?color=%23FF9800";
                    
                    favoritesHtml += `
                        <li>
                            <div class="card-menu-item has-favorite clean-favorite-item" data-card-name="${favorite.name}" 
                                onclick="window.open('${favorite.url}', '_blank')" 
                                style="cursor: pointer; margin-left: 10px; position: relative;">
                                <img src="${itemImage}" alt="${favorite.name}" class="card-menu-icon favorite-icon-added">
                                <span class="favorite-item-name">${favorite.name}</span>
                                <span class="favorite-star favorited clean-star edit-mode-only" 
                                    data-item-name="${favorite.name}" 
                                    data-item-type="${favorite.type}" 
                                    title="Remover dos favoritos"
                                    onclick="event.stopPropagation(); toggleFavoriteSimple(this, '${favorite.name}')">√ó</span>
                            </div>
                        </li>`;
                });
                
                favoritesHtml += `
                                </ul>
                            </div>
                        </div>
                    </li>`;
            }
            
            // BOT√ÉO ADICIONAR
            favoritesHtml += `
                <li class="add-favorite-placeholder">
                    <button class="add-favorite-btn clean-add-btn" onclick="openAddFavoriteModal()">
                        <span style="font-size: 1.2em;">‚ûï</span>
                        Adicionar Favorito
                    </button>
                </li>`;
            
            favoritosItemsList.innerHTML = favoritesHtml;
            
            // Adicionar funcionalidade de abrir/fechar subcategorias
            initializeFavoriteAccordions();
        }
        
        // Fun√ß√£o para inicializar acorde√µes dos favoritos
        function initializeFavoriteAccordions() {
            const accordionHeaders = document.querySelectorAll('#favoritosItemsList .sub-accordion-header');
            
            accordionHeaders.forEach(header => {
                header.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const content = this.parentElement.querySelector('.sub-accordion-content');
                    const icon = this.querySelector('.sub-accordion-icon');
                    
                    if (content.style.display === 'none') {
                        content.style.display = 'block';
                        icon.textContent = '‚ñº';
                        this.style.backgroundColor = 'rgba(255, 255, 255, 0.05)';
                    } else {
                        content.style.display = 'none';
                        icon.textContent = '‚ñ∫';
                        this.style.backgroundColor = '';
                    }
                });
            });
        }

        // Fun√ß√£o para inicializar as estrelas de favoritos
        function initializeFavoriteStars() {
            const stars = document.querySelectorAll('.favorite-star');
            console.log(`üîß Inicializando ${stars.length} estrelas`);
            
            stars.forEach(star => {
                // Remover event listeners existentes
                star.removeEventListener('click', handleStarClick);
                
                const itemName = star.getAttribute('data-item-name');
                const itemType = star.getAttribute('data-item-type');
                
                console.log(`‚≠ê Configurando estrela: ${itemName}`);
                
                // Verificar se j√° est√° nos favoritos
                const isFavorited = userFavorites.some(fav => fav.name === itemName);
                if (isFavorited) {
                    star.textContent = '‚òÖ';
                    star.classList.add('favorited');
                    star.title = 'Remover dos favoritos';
                } else {
                    star.textContent = '‚òÜ';
                    star.classList.remove('favorited');
                    star.title = 'Adicionar aos favoritos';
                }
                
                // Adicionar event listener
                star.addEventListener('click', handleStarClick);
                
                // Teste adicional - adicionar um evento simples
                star.addEventListener('click', function() {
                    console.log(`üåü CLIQUE DETECTADO em: ${itemName}`);
                    alert(`CLIQUE FUNCIONOU! Item: ${itemName}`);
                });
            });
        }

        // Handler para clique nas estrelas
        function handleStarClick(event) {
            event.stopPropagation();
            event.preventDefault();
            
            const star = event.target;
            const itemName = star.getAttribute('data-item-name');
            const itemType = star.getAttribute('data-item-type');
            
            toggleFavorite(itemName, itemType, star);
        }

        // Nova estrutura para categorias P.A.I.
        const paiCategoriesData = [
            {
                name: "50+ | Maduros e Idosos",
                items: [
                    { name: "Longevidade", url: "https://longevidade.com.br/", image: "https://api.iconify.design/tabler/plant.svg?color=%23e5e5e5" }, 
                    { name: "Analise CNIS", url: "https://sobralfreenat.github.io/poc_avaliacao_cnis_aposentadoria/", image: "https://api.iconify.design/tabler/file-text.svg?color=%23e5e5e5" },
                    { name: "CNIS Suporte", url: "https://sobralfreenat.github.io/cnis_fluxo02_backoffice/", image: "https://api.iconify.design/tabler/tool.svg?color=%23e5e5e5" }
                ]
            },
            {
                name: "FNW Assessoria",
                items: [
        //         { name: "Plataforma FNW Assessoria", url: "https://sobralfreenat.github.io/menu_fixo_replica/", image: "https://api.iconify.design/tabler/briefcase.svg?color=%23e5e5e5" },
                    { name: "FNW - Formul√°rio Estrat√©gico", url: "https://websim.com/@shiningrainbow72249063/formul-rio-estrat-gico", image: "https://api.iconify.design/tabler/file-text.svg?color=%23e5e5e5" },
                    { name: "FNW - ROI Maker", url: "https://sobralfreenat.github.io/fnw_clevel_roi-maker/", image: "https://api.iconify.design/tabler/calculator.svg?color=%23e5e5e5" },
                    { name: "Painel ETO", url: "https://sobralfreenat.github.io/fnw_connect_panel/", image: "https://api.iconify.design/tabler/layout-dashboard.svg?color=%23e5e5e5" },
                    { name: "MKT HUB", url: "https://construction-marketing-hub.deploypad.app/marketing", image: "https://api.iconify.design/tabler/code.svg?color=%23e5e5e5" },
        //       { name: "Mapa Tatico SP MG", url: "https://sobralfreenat.github.io/mapa150_sp-106_mg/", image: "https://api.iconify.design/tabler/map-2.svg?color=%23e5e5e5" }
                ]
            }
        ];

        // Restaurando a estrutura de subcategorias para Suporte IA
        const suporteIaCategoriesData = [
            {
                name: "Wizzards",
                items: [
                    { name: "IA Prompt Wizzard", url: "https://sobralfreenat.github.io/agent_ai_prompt_gen_tool/", image: "https://api.iconify.design/tabler/wand.svg?color=%23e5e5e5" },
            //     { name: "Plano de Aula - S", url: "https://sobralfreenat.github.io/fnw_plano_aula/", image: "https://api.iconify.design/tabler/school.svg?color=%23e5e5e5" }
                ]
            },
            {
                name: "Assistentes",
                items: [
                    { name: "Chat Rosio Livia Geriah", url: "https://sobralfreenat.github.io/chat_rosio_livia_geriah/", image: "https://api.iconify.design/tabler/message-dots.svg?color=%23e5e5e5" },
                    { name: "HumanIA", url: "https://dash.superagentes.ai/@humania", image: "https://api.iconify.design/tabler/users-group.svg?color=%23e5e5e5" },
                    { name: "London Lord", url: "https://sobralfreenat.github.io/agb_gabriel_bourne_master/", image: "https://api.iconify.design/tabler/user-hexagon.svg?color=%23e5e5e5" }
                ]
            },
            {
            // name: "Agentes",
                items: [
                    { name: "Agente Exemplo 1", url: "#", image: "https://api.iconify.design/tabler/robot.svg?color=%23e5e5e5" },
                    { name: "Agente Exemplo 2", url: "#", image: "https://api.iconify.design/tabler/gizmo.svg?color=%23e5e5e5" }
                ],
                statusMessage: "" // Limpa a mensagem pois agora temos itens
            },
            {
                // name: "Automa√ß√µes",
                items: [
                    { name: "Automa√ß√£o Exemplo 1", url: "#", image: "https://api.iconify.design/simple-icons/n8n.svg?color=%23e5e5e5" },
                    { name: "Automa√ß√£o Exemplo 2", url: "#", image: "https://api.iconify.design/simple-icons/make.svg?color=%23e5e5e5" }
                ],
                statusMessage: "" // Limpa a mensagem pois agora temos itens
            }
        ];

        // Nova estrutura para categoria "Participe"
        const participeCategoriesData = [
            {
                name: "Parcerias",
                items: [
                    { name: "FNW Sinergias", url: "https://sobralfreenat.github.io/fnw_parceria_sinergia/", image: "https://api.iconify.design/tabler/home.svg?color=%23e5e5e5" },
                    { name: "IDEIA21", url: "https://websim.com/@shiningrainbow72249063/ideia21-instituto-de-design-estilo-imagem-e-arte", image: "https://api.iconify.design/tabler/user.svg?color=%23e5e5e5" },
                    { name: "IPSOLON", url: "https://websim.com/@shiningrainbow72249063/ipsolon-instituto-de-promo-o-da-sa-de-orientada-lo", image: "https://api.iconify.design/tabler/git-fork.svg?color=%23e5e5e5" }

                ]
            },
            {
                name: "Feito Por Voc√™",
                items: [
                    { name: "Feito Por Voc√™", url: "https://forms.gle/kFdaEY5L9gDYCUpC8", image: "https://api.iconify.design/tabler/edit.svg?color=%23e5e5e5" } // Use um √≠cone relevante
                ]
            }
        ];

        // Nova estrutura para categoria "Videos"
        const videosCategoriesData = [
            {
                name: "Entretenimento",
                items: [
                    { name: "S√©ries", url: "https://pluto.tv/br/live-tv/5f1212ad1728050007a523b8", image: "https://api.iconify.design/tabler/square.svg?color=%23e5e5e5" }, // Alterado para um √≠cone gen√©rico para teste
                    { name: "Curiosidades", url: "https://pluto.tv/br/live-tv/5f1213ba0ecebc00070e170f", image: "https://api.iconify.design/tabler/circle.svg?color=%23e5e5e5" }, // Use um √≠cone relevante
                    { name: "Estilo de Vida", url: "https://pluto.tv/br/live-tv/664df5221dc48600087592b1", image: "https://api.iconify.design/tabler/triangle.svg?color=%23e5e5e5" }, // Use um √≠cone relevante
                    
                    { name: "Not√≠cias de Europa", url: "https://www.youtube.com/embed/O9mOtdZ-nSk", image: "https://api.iconify.design/tabler/box.svg?color=%23e5e5e5" } // Use um √≠cone relevante
                ]
            },
            {
                name: "Internos",
                items: [
                { name: "CNIS", url: "https://www.youtube.com/embed/OkqGQA-0XQU", image: "https://api.iconify.design/tabler/video.svg?color=%23e5e5e5" }, // Use um √≠cone relevante


// <iframe width="853" height="480" src="https://www.youtube.com/embed/OkqGQA-0XQU" title="GERiAH  CNIS01  2025 06 12 11 53 38" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe> 



//<iframe width="889" height="500" src="https://www.youtube.com/embed/O9mOtdZ-nSk" title="euronews en directo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>




                // { name: "Curiosidades", url: "https://pluto.tv/br/live-tv/5f1213ba0ecebc00070e170f", image: "https://api.iconify.design/tabler/circle.svg?color=%23e5e5e5" }, // Use um √≠cone relevante
                //  { name: "Estilo de Vida", url: "https://pluto.tv/br/live-tv/664df5221dc48600087592b1", image: "https://api.iconify.design/tabler/triangle.svg?color=%23e5e5e5" } // Use um √≠cone relevante
                ]
            },
            {
                name: "Ofertas",
                items: [
                    //{ name: "Curiosidades", url: "https://pluto.tv/br/live-tv/5f1213ba0ecebc00070e170f", image: "https://api.iconify.design/tabler/circle.svg?color=%23e5e5e5" } // Use um √≠cone relevante
                ]
            }
        ];

        // Vari√°veis para par√¢metros da URL e estado de embedding
        let urlParams = new URLSearchParams(window.location.search);
        let embeddedMode = urlParams.get('embedded') === 'true';
        let parentOrigin = urlParams.get('origin');
        let userToken = urlParams.get('userToken');
        let userId = urlParams.get('userId'); // Pode ser usado futuramente se necess√°rio
        console.log('GERIiAH_USER: userToken from URL params:', userToken);
        console.log('GERIiAH_USER: embeddedMode from URL params:', embeddedMode);

        // Usa o token da URL se dispon√≠vel, sen√£o usa o fallback
        const apiToken = userToken || 'dbb2c4d19a5ef0fec48e363618611614b4e0dfce'; 

        const categoryUrl = 'https://www.iped.com.br/api/category/get-categories';
        const coursesUrl = 'https://www.iped.com.br/api/course/get-courses';

        const relevantKeywordsFor50Plus = [
            'atendimento', 'suporte', 'gestao', 'gest√£o', 'administracao', 'administra√ß√£o',
            'customer', 'service', 'helpdesk', 'help desk', 'call center', 'sac',
            'relacionamento', 'cliente', 'clientes', 'consumidor', 'usuarios', 'usu√°rios',
            'processo', 'processos', 'workflow', 'procedimento', 'procedimentos',
            'qualidade', 'excelencia', 'excel√™ncia', 'melhoria', 'otimizacao', 'otimiza√ß√£o',
            'lideranca', 'lideran√ßa', 'supervisao', 'supervis√£o', 'coordenacao', 'coordena√ß√£o',
            'equipe', 'equipes', 'team', 'colaborador', 'colaboradores', 'funcionario', 'funcion√°rios',
            'organizacao', 'organiza√ß√£o', 'planejamento', 'estrategia', 'estrat√©gia',
            'comunicacao', 'comunica√ß√£o', 'feedback', 'treinamento', 'capacitacao', 'capacita√ß√£o',
            'monitoramento', 'controle', 'indicadores', 'metricas', 'm√©tricas', 'kpi',
            'vendas', 'venda', 'sales', 'comercial', 'negociacao', 'negocia√ß√£o', 'prospeccao', 'prospec√ß√£o',
            'marketing', 'publicidade', 'propaganda', 'promocao', 'promo√ß√£o', 'campanha', 'campanhas',
            'digital marketing', 'mkt digital', 'social media', 'redes sociais', 'content marketing',
            'branding', 'marca', 'posicionamento', 'segmentacao', 'segmenta√ß√£o', 'target',
            'crm', 'funil', 'pipeline', 'lead', 'leads', 'conversao', 'convers√£o',
            'e-commerce', 'ecommerce', 'loja virtual', 'marketplace', 'monetizacao', 'monetiza√ß√£o'
        ];

        // Fun√ß√£o para ocultar o header e ajustar layout se em modo embedded
        function adjustForEmbeddedMode() {
            if (embeddedMode) {
                const headerElement = document.querySelector('header');
                const asideElement = document.querySelector('aside');
                const menuToggle = document.getElementById('menuToggle');

                // For√ßar visibilidade e posicionamento do header no modo embarcado
                if (headerElement) {
                    headerElement.style.setProperty('display', 'flex', 'important');
                    headerElement.style.setProperty('position', 'fixed', 'important');
                    headerElement.style.setProperty('top', '0', 'important');
                    headerElement.style.setProperty('left', '0', 'important');
                    headerElement.style.setProperty('right', '0', 'important');
                    headerElement.style.setProperty('z-index', '9999', 'important');
                }
                // For√ßar visibilidade e z-index do bot√£o de menu (hamb√∫rguer)
                if (menuToggle) {
                    menuToggle.style.setProperty('display', 'block', 'important');
                    menuToggle.style.setProperty('z-index', '10000', 'important');
                }
                // Ajusta o padding-top do body para 70px, pois o header est√° vis√≠vel
                document.body.style.setProperty('padding-top', '70px', 'important');
                
                // Ajusta a posi√ß√£o do aside para o topo da p√°gina (abaixo do header)
                if (asideElement) {
                    asideElement.style.setProperty('top', '70px', 'important');
                }

                // --- In√≠cio da l√≥gica restaurada para bot√µes de curadoria no modo embarcado ---
                const accessNowBtn = document.getElementById('accessNowBtn');
                if (accessNowBtn) {
                    accessNowBtn.style.display = 'inline-block'; // Mostra o bot√£o em modo embedded
                    // Estilizar como os outros bot√µes:
                    accessNowBtn.style.backgroundColor = 'rgba(100, 68, 116, 0.9)';
                    accessNowBtn.style.color = 'white';
                    accessNowBtn.style.border = '1px solid rgba(120, 88, 136, 1)';
                    accessNowBtn.style.padding = '10px 15px';
                    accessNowBtn.style.margin = '5px';
                    accessNowBtn.style.borderRadius = '4px';
                    accessNowBtn.style.cursor = 'pointer';
                    accessNowBtn.style.fontWeight = 'bold';
                    accessNowBtn.addEventListener('click', () => {
                        if (current && parentOrigin) {
                            window.parent.postMessage({ action: 'acessarItem', itemId: current.course_id }, parentOrigin);
                            document.getElementById('curationModal').classList.add('hidden'); // Fecha o modal
                        }
                    });
                }
                // No modo embedded, o bot√£o "Sim" para adicionar √† curadoria deve estar oculto
                const curateYesBtn = document.getElementById('curateYes');
                if(curateYesBtn) curateYesBtn.style.display = 'none';
                
                // No modo embedded, o bot√£o "N√£o" (ignorar) deve estar oculto
                const curateNoBtn = document.getElementById('curateNo');
                if(curateNoBtn) curateNoBtn.style.display = 'none';
                // Ajustar texto do prompt de curadoria em modo embedded
                const curationMessageEl = document.getElementById('curationMessage');
                if (curationMessageEl && current) {
                    curationMessageEl.textContent = `Acessar conte√∫do "${current.course_title}"?`;
                }
                const curationRemainingEl = document.getElementById('curationRemaining');
                if(curationRemainingEl) curationRemainingEl.style.display = 'none'; // N√£o relevante para acesso direto
                // --- Fim da l√≥gica restaurada para bot√µes de curadoria no modo embarcado ---
            }
        }


        async function fetchCategories() {
            const ul = document.getElementById('categoriesList');
            ul.innerHTML = '<li>Carregando...</li>';
            console.log('fetchCategories: Iniciando requisi√ß√£o para categorias...');
            console.log('fetchCategories: Usando apiToken:', apiToken);
            
            // DEBUG: Mostrar palavras-chave que est√£o sendo usadas
            console.log('DEBUG: Palavras-chave para filtro:', relevantKeywordsFor50Plus);
            
            try {
                const fd = new FormData();
                fd.append('token', apiToken);
                fd.append('all_formats', 'true');
                const res = await fetch(categoryUrl, { method: 'POST', body: fd });
                console.log('fetchCategories: Resposta recebida. Status:', res.status, 'OK:', res.ok);
                const data = await res.json();
                console.log('fetchCategories: Dados da resposta:', data);
                if (data.CATEGORIES) renderCategories(data.CATEGORIES);
                else {
                    ul.innerHTML = '<li>Erro ao carregar categorias.</li>';
                    console.error('fetchCategories: Dados de categorias inv√°lidos ou ausentes.', data);
                }
            } catch (error) {
                ul.innerHTML = '<li>Erro de rede.</li>';
                console.error('fetchCategories: Erro na requisi√ß√£o:', error);
            }
        }

        function renderCategories(cats) {
            const ul = document.getElementById('categoriesList');
            ul.innerHTML = '';
            let categoriesRendered = 0;

            // DEBUG: Log de todas as categorias recebidas
            console.log('DEBUG: Categorias recebidas da API IPED:', cats.length);
            cats.forEach((cat, idx) => {
                console.log(`DEBUG: Categoria ${idx + 1}: "${cat.category_title}"`);
            });

            cats.forEach((cat, idx) => {
                const categoryTitleLower = cat.category_title.toLowerCase();
                const isRelevant = relevantKeywordsFor50Plus.some(keyword => categoryTitleLower.includes(keyword));

                // DEBUG: Log do processo de filtragem
                console.log(`DEBUG: "${cat.category_title}" -> ${categoryTitleLower} -> Relevante: ${isRelevant}`);

                if (isRelevant) {
                    const li = document.createElement('li');
                    const btn = document.createElement('button');
                    btn.textContent = cat.category_title;
                    btn.dataset.id = cat.category_id;
                    btn.addEventListener('click', () => selectCategory(btn));
                    li.appendChild(btn);
                    ul.appendChild(li);
                    categoriesRendered++;
                    console.log(`DEBUG: Categoria "${cat.category_title}" ADICIONADA √† lista`);
                }
            });

            console.log(`DEBUG: Total de categorias renderizadas: ${categoriesRendered}`);

            if (categoriesRendered === 0) {
                ul.innerHTML = '<li>Nenhuma categoria de interesse para 50+ encontrada no momento.</li>';
            }
        }

        function selectCategory(btn) {
            // Atualiza classe ativa
            document.querySelectorAll('#categoriesList button').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            // Limpa o cont√™iner de cursos antes de buscar novos
            document.getElementById('coursesContainer').innerHTML = '<p style="color: #ccc;">Carregando recursos da categoria: ' + btn.textContent + '...</p>';
            fetchCourses(btn.dataset.id, btn.textContent);
            // Chama closeSidebar() ap√≥s a sele√ß√£o de categoria
            closeSidebar();
        }

        async function fetchCourses(catId, catTitle) {
            const cont = document.getElementById('coursesContainer');
            try {
                const fd = new FormData();
                fd.append('token', apiToken);
                fd.append('category_id', catId);
                fd.append('all_formats', 'true');
                const res = await fetch(coursesUrl, { method: 'POST', body: fd });
                const data = await res.json();
                if (data.COURSES) renderCourses(data.COURSES, catTitle);
                else cont.innerHTML = '<p style="color: #ff6b6b;">Erro ao carregar recursos.</p>';
            } catch {
                cont.innerHTML = '<p style="color: #ff6b6b;">Erro de rede ao buscar recursos.</p>';
            }
        }

        function renderCourses(courses, categoryTitle) {
            console.log('renderCourses: userToken value:', userToken);
            const container = document.getElementById('coursesContainer');
            container.innerHTML = '';

            // Cria o t√≠tulo da categoria principal (antigo #mainTitle, agora din√¢mico)
            // Este t√≠tulo fica fora do carrossel, no topo da √°rea de cursos.
            const categoryHeader = document.createElement('h2');
            categoryHeader.className = 'category-title-header'; // Reutiliza o estilo existente
            categoryHeader.textContent = categoryTitle;
            container.appendChild(categoryHeader);

            if (!courses || courses.length === 0) { // Verifica√ß√£o mais robusta
                // Se n√£o h√° cursos, apenas mostra a mensagem abaixo do t√≠tulo da categoria.
                // N√£o cria o .carousel-track nem os pseudo-elementos de esfuma√ßar.
                const noCoursesMessage = document.createElement('p');
                noCoursesMessage.textContent = 'Nenhum recurso encontrado nesta categoria.';
                noCoursesMessage.style.color = '#ccc';
                noCoursesMessage.style.marginTop = '20px';
                container.appendChild(noCoursesMessage);
                return;
            }

            // Cria o trilho do carrossel
            const carouselTrack = document.createElement('div');
            carouselTrack.className = 'carousel-track';

            courses.forEach(course => {
                const card = document.createElement('div');
                card.className = 'course-card';
                if(course.course_id) card.dataset.courseId = course.course_id;

                let displayTitle = course.course_title || 'Curso sem t√≠tulo';
                if (displayTitle.toLowerCase().startsWith('curso de ')) {
                    displayTitle = displayTitle.substring(9); // Remove "Curso de " (9 caracteres)
                }

                card.innerHTML = `
                    <img src="${course.course_image || 'https://via.placeholder.com/308x196.png?text=Sem+Imagem'}" alt="${course.course_title || 'Curso sem t√≠tulo'}" style="width:100%; height:196px; object-fit:cover; border-bottom: 1px solid rgba(80, 48, 96, 0.9);">
                    <div class="info" style="padding:15px;">
                        <h3 style="margin:0 0 10px; font-size:1.05em; color:#fff; height: 56px; overflow: hidden;">${displayTitle}</h3>
                        <p style="font-size:0.85em; color:#ccc; margin:0; line-height: 1.3; height: 70px; overflow: hidden;">${(course.course_description || 'Sem descri√ß√£o dispon√≠vel.').substring(0, 100)}...</p>
                        ${userToken ? `<button class="access-course-button" data-course-id="${course.course_id}">Acessar</button>` : ''}
                    </div>`;

                if (userToken) {
                    // Se o usu√°rio est√° logado, o clique no card n√£o faz nada,
                    // e a a√ß√£o de acesso √© via o bot√£o "Acessar".
                    // card.onclick = null; // J√° √© null por padr√£o se n√£o for atribu√≠do
                    const accessButton = card.querySelector('.access-course-button');
                    if (accessButton) {
                        accessButton.addEventListener('click', (e) => {
                            e.stopPropagation(); // Impede que o clique no bot√£o propague para o card
                            if (course.course_id && parentOrigin) {
                                window.parent.postMessage({ action: 'acessarItem', itemId: course.course_id }, parentOrigin);
                            }
                            closeSidebar(); // Fechar sidebar ap√≥s iniciar o acesso ao curso
                        });
                    }
                } else {
                    // Se o usu√°rio N√ÉO est√° logado, o clique no card abre o modal de curadoria.
                    card.onclick = () => {
                        promptCurate(course);
                        // closeSidebar(); // REMOVIDO: Permitir que o menu hamb√∫rguer funcione com o modal aberto
                    };
                }
                carouselTrack.appendChild(card);
            });
            container.appendChild(carouselTrack);

            // Adiciona listener de scroll ao carrossel rec√©m-criado
            const debouncedUpdateFocus = debounce(() => updateCarouselFocus(carouselTrack), 50);
            
            let scrollEndTimer = null;
            carouselTrack.addEventListener('scroll', () => {
                // Atualiza o foco visualmente durante o scroll
                debouncedUpdateFocus(); 

                // Detecta o fim do scroll para o snap
                clearTimeout(scrollEndTimer);
                scrollEndTimer = setTimeout(() => {
                    snapToNearestCard(carouselTrack);
                }, 150); // Ajuste este valor se necess√°rio (tempo para considerar o scroll parado)
            });

            // Chama uma vez para definir o foco inicial se houver scroll inicial
            updateCarouselFocus(carouselTrack); 
        }

        function snapToNearestCard(carouselTrack) {
            if (!carouselTrack || carouselTrack.children.length === 0) return;

            const cards = Array.from(carouselTrack.querySelectorAll('.course-card'));
            if (cards.length === 0) return;

            const trackRect = carouselTrack.getBoundingClientRect();
            const trackVisibleWidth = carouselTrack.clientWidth; // Largura vis√≠vel, excluindo scrollbars
            const trackScrollLeft = carouselTrack.scrollLeft;

            let nearestCard = null;
            let smallestDistance = Infinity;

            // Calcula a "linha central" da √°rea vis√≠vel do carrossel
            const viewportCenterLine = trackScrollLeft + trackVisibleWidth / 2;

            cards.forEach(card => {
                const cardMidPoint = card.offsetLeft + card.offsetWidth / 2;
                const distance = Math.abs(viewportCenterLine - cardMidPoint);

                if (distance < smallestDistance) {
                    smallestDistance = distance;
                    nearestCard = card;
                }
            });

            if (nearestCard) {
                // Calcula o scrollLeft necess√°rio para centralizar o nearestCard
                const targetScrollLeft = nearestCard.offsetLeft - (trackVisibleWidth / 2) + (nearestCard.offsetWidth / 2);
                
                // S√≥ faz o scroll se a posi√ß√£o alvo for significativamente diferente da atual
                // para evitar loops de snap em alguns casos, e para n√£o "snappar" se j√° estiver perto.
                if (Math.abs(carouselTrack.scrollLeft - targetScrollLeft) > 1) { 
                    carouselTrack.scrollTo({
                        left: targetScrollLeft,
                        behavior: 'smooth'
                    });
                    // A debouncedUpdateFocus no listener de scroll cuidar√° de atualizar o visual ap√≥s a anima√ß√£o de snap.
                }
            }
        }

        // Fun√ß√£o Debounce para otimizar eventos de scroll/resize
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Fun√ß√£o para atualizar o foco no card central do carrossel
        function updateCarouselFocus(carouselTrack) {
            if (!carouselTrack || carouselTrack.children.length === 0) return;

            const trackRect = carouselTrack.getBoundingClientRect();
            const trackCenter = trackRect.left + trackRect.width / 2;
            const cards = Array.from(carouselTrack.querySelectorAll('.course-card'));

            const cardWidth = cards[0] ? cards[0].offsetWidth : 308;

            // --- Par√¢metros Responsivos --- 
            const isMobile = window.innerWidth <= 768;

            // Par√¢metros de estilo
            const MAX_SCALE = isMobile ? 1.15 : 1.28; 
            const MIN_SCALE = 0.8;
            const MAX_TRANSLATE_Z = isMobile ? 30 : 60; 
            const MIN_TRANSLATE_Z = isMobile ? -100 : -200;
            const MAX_OPACITY = 1.0;
            const MIN_OPACITY_EDGE = isMobile ? 0.6 : 0.4; 
            const MIN_OPACITY_FAR = isMobile ? 0.2 : 0.1; 
            const MAX_BRIGHTNESS = 1.0;
            const MIN_BRIGHTNESS_EDGE = isMobile ? 0.6 : 0.4;
            const MIN_BRIGHTNESS_FAR = isMobile ? 0.2 : 0.1;

            const BORDER_DARK_COLOR = '#21112E';
            const BORDER_LIGHT_COLOR = '#D3C5E0';
            const BORDER_THICKNESS = 2; 

            const FOCUS_ZONE_WIDTH = cardWidth * (isMobile ? 1.5 : 2.0); 

            const Y_ROTATE_PER_CARD = isMobile ? 5 : 10; 
            const Y_ROTATE_FOCUS_DAMPING = 0.4; 
            const X_TRANSLATE_BASE_FACTOR = cardWidth * (isMobile ? 0.15 : 0.25);
            // --- Fim Par√¢metros Responsivos ---


            let centralCardIndex = -1;
            let minDistanceToTrackCenterForPivoting = Infinity;
            cards.forEach((card, index) => {
                const cardRect = card.getBoundingClientRect();
                const cardCenter = cardRect.left + cardRect.width / 2;
                const distance = Math.abs(cardCenter - trackCenter);
                if (distance < minDistanceToTrackCenterForPivoting) {
                    minDistanceToTrackCenterForPivoting = distance;
                    centralCardIndex = index;
                }
            });

            cards.forEach((card, index) => {
                const cardRect = card.getBoundingClientRect();
                const cardCenter = cardRect.left + cardRect.width / 2;

                const distanceToTrackCenterCurrentCard = Math.abs(cardCenter - trackCenter);
                let focusFactor = 1 - (distanceToTrackCenterCurrentCard / (FOCUS_ZONE_WIDTH / 2));
                focusFactor = Math.max(0, Math.min(1, focusFactor));

                const scale = MIN_SCALE + (MAX_SCALE - MIN_SCALE) * focusFactor;
                const translateZ = MIN_TRANSLATE_Z + (MAX_TRANSLATE_Z - MIN_TRANSLATE_Z) * focusFactor;
                
                let opacity, brightness;
                let boxShadow = `0 8px 20px rgba(0,0,0,${(0.3 + focusFactor * 0.5).toFixed(2)})`; // Sombra base interpolada

                if (focusFactor > 0.95) { // √Åpice do foco
                    const elevationShadow = `0 20px 45px rgba(0,0,0,0.8)`;
                    const darkBorder = `0 0 0 ${BORDER_THICKNESS}px ${BORDER_DARK_COLOR}`;
                    const lightBorder = `0 0 0 ${BORDER_THICKNESS * 2}px ${BORDER_LIGHT_COLOR}`;
                    boxShadow = `${darkBorder}, ${lightBorder}, ${elevationShadow}`;
                } else if (focusFactor > 0.5) { // Zona de foco intermedi√°ria
                    const currentElevationAlpha = (0.3 + focusFactor * 0.5).toFixed(2);
                    boxShadow = `0 ${Math.round(8 + 12 * focusFactor)}px ${Math.round(20 + 25 * focusFactor)}px rgba(0,0,0,${currentElevationAlpha})`;
                } // Para focusFactor <= 0.5, a sombra base j√° definida √© suficiente (menor e mais sutil)

                if (focusFactor > 0) {
                    opacity = MIN_OPACITY_EDGE + (MAX_OPACITY - MIN_OPACITY_EDGE) * focusFactor;
                    brightness = MIN_BRIGHTNESS_EDGE + (MAX_BRIGHTNESS - MIN_BRIGHTNESS_EDGE) * focusFactor;
                } else {
                    const falloffDistance = cardWidth * 1.5;
                    const distBeyondFocusZone = distanceToTrackCenterCurrentCard - (FOCUS_ZONE_WIDTH / 2);
                    const decay = Math.max(0, 1 - (distBeyondFocusZone / falloffDistance));
                    opacity = MIN_OPACITY_FAR + (MIN_OPACITY_EDGE - MIN_OPACITY_FAR) * decay;
                    brightness = MIN_BRIGHTNESS_FAR + (MIN_BRIGHTNESS_EDGE - MIN_BRIGHTNESS_FAR) * decay;
                }
                
                let translateX = 0;
                let rotateY = 0;

                if (centralCardIndex !== -1) {
                    const offsetFromCentral = index - centralCardIndex; 

                    rotateY = offsetFromCentral * Y_ROTATE_PER_CARD * (1 - (focusFactor * Y_ROTATE_FOCUS_DAMPING));

                    if (offsetFromCentral !== 0) {
                        // Cards s√£o empurrados para os lados baseados no offset.
                        // Este efeito √© atenuado se o card atual (index) estiver ele mesmo em foco.
                        translateX = offsetFromCentral * X_TRANSLATE_BASE_FACTOR * (1 - focusFactor * 0.6);
                    } else {
                        translateX = 0; // Card central n√£o tem translateX relativo ao piv√¥.
                    }
                }
                
                card.style.transform = `translateX(${translateX.toFixed(1)}px) rotateY(${rotateY.toFixed(1)}deg) translateZ(${translateZ.toFixed(0)}px) scale(${scale.toFixed(2)})`;
                card.style.opacity = opacity.toFixed(2);
                card.style.filter = `brightness(${brightness.toFixed(2)})`;
                card.style.zIndex = Math.floor(translateZ + 200); 
                card.style.boxShadow = boxShadow;

                card.classList.remove('focused-card', 'adjacent-style', 'secondary-neighbor-style');
            });
        }

        async function openDetails(id) {
            try {
                const fd = new FormData();
                fd.append('token', apiToken);
                fd.append('course_id', id);
                const res = await fetch(coursesUrl, { method: 'POST', body: fd });
                const d = await res.json();
                if (d.COURSES && d.COURSES[0]) showModal(d.COURSES[0]);
            } catch {
                console.error('Erro ao carregar detalhes');
            }
        }

        function showModal(course) {
            const md = document.getElementById('modal');
            const div = document.getElementById('courseDetails');
            div.innerHTML = `
                <img src="${course.course_image || ''}">
                <h2>${course.course_title}</h2>
                <p>${course.course_description || ''}</p>
                <p><strong>Professor:</strong> ${course.course_teacher?.teacher_name || ''}</p>
                <p><strong>Pre√ßo:</strong> R$${course.course_price?.toFixed(2) || '--'}</p>`;
            md.classList.remove('hidden');
        }

        document.getElementById('modalClose').addEventListener('click', () => {
            document.getElementById('modal').classList.add('hidden');
        });

        // ===== SISTEMA CLICK OUTSIDE TO CLOSE MODALS =====
        // Modal principal (course details)
        document.getElementById('modal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) {
                document.getElementById('modal').classList.add('hidden');
            }
        });

        // Modal de curadoria
        document.getElementById('curationModal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) {
                document.getElementById('curationModal').classList.add('hidden');
            }
        });

        // Modal P.A.I.
        document.getElementById('paiModal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) {
                document.getElementById('paiModal').classList.add('hidden');
                const paiModalIframe = document.getElementById('paiModalIframe');
                if (paiModalIframe) {
                    paiModalIframe.src = 'about:blank'; // Limpa o iframe
                }
            }
        });

        // Modal de Apps
        document.getElementById('appModal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) {
                document.getElementById('appModal').classList.add('hidden');
            }
        });

        // Modal de confirma√ß√£o do modo de edi√ß√£o
        const editModeConfirmModal = document.getElementById('editModeConfirmModal');
        if (editModeConfirmModal) {
            editModeConfirmModal.addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    editModeConfirmModal.classList.add('hidden');
                }
            });
        }

        // Modal de edi√ß√£o de itens
        const itemEditModal = document.getElementById('itemEditModal');
        if (itemEditModal) {
            itemEditModal.addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    itemEditModal.classList.add('hidden');
                }
            });
        }

        // Modal de edi√ß√£o de cards
        const cardEditModal = document.getElementById('cardEditModal');
        if (cardEditModal) {
            cardEditModal.addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    cardEditModal.classList.add('hidden');
                }
            });
        }

        // Modal de edi√ß√£o de itens simples
        const simpleItemEditModal = document.getElementById('simpleItemEditModal');
        if (simpleItemEditModal) {
            simpleItemEditModal.addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    simpleItemEditModal.classList.add('hidden');
                }
            });
        }

        // Modal de adicionar favoritos
        const addFavoriteModal = document.getElementById('addFavoriteModal');
        if (addFavoriteModal) {
            addFavoriteModal.addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    addFavoriteModal.classList.add('hidden');
                }
            });
        }

        // Modal de substituir favoritos
        const replaceFavoriteModal = document.getElementById('replaceFavoriteModal');
        if (replaceFavoriteModal) {
            replaceFavoriteModal.addEventListener('click', (e) => {
                if (e.target === e.currentTarget) {
                    replaceFavoriteModal.classList.add('hidden');
                }
            });
        }

        console.log('‚úÖ Sistema Click Outside to Close ativado para TODOS os modais!');

        document.getElementById('myCoursesBtn').addEventListener('click', () => {
            window.location.href = 'https://sobralfreenat.github.io/chat_rosio_livia_geriah/';
        });

        const MAX_SELECTION = 4;
        let selection = [];
        let current = null;
        
        function promptCurate(course) {
            current = course;
            const curationMessageEl = document.getElementById('curationMessage');
            const curationRemainingEl = document.getElementById('curationRemaining');
            const accessNowBtn = document.getElementById('accessNowBtn');
            const curateYesBtn = document.getElementById('curateYes');
            const curateNoBtn = document.getElementById('curateNo');

            if (embeddedMode) {
                if (curationMessageEl) curationMessageEl.textContent = `Acessar conte√∫do "${current.course_title}"?`;
                if (curationRemainingEl) curationRemainingEl.style.display = 'none';
                if (accessNowBtn) accessNowBtn.style.display = 'inline-block';
                if (curateYesBtn) curateYesBtn.style.display = 'none';
                if (curateNoBtn) curateNoBtn.style.display = 'none';
            } else {
                if (curationMessageEl) curationMessageEl.textContent = `Adicionar "${course.course_title}" √† sua curadoria?`;
                if (curationRemainingEl) {
                    curationRemainingEl.style.display = 'block';
                    curationRemainingEl.textContent = `Voc√™ pode selecionar ${MAX_SELECTION - selection.length} recurso${selection.length !== MAX_SELECTION-1?'s':''}`;
                }
                if (accessNowBtn) accessNowBtn.style.display = 'none';
                if (curateYesBtn) curateYesBtn.style.display = 'inline-block';
                if (curateNoBtn) curateNoBtn.style.display = 'inline-block';
            }
            
            document.getElementById('curationConfirm').style.display = 'block';
            document.getElementById('curationReview').style.display = 'none';
            document.getElementById('curationModal').classList.remove('hidden');
        }

        document.getElementById('curateYes').onclick = () => {
            if (selection.length < MAX_SELECTION && !selection.find(c => c.course_id === current.course_id)) {
                selection.push(current);
            }
            // Se n√£o estiver em modo embedded, vai para a revis√£o.
            // Se estiver em modo embedded, este bot√£o n√£o deveria ser clic√°vel ou vis√≠vel.
            if (!embeddedMode) {
                showReview();
            } else {
                // Em modo embedded, o fluxo de curadoria √© diferente, "Sim" n√£o se aplica diretamente aqui.
                // O acesso √© feito pelo bot√£o "Acessar Agora".
                document.getElementById('curationModal').classList.add('hidden');
            }
        };

        // O bot√£o "N√£o" (ignorar) em modo n√£o-embedded simplesmente fecha o modal ou vai para revis√£o sem adicionar.
        // Em modo embedded, este bot√£o tamb√©m n√£o √© prim√°rio. Se vis√≠vel, poderia apenas fechar o modal.
        document.getElementById('curateNo').onclick = () => {
            if (!embeddedMode) {
                showReview(); // No modo normal, "N√£o" ainda pode levar √† revis√£o (para desmarcar outros)
            } else {
                // Em modo embedded, "N√£o" pode simplesmente fechar o modal se "Acessar Agora" n√£o for clicado.
                document.getElementById('curationModal').classList.add('hidden');
            }
        };


        function showReview() {
            // Esta fun√ß√£o √© principalmente para o modo n√£o-embedded (curadoria completa)
            if (embeddedMode) {
                // N√£o deve chegar aqui no fluxo de "Acessar Agora"
                document.getElementById('curationModal').classList.add('hidden');
                return;
            }
            document.getElementById('curationConfirm').style.display = 'none';
            document.getElementById('curationReview').style.display = 'block';
            const ul = document.getElementById('curationList'); ul.innerHTML = '';
            selection.forEach((c,i) => {
                const li = document.createElement('li');
                li.innerHTML = `<label><input type='checkbox' data-idx='${i}' checked> ${c.course_title}</label>`;
                ul.appendChild(li);
            });
        }

        // Atualiza sele√ß√£o a partir das checkboxes da revis√£o
        function applyReview() {
            const newSel = [];
            document.querySelectorAll('#curationList input[type=checkbox]').forEach(cb => {
                if (cb.checked) newSel.push(selection[parseInt(cb.dataset.idx)]);
            });
            selection = newSel;
        }
        // Atualiza contagem no passo de confirma√ß√£o
        function updateRemainingConfirm() {
            document.getElementById('curationRemaining').textContent =
                `Voc√™ pode selecionar ${MAX_SELECTION - selection.length} recurso${selection.length !== MAX_SELECTION - 1 ? 's' : ''}`;
        }
        document.getElementById('curateBack').onclick = () => {
            applyReview();
            updateRemainingConfirm();
            document.getElementById('curationReview').style.display = 'none';
            document.getElementById('curationConfirm').style.display = 'block';
        };
        document.getElementById('curateContinue').onclick = () => {
            applyReview();
            document.getElementById('curationModal').classList.add('hidden');
        };
        document.getElementById('curateFinish').onclick = () => {
            applyReview(); // Garante que a sele√ß√£o da lista de checkboxes seja aplicada
            const finalList = selection;

            if (embeddedMode && parentOrigin) {
                // Em modo embedded, envia a lista de cursos para a p√°gina pai
                // A p√°gina pai ser√° respons√°vel por coletar nome/email se necess√°rio
                window.parent.postMessage({ action: 'finalizarTrilha', trilhaData: finalList }, parentOrigin);
                document.getElementById('curationModal').classList.add('hidden');
                // Limpa a sele√ß√£o para a pr√≥xima vez que o modal for aberto.
                selection = []; 
                updateRemainingConfirm();
            } else {
                // Comportamento original: prompt para nome/email e download JSON
                const name = prompt('Digite seu nome:');
                const email = prompt('Digite seu email:');
                if (!name || !email) {
                    alert('Nome e email s√£o obrigat√≥rios.');
                    return;
                }
                const payload = { name, email, courses: finalList };
                const dataStr = JSON.stringify(payload, null, 2);
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                const fileName = `trilha_${name.replace(/\\s+/g,'_')}_${email.replace(/[@\\.]/g,'_')}.json`;
                a.download = fileName;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                document.getElementById('curationModal').classList.add('hidden');
                // Limpa a sele√ß√£o
                selection = []; 
                updateRemainingConfirm();
            }
        };

        // RENOMEADA e AJUSTADA: Agora recebe uma √öNICA categoria P.A.I. e renderiza seus itens.
        function displayPaiCategoryItems(paiCategory, parentCategoryName = "Participe") {
            console.log('=== DEBUG: displayPaiCategoryItems chamada ===');
            console.log('paiCategory:', paiCategory);
            console.log('parentCategoryName:', parentCategoryName);
            
            const container = document.getElementById('coursesContainer');
            if (!container) {
                console.error('ERRO: coursesContainer n√£o encontrado em displayPaiCategoryItems!');
                return;
            }
            
            console.log('Container encontrado, limpando conte√∫do...');
            container.innerHTML = ''; // Limpa conte√∫do anterior

            const paiSectionTitle = document.createElement('h2');
            paiSectionTitle.className = 'category-title-header';
            paiSectionTitle.textContent = `${parentCategoryName} - ${paiCategory.name}`; // AJUSTADO: Usa o par√¢metro da categoria pai
            container.appendChild(paiSectionTitle);

            if ((!paiCategory.items || paiCategory.items.length === 0)) {
                const noItemsMessage = document.createElement('p');
                if (paiCategory.statusMessage) {
                    noItemsMessage.textContent = paiCategory.statusMessage;
                } else {
                    noItemsMessage.textContent = `Nenhum recurso encontrado na categoria ${parentCategoryName}: ${paiCategory.name}.`; // AJUSTADO: Usa o par√¢metro da categoria pai
                }
                noItemsMessage.style.color = '#ccc';
                noItemsMessage.style.marginTop = '20px';
                container.appendChild(noItemsMessage);
                return;
            }

            const carouselTrack = document.createElement('div');
            carouselTrack.className = 'carousel-track';

            paiCategory.items.forEach(paiItem => {
                const card = document.createElement('div');
                card.className = 'course-card';

                card.addEventListener('click', () => {
                    // SINCRONIZA√á√ÉO: Atualiza menu quando card √© clicado
                    syncMenuSelection(paiItem.name);
                    openPaiItemInModal(paiItem);
                });

                card.innerHTML = `
                    <img src="${paiItem.image || 'https://via.placeholder.com/308x196.png?text=Recurso'}" alt="${paiItem.name}" style="width:100%; height:196px; object-fit:cover; border-bottom: 1px solid rgba(80, 48, 96, 0.9);">
                    <div class="info" style="padding:15px;">
                        <h3 style="margin:0 0 10px; font-size:1.05em; color:#fff; height: 56px; overflow: hidden;">${paiItem.name}</h3>
                        <p style="font-size:0.85em; color:#ccc; margin:0; line-height: 1.3; height: 70px; overflow: hidden;">Acesse Aqui</p>
                    </div>
                `;
                carouselTrack.appendChild(card);

                // Adicionar console.log para depura√ß√£o do √≠cone
                const imgElement = card.querySelector('img');
                if (imgElement) {
                    console.log(`√çcone para ${paiItem.name}: ${imgElement.src}`);
                }
            });
            container.appendChild(carouselTrack);

            const debouncedUpdateFocus = debounce(() => updateCarouselFocus(carouselTrack), 50);
            let scrollEndTimer = null;
            carouselTrack.addEventListener('scroll', () => {
                debouncedUpdateFocus();
                clearTimeout(scrollEndTimer);
                scrollEndTimer = setTimeout(() => {
                    snapToNearestCard(carouselTrack);
                }, 150);
            });

            setTimeout(() => {
                updateCarouselFocus(carouselTrack);
            }, 0);
        }

        function openPaiItemInModal(paiItem) {
            // Detecta URLs da Play Store e mostra modal especial
            if (paiItem.url.includes('play.google.com/store/apps')) {
                showAppModal(paiItem);
                return;
            }
            
            const modal = document.getElementById('paiModal');
            const titleElement = document.getElementById('paiModalTitle');
            const iframeElement = document.getElementById('paiModalIframe');

            if (!modal || !titleElement || !iframeElement) {
                console.error('Elementos do modal P.A.I. n√£o encontrados.');
                return;
            }

            titleElement.textContent = paiItem.name;
            iframeElement.src = paiItem.url;
            modal.classList.remove('hidden');
        }

        function showAppModal(appItem) {
            const modal = document.getElementById('appModal');
            const titleElement = document.getElementById('appModalTitle');
            const openButton = document.getElementById('openAppButton');

            if (!modal || !titleElement || !openButton) {
                console.error('Elementos do modal de app n√£o encontrados.');
                return;
            }

            titleElement.textContent = appItem.name;
            
            // Remove listeners anteriores e adiciona novo
            const newButton = openButton.cloneNode(true);
            openButton.parentNode.replaceChild(newButton, openButton);
            
            newButton.addEventListener('click', () => {
                window.open(appItem.url, '_blank');
                modal.classList.add('hidden');
            });

            modal.classList.remove('hidden');
        }

        function renderSuporteIaSubcategoriesSidebar() {
            const ul = document.getElementById('suporteIaItemsList');
            ul.innerHTML = ''; 

            if (!suporteIaCategoriesData || suporteIaCategoriesData.length === 0) {
                ul.innerHTML = '<li>Nenhuma subcategoria de Suporte IA configurada.</li>';
                return;
            }

            suporteIaCategoriesData.forEach(subCategory => {
                const li = document.createElement('li');
                const btn = document.createElement('button');
                btn.textContent = subCategory.name;

                btn.addEventListener('click', () => {
                    ul.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    displayPaiCategoryItems(subCategory, "Suporte-IA"); // Passa o nome da categoria pai
                    closeSidebar(); // Fechar sidebar ap√≥s selecionar subcategoria de Suporte IA
                });
                li.appendChild(btn);
                ul.appendChild(li);
            });
        }

        // Fun√ß√£o para fechar a sidebar em mobile (definida globalmente)
        function closeSidebar() {
            if (window.innerWidth <= 768) { // Apenas em telas m√≥veis
                document.body.classList.remove('sidebar-open');
            }
        }

        // Sistema de busca em tempo real no menu
        function setupRealTimeMenuSearch() {
            try {
                const searchInput = document.getElementById('menuSearchInput');
                const clearButton = document.getElementById('clearSearchBtn');
                
                if (!searchInput) {
                    console.error('Campo de busca n√£o encontrado!');
                    return;
                }
                
                console.log('Inicializando busca em tempo real do menu...');
            
            // Array para armazenar todos os itens do menu
            let allMenuItems = [];
            
            // Fun√ß√£o ROBUSTA para coletar TODOS os itens do menu
            function collectAllMenuItems() {
                allMenuItems = [];
                
                console.log('üîç === INICIANDO COLETA COMPLETA E ROBUSTA ===');
                let totalFound = 0;
                
                // üéØ FASE 1: Coleta TODOS os bot√µes (mais abrangente)
                console.log('üìã FASE 1: Coletando TODOS os bot√µes...');
                const allButtons = document.querySelectorAll('aside button, aside .button, aside [role="button"]');
                console.log(`Encontrados ${allButtons.length} bot√µes potenciais`);
                
                allButtons.forEach((button, index) => {
                    const text = button.textContent.trim();
                    const cleanText = text.replace(/‚ñ∫|‚ñº|\d+|\s+/g, ' ').replace(/\s+/g, ' ').trim();
                    
                    // Filtros mais inteligentes
                    const isValidButton = cleanText && 
                                        cleanText.length > 1 && 
                                        cleanText !== '‚ò∞' && 
                                        cleanText !== 'iA' && 
                                        !cleanText.includes('√ó') && 
                                        !cleanText.includes('‚ûï') &&
                                        !cleanText.includes('...') &&
                                        cleanText !== 'Carregando';
                    
                    if (isValidButton) {
                        let itemType = 'button';
                        let categoryHint = '';
                        
                        // Identifica√ß√£o mais robusta do tipo
                        if (button.classList.contains('accordion-header') || button.tagName === 'H2') {
                            itemType = 'main-category';
                        } else if (button.classList.contains('sub-accordion-header')) {
                            itemType = 'sub-category';
                        } else if (button.classList.contains('sub-sub-accordion-header')) {
                            itemType = 'sub-sub-category';
                        } else if (button.closest('.sub-sub-accordion-content')) {
                            itemType = 'sub-sub-item';
                        } else if (button.closest('.sub-accordion-content')) {
                            itemType = 'sub-item';
                        }
                        
                        // Identifica√ß√£o de categoria pai mais robusta
                        let parentElement = button.closest('.accordion-item');
                        if (parentElement) {
                            const mainHeader = parentElement.querySelector('h2, .accordion-header');
                            if (mainHeader) {
                                categoryHint = mainHeader.textContent.replace(/‚ñ∫|‚ñº|\d+/g, '').trim();
                            }
                        }
                        
                        allMenuItems.push({
                            element: button,
                            parent: button.parentElement,
                            text: cleanText,
                            originalText: text,
                            type: itemType,
                            categoryName: categoryHint,
                            extraKeywords: '',
                            domIndex: index
                        });
                        totalFound++;
                        
                        console.log(`‚úÖ [${totalFound}] ${itemType.toUpperCase()}: "${cleanText}" (${categoryHint})`);
                    } else {
                        console.log(`‚ùå Bot√£o rejeitado: "${cleanText}"`);
                    }
                });
                
                // üéØ FASE 2: Coleta TODOS os itens com data-card-name e similares
                console.log('\nüìã FASE 2: Coletando itens de card/menu...');
                const cardItems = document.querySelectorAll('.card-menu-item, [data-card-name], .menu-item, .item');
                console.log(`Encontrados ${cardItems.length} itens de card potenciais`);
                
                cardItems.forEach((item, index) => {
                    const text = item.textContent.trim();
                    const cardName = item.getAttribute('data-card-name') || text;
                    
                    if (text && text.length > 1 && text !== 'Carregando...' && !text.includes('...')) {
                        // Identifica√ß√£o robusta de categoria pai
                        let categoryHint = '';
                        let subcategoryHint = '';
                        
                        let parentElement = item.closest('.accordion-item');
                        if (parentElement) {
                            const mainHeader = parentElement.querySelector('h2, .accordion-header');
                            if (mainHeader) {
                                categoryHint = mainHeader.textContent.replace(/‚ñ∫|‚ñº|\d+/g, '').trim();
                            }
                        }
                        
                        // Verifica se est√° dentro de uma subcategoria
                        let subParent = item.closest('.sub-accordion-content');
                        if (subParent) {
                            const subHeader = subParent.previousElementSibling;
                            if (subHeader && subHeader.classList.contains('sub-accordion-header')) {
                                subcategoryHint = subHeader.textContent.replace(/‚ñ∫|‚ñº|\d+/g, '').trim();
                            }
                        }
                        
                        allMenuItems.push({
                            element: item,
                            parent: item.parentElement,
                            text: text,
                            originalText: text,
                            type: 'card-menu-item',
                            categoryName: categoryHint,
                            subcategoryName: subcategoryHint,
                            extraKeywords: cardName,
                            cardName: cardName,
                            domIndex: index
                        });
                        totalFound++;
                        
                        console.log(`‚úÖ [${totalFound}] CARD-ITEM: "${text}" (${categoryHint} ‚Ä∫ ${subcategoryHint})`);
                    }
                });
                
                // üéØ FASE 3: Coleta elementos de lista (li, a, span clic√°veis)
                console.log('\nüìã FASE 3: Coletando elementos de lista e links...');
                const listItems = document.querySelectorAll('aside li, aside a, aside span[onclick], aside [data-action]');
                console.log(`Encontrados ${listItems.length} elementos de lista potenciais`);
                
                listItems.forEach((item, index) => {
                    const text = item.textContent.trim();
                    const cleanText = text.replace(/‚ñ∫|‚ñº|\d+|\s+/g, ' ').replace(/\s+/g, ' ').trim();
                    
                    // Evita duplicatas e items j√° processados
                    const isAlreadyAdded = allMenuItems.some(existing => 
                        existing.element === item || 
                        (existing.text === cleanText && cleanText.length > 2)
                    );
                    
                    if (cleanText && cleanText.length > 2 && !isAlreadyAdded && 
                        cleanText !== 'Carregando...' && !cleanText.includes('...')) {
                        
                        let categoryHint = '';
                        let parentElement = item.closest('.accordion-item');
                        if (parentElement) {
                            const mainHeader = parentElement.querySelector('h2, .accordion-header');
                            if (mainHeader) {
                                categoryHint = mainHeader.textContent.replace(/‚ñ∫|‚ñº|\d+/g, '').trim();
                            }
                        }
                        
                        allMenuItems.push({
                            element: item,
                            parent: item.parentElement,
                            text: cleanText,
                            originalText: text,
                            type: 'list-item',
                            categoryName: categoryHint,
                            extraKeywords: '',
                            domIndex: index
                        });
                        totalFound++;
                        
                        console.log(`‚úÖ [${totalFound}] LIST-ITEM: "${cleanText}" (${categoryHint})`);
                    }
                });
                
                // 2.5. Adiciona EXPLICITAMENTE todas as subcategorias de CEL APPS
                const celAppsSubcategories = [
                    { 
                        name: 'Sa√∫de', 
                        selector: 'button:contains("Sa√∫de")', 
                        keywords: 'saude medicina clinica hospital doutor medico enfermeira', 
                        apps: ['Dr. Consulta', 'Alice', 'Conexa Sa√∫de', 'Telemedicina'] 
                    },
                    { 
                        name: 'Comunicar', 
                        selector: 'button:contains("Comunicar")', 
                        keywords: 'comunicacao conversar falar chat mensagem email telefone', 
                        apps: ['WhatsApp', 'WhatsApp Business', 'Telegram', 'Gmail', 'Google Meet', 'Zoom'] 
                    },
                    { 
                        name: 'Banco', 
                        selector: 'button:contains("Banco")', 
                        keywords: 'banco dinheiro conta corrente poupanca cartao pix transferencia', 
                        apps: ['Bradesco', 'Banco do Brasil', 'Caixa', 'Nubank', 'Santander', 'Ita√∫'] 
                    },
                    { 
                        name: 'Alimenta√ß√£o', 
                        selector: 'button:contains("Alimenta√ß√£o")', 
                        keywords: 'alimentacao comida delivery restaurante mercado supermercado', 
                        apps: ['iFood', 'P√£o de A√ß√∫car', 'Carrefour', 'Extra'] 
                    },
                    { 
                        name: 'Utilidades', 
                        selector: 'button:contains("Utilidades")', 
                        keywords: 'utilidade ferramenta mapa navegacao compras loja online', 
                        apps: ['Google Maps', 'Waze', 'Amazon', 'Shopee', 'Mercado Livre', 'Magazine Luiza', 'Casas Bahia', 'Americanas'] 
                    },
                    { 
                        name: 'Lazer', 
                        selector: 'button:contains("Lazer")', 
                        keywords: 'lazer diversao entretenimento video musica filme tv social rede', 
                        apps: ['YouTube', 'PlutoTV', 'Instagram', 'Facebook', 'LinkedIn', 'TikTok'] 
                    },
                    { 
                        name: 'Transporte', 
                        selector: 'button:contains("Transporte")', 
                        keywords: 'transporte viagem taxi uber carro onibus metro', 
                        apps: ['Uber', '99', 'Moovit', 'Citymapper'] 
                    }
                ];
                
                // Adiciona as subcategorias de CEL APPS
                celAppsSubcategories.forEach(subcat => {
                    // Encontra o elemento DOM correspondente
                    let domElement = null;
                    document.querySelectorAll('.sub-accordion-header').forEach(button => {
                        if (button.textContent.includes(subcat.name)) {
                            domElement = button;
                        }
                    });
                    
                    if (domElement) {
                        // Adiciona a subcategoria principal
                        const alreadyExists = allMenuItems.some(item => 
                            item.text.toLowerCase().includes(subcat.name.toLowerCase())
                        );
                        
                        if (!alreadyExists) {
                            allMenuItems.push({
                                element: domElement,
                                parent: domElement.parentElement,
                                text: subcat.name,
                                originalText: domElement.textContent.trim(),
                                type: 'cel-apps-subcategory',
                                categoryName: 'CEL APPS',
                                extraKeywords: subcat.keywords
                            });
                        }
                        
                        // Adiciona todos os apps dessa subcategoria
                        subcat.apps.forEach(appName => {
                            allMenuItems.push({
                                element: domElement, // Usa o mesmo elemento pai
                                parent: domElement.parentElement,
                                text: appName,
                                originalText: appName,
                                type: 'cel-apps-item',
                                categoryName: 'CEL APPS',
                                subcategoryName: subcat.name,
                                extraKeywords: `${subcat.keywords} ${appName.toLowerCase()}`
                            });
                        });
                    }
                });
                
                // 3. Adiciona itens espec√≠ficos conhecidos do JavaScript
                const knownItems = [
                    // Apps de Comunica√ß√£o
                    { name: 'WhatsApp', category: 'Comunicar', keywords: 'chat mensagem conversa' },
                    { name: 'WhatsApp Business', category: 'Comunicar', keywords: 'chat neg√≥cio trabalho' },
                    { name: 'Telegram', category: 'Comunicar', keywords: 'chat mensagem conversa' },
                    { name: 'Gmail', category: 'Comunicar', keywords: 'email correio google' },
                    { name: 'Google Meet', category: 'Comunicar', keywords: 'reuni√£o videoconfer√™ncia google' },
                    { name: 'Zoom', category: 'Comunicar', keywords: 'reuni√£o videoconfer√™ncia' },
                    
                    // Apps de Banco
                    { name: 'Bradesco', category: 'Banco', keywords: 'banco dinheiro pagar conta' },
                    { name: 'Banco do Brasil', category: 'Banco', keywords: 'banco dinheiro pagar conta' },
                    { name: 'Caixa', category: 'Banco', keywords: 'banco dinheiro pagar conta caixa econ√¥mica' },
                    { name: 'Nubank', category: 'Banco', keywords: 'banco dinheiro pagar conta cart√£o' },
                    { name: 'Santander', category: 'Banco', keywords: 'banco dinheiro pagar conta' },
                    { name: 'Ita√∫', category: 'Banco', keywords: 'banco dinheiro pagar conta' },
                    
                    // Apps de Transporte
                    { name: 'Uber', category: 'Transporte', keywords: 'viagem taxi transporte carro' },
                    { name: '99', category: 'Transporte', keywords: 'viagem taxi transporte carro' },
                    { name: 'Google Maps', category: 'Utilidades', keywords: 'mapa navega√ß√£o maps tr√¢nsito localiza√ß√£o' },
                    { name: 'Waze', category: 'Utilidades', keywords: 'mapa navega√ß√£o maps tr√¢nsito' },
                    
                    // Apps de Alimenta√ß√£o
                    { name: 'iFood', category: 'Alimenta√ß√£o', keywords: 'comida delivery entrega restaurante' },
                    { name: 'P√£o de A√ß√∫car', category: 'Alimenta√ß√£o', keywords: 'comida mercado supermercado compras' },
                    
                    // Apps de Compras
                    { name: 'Amazon', category: 'Utilidades', keywords: 'compras loja online ecommerce' },
                    { name: 'Shopee', category: 'Utilidades', keywords: 'compras loja online ecommerce' },
                    { name: 'Mercado Livre', category: 'Utilidades', keywords: 'compras loja online ecommerce mercado' },
                    
                    // Apps de Entretenimento
                    { name: 'YouTube', category: 'Lazer', keywords: 'v√≠deo entretenimento m√∫sica' },
                    { name: 'PlutoTV', category: 'Lazer', keywords: 'tv filme v√≠deo entretenimento' },
                    { name: 'Instagram', category: 'Lazer', keywords: 'social rede foto v√≠deo' },
                    { name: 'Facebook', category: 'Lazer', keywords: 'social rede amigos' },
                    { name: 'LinkedIn', category: 'Lazer', keywords: 'social rede trabalho profissional' },
                    
                    // Ferramentas e Neg√≥cios
                    { name: 'FNW - Formul√°rio Estrat√©gico', category: 'EXCLUSIVO', keywords: 'formul√°rio estrat√©gia neg√≥cio' },
                    { name: 'FNW - ROI Maker', category: 'EXCLUSIVO', keywords: 'roi calculadora retorno investimento' },
                    { name: 'Painel ETO', category: 'EXCLUSIVO', keywords: 'painel dashboard eto' },
                    { name: 'MKT HUB', category: 'EXCLUSIVO', keywords: 'marketing hub mkt publicidade' },
                    { name: 'Longevidade', category: 'EXCLUSIVO', keywords: 'longevidade sa√∫de idade' },
                    { name: 'Analise CNIS', category: 'EXCLUSIVO', keywords: 'cnis an√°lise previd√™ncia' },
                    { name: 'CNIS Suporte', category: 'EXCLUSIVO', keywords: 'cnis suporte previd√™ncia' },
                    
                    // IA e Assistentes
                    { name: 'IA Prompt Wizzard', category: 'EXCLUSIVO', keywords: 'ia intelig√™ncia artificial prompt wizard' },
                    { name: 'Chat Rosio Livia Geriah', category: 'EXCLUSIVO', keywords: 'chat ia assistente rosio livia' },
                    { name: 'HumanIA', category: 'EXCLUSIVO', keywords: 'ia human intelig√™ncia artificial' },
                    { name: 'London Lord', category: 'EXCLUSIVO', keywords: 'london lord assistente' },
                    
                    // Parcerias
                    { name: 'FNW Sinergias', category: 'PARTICIPE', keywords: 'fnw sinergias parceria' },
                    { name: 'IDEIA21', category: 'PARTICIPE', keywords: 'ideia21 ideia parceria' },
                    { name: 'IPSOLON', category: 'PARTICIPE', keywords: 'ipsolon parceria' },
                    { name: 'Feito Por Voc√™', category: 'PARTICIPE', keywords: 'feito voc√™ cria√ß√£o' }
                ];
                
                knownItems.forEach(knownItem => {
                    // Procura o elemento correspondente no DOM
                    let domElement = null;
                    
                    // Busca em bot√µes
                    document.querySelectorAll('aside button, aside .card-menu-item').forEach(element => {
                        const elementText = element.textContent.trim();
                        if (elementText.includes(knownItem.name) || knownItem.name.includes(elementText)) {
                            if (!domElement) { // Pega apenas o primeiro encontrado
                                domElement = element;
                            }
                        }
                    });
                    
                    // Se n√£o encontrou elemento espec√≠fico, adiciona como virtual
                    if (!domElement) {
                        console.log(`‚ö†Ô∏è Item n√£o encontrado no DOM: ${knownItem.name}`);
                    } else {
                        // Verifica se j√° n√£o foi adicionado
                        const alreadyExists = allMenuItems.some(item => 
                            item.text.includes(knownItem.name) || knownItem.name.includes(item.text)
                        );
                        
                        if (!alreadyExists) {
                            allMenuItems.push({
                                element: domElement,
                                parent: domElement.parentElement,
                                text: knownItem.name,
                                originalText: domElement.textContent.trim(),
                                type: 'known-item',
                                categoryName: knownItem.category,
                                extraKeywords: knownItem.keywords
                            });
                        }
                    }
                });
                
                // üéØ ESTAT√çSTICAS FINAIS
                console.log(`\nüìä === RELAT√ìRIO FINAL DE COLETA ===`);
                console.log(`‚úÖ Total de itens coletados: ${totalFound}`);
                console.log(`üìÇ Tipos encontrados:`, [...new Set(allMenuItems.map(item => item.type))]);
                
                // Estat√≠sticas por categoria
                const categoriesStats = {};
                allMenuItems.forEach(item => {
                    const cat = item.categoryName || 'Sem categoria';
                    if (!categoriesStats[cat]) categoriesStats[cat] = 0;
                    categoriesStats[cat]++;
                });
                
                console.log(`\nüìà Itens por categoria:`);
                Object.entries(categoriesStats).forEach(([cat, count]) => {
                    console.log(`  - ${cat}: ${count} itens`);
                });
                
                // Verifica se alguns elementos importantes podem ter sido perdidos
                const missedElements = document.querySelectorAll('aside *');
                console.log(`\nüîç Total de elementos no menu: ${missedElements.length}`);
                console.log(`üìã Taxa de cobertura: ${((totalFound / missedElements.length) * 100).toFixed(1)}%`);
                
                if (totalFound < 50) {
                    console.warn(`‚ö†Ô∏è ATEN√á√ÉO: Apenas ${totalFound} itens coletados. Pode haver elementos sendo perdidos!`);
                }
                
                console.log(`\n‚úÖ === COLETA FINALIZADA ===`);
            }
            
            // üîÑ Sistema de re-indexa√ß√£o autom√°tica
            function setupAutoReindexing() {
                console.log('üîÑ Configurando re-indexa√ß√£o autom√°tica...');
                
                // Re-indexa quando novos elementos aparecem no menu
                const observer = new MutationObserver((mutations) => {
                    let shouldReindex = false;
                    
                    mutations.forEach((mutation) => {
                        if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                            // Verifica se novos elementos foram adicionados ao menu
                            mutation.addedNodes.forEach((node) => {
                                if (node.nodeType === 1 && // √â um elemento
                                    (node.closest('aside') || node.querySelector('aside'))) {
                                    shouldReindex = true;
                                }
                            });
                        }
                        
                        // Verifica mudan√ßas de atributos que podem afetar a busca
                        if (mutation.type === 'attributes' && 
                            (mutation.attributeName === 'style' || 
                            mutation.attributeName === 'data-card-name' || 
                            mutation.attributeName === 'class')) {
                            shouldReindex = true;
                        }
                    });
                    
                    if (shouldReindex) {
                        console.log('üîÑ Detectadas mudan√ßas no menu. Re-indexando...');
                        setTimeout(collectAllMenuItems, 1000); // Delay para permitir que mudan√ßas se completem
                    }
                });
                
                // Observa mudan√ßas no menu
                const menuElement = document.querySelector('aside');
                if (menuElement) {
                    observer.observe(menuElement, {
                        childList: true,
                        subtree: true,
                        attributes: true,
                        attributeFilter: ['style', 'data-card-name', 'class']
                    });
                    console.log('‚úÖ Observer configurado para re-indexa√ß√£o autom√°tica');
                }
            }
            
            // Fun√ß√£o para remover destaques anteriores
            function clearHighlights() {
                document.querySelectorAll('.search-highlighted-item').forEach(item => {
                    item.classList.remove('search-highlighted-item');
                });
            }
            
            // Fun√ß√£o para expandir acorde√µes pais
            function expandParentAccordions(element) {
                let current = element;
                while (current && current !== document.body) {
                    // Verifica se √© um acorde√£o fechado
                    if (current.classList.contains('accordion-content') && current.style.display === 'none') {
                        current.style.display = 'block';
                        const header = current.previousElementSibling;
                        if (header && header.classList.contains('accordion-header')) {
                            header.classList.add('active');
                            const icon = header.querySelector('.accordion-icon');
                            if (icon) icon.textContent = '‚ñº';
                        }
                    }
                    
                    // Verifica se √© um sub-acorde√£o fechado (CEL APPS subcategorias)
                    if (current.classList.contains('sub-accordion-content') && current.style.display === 'none') {
                        current.style.display = 'block';
                        const header = current.previousElementSibling;
                        if (header && header.classList.contains('sub-accordion-header')) {
                            header.classList.add('active');
                            const icon = header.querySelector('.sub-accordion-icon');
                            if (icon) icon.textContent = '‚ñº';
                        }
                    }
                    
                    // Verifica se √© um sub-sub-acorde√£o fechado
                    if (current.classList.contains('sub-sub-accordion-content') && current.style.display === 'none') {
                        current.style.display = 'block';
                        const header = current.previousElementSibling;
                        if (header && header.classList.contains('sub-sub-accordion-header')) {
                            header.classList.add('active');
                            const icon = header.querySelector('.sub-accordion-icon');
                            if (icon) icon.textContent = '‚ñº';
                        }
                    }
                    
                    // Verifica se √© um sub-acorde√£o fechado
                    if (current.classList.contains('sub-accordion-content') && current.style.display === 'none') {
                        current.style.display = 'block';
                        const header = current.previousElementSibling;
                        if (header && header.classList.contains('sub-accordion-header')) {
                            const icon = header.querySelector('.sub-accordion-icon');
                            if (icon) icon.textContent = '‚ñº';
                        }
                    }
                    
                    // Verifica se √© um sub-sub-acorde√£o fechado
                    if (current.classList.contains('sub-sub-accordion-content') && current.style.display === 'none') {
                        current.style.display = 'block';
                        const header = current.previousElementSibling;
                        if (header && header.classList.contains('sub-sub-accordion-header')) {
                            const icon = header.querySelector('.sub-accordion-icon');
                            if (icon) icon.textContent = '‚ñº';
                        }
                    }
                    
                    current = current.parentElement;
                }
            }
            
            // Mapa de palavras-chave especiais para melhorar a busca
            const specialKeywords = {
                // Navega√ß√£o e mapas
                'mapa': ['Google Maps', 'Waze'],
                'maps': ['Google Maps', 'Waze'],
                'navega√ß√£o': ['Google Maps', 'Waze'],
                'tr√¢nsito': ['Google Maps', 'Waze'],
                'localiza√ß√£o': ['Google Maps', 'Waze'],
                
                // Bancos e pagamentos
                'banco': ['Bradesco', 'Banco do Brasil', 'Caixa', 'Nubank', 'Santander', 'Ita√∫'],
                'dinheiro': ['Bradesco', 'Banco do Brasil', 'Caixa', 'Nubank', 'Santander', 'Ita√∫'],
                'pagar': ['Bradesco', 'Banco do Brasil', 'Caixa', 'Nubank', 'Santander', 'Ita√∫'],
                'conta': ['Bradesco', 'Banco do Brasil', 'Caixa', 'Nubank', 'Santander', 'Ita√∫'],
                'cart√£o': ['Nubank', 'Bradesco', 'Santander', 'Ita√∫'],
                
                // Alimenta√ß√£o e compras
                'comida': ['iFood', 'P√£o de A√ß√∫car'],
                'delivery': ['iFood'],
                'entrega': ['iFood'],
                'restaurante': ['iFood'],
                'mercado': ['P√£o de A√ß√∫car', 'Mercado Livre'],
                'supermercado': ['P√£o de A√ß√∫car'],
                'compras': ['Amazon', 'Shopee', 'Mercado Livre', 'P√£o de A√ß√∫car'],
                'loja': ['Amazon', 'Shopee', 'Mercado Livre'],
                'ecommerce': ['Amazon', 'Shopee', 'Mercado Livre'],
                
                // Transporte
                'transporte': ['Uber', '99'],
                'viagem': ['Uber', '99'],
                'taxi': ['Uber', '99'],
                'carro': ['Uber', '99'],
                
                // Comunica√ß√£o
                'chat': ['WhatsApp', 'Telegram', 'WhatsApp Business'],
                'conversa': ['WhatsApp', 'Telegram'],
                'mensagem': ['WhatsApp', 'Telegram'],
                'email': ['Gmail'],
                'correio': ['Gmail'],
                'reuni√£o': ['Google Meet', 'Zoom'],
                'videoconfer√™ncia': ['Google Meet', 'Zoom'],
                'meet': ['Google Meet'],
                
                // Redes sociais
                'social': ['Instagram', 'Facebook', 'LinkedIn'],
                'rede': ['Instagram', 'Facebook', 'LinkedIn'],
                'foto': ['Instagram'],
                'amigos': ['Facebook'],
                'trabalho': ['LinkedIn', 'WhatsApp Business'],
                'profissional': ['LinkedIn', 'WhatsApp Business'],
                'neg√≥cio': ['WhatsApp Business'],
                
                // Entretenimento
                'v√≠deo': ['YouTube', 'PlutoTV'],
                'filme': ['PlutoTV'],
                'tv': ['PlutoTV'],
                'entretenimento': ['YouTube', 'PlutoTV', 'Instagram'],
                'm√∫sica': ['YouTube'],
                
                // IA e tecnologia
                'ia': ['IA Prompt Wizzard', 'HumanIA', 'Chat Rosio Livia Geriah'],
                'intelig√™ncia': ['IA Prompt Wizzard', 'HumanIA'],
                'artificial': ['IA Prompt Wizzard', 'HumanIA'],
                'assistente': ['Chat Rosio Livia Geriah', 'HumanIA', 'London Lord'],
                'prompt': ['IA Prompt Wizzard'],
                'wizard': ['IA Prompt Wizzard'],
                'rosio': ['Chat Rosio Livia Geriah'],
                'livia': ['Chat Rosio Livia Geriah'],
                'london': ['London Lord'],
                
                // Ferramentas de neg√≥cio
                'formul√°rio': ['FNW - Formul√°rio Estrat√©gico'],
                'estrat√©gia': ['FNW - Formul√°rio Estrat√©gico'],
                'roi': ['FNW - ROI Maker'],
                'retorno': ['FNW - ROI Maker'],
                'investimento': ['FNW - ROI Maker'],
                'calculadora': ['FNW - ROI Maker'],
                'painel': ['Painel ETO'],
                'dashboard': ['Painel ETO'],
                'eto': ['Painel ETO'],
                'marketing': ['MKT HUB'],
                'mkt': ['MKT HUB'],
                'hub': ['MKT HUB'],
                'publicidade': ['MKT HUB'],
                
                // Sa√∫de e previd√™ncia
                'sa√∫de': ['Sa√∫de'],
                'longevidade': ['Longevidade'],
                'idade': ['Longevidade'],
                'cnis': ['Analise CNIS', 'CNIS Suporte'],
                'previd√™ncia': ['Analise CNIS', 'CNIS Suporte'],
                'an√°lise': ['Analise CNIS'],
                'suporte': ['CNIS Suporte'],
                
                // Parcerias
                'parceria': ['Parcerias', 'FNW Sinergias', 'IDEIA21', 'IPSOLON'],
                'fnw': ['FNW Sinergias', 'FNW - Formul√°rio Estrat√©gico', 'FNW - ROI Maker'],
                'sinergias': ['FNW Sinergias'],
                'ideia': ['IDEIA21'],
                'ipsolon': ['IPSOLON'],
                'feito': ['Feito Por Voc√™'],
                'cria√ß√£o': ['Feito Por Voc√™']
            };
            
            // Fun√ß√£o principal de busca
            function performSearch(query) {
                clearHighlights();
                
                if (!query || query.length < 1) {
                    clearButton.style.display = 'none';
                    return;
                }
                
                clearButton.style.display = 'block';
                const lowerQuery = query.toLowerCase();
                let foundItems = [];
                
                // Verifica se a query corresponde a alguma palavra-chave especial
                let specialMatches = [];
                Object.keys(specialKeywords).forEach(keyword => {
                    if (keyword.includes(lowerQuery) || lowerQuery.includes(keyword)) {
                        specialMatches = specialMatches.concat(specialKeywords[keyword]);
                    }
                });
                
                // Busca nos itens coletados com m√∫ltiplos crit√©rios
                allMenuItems.forEach(item => {
                    // Busca no texto principal
                    const textMatch = item.text.toLowerCase().includes(lowerQuery);
                    
                    // Busca no texto original (pode conter mais informa√ß√µes)
                    const originalTextMatch = item.originalText && item.originalText.toLowerCase().includes(lowerQuery);
                    
                    // Busca nas palavras-chave extras
                    const keywordMatch = item.extraKeywords && item.extraKeywords.toLowerCase().includes(lowerQuery);
                    
                    // Busca na categoria
                    const categoryMatch = item.categoryName && item.categoryName.toLowerCase().includes(lowerQuery);
                    
                    // Busca no cardName se existir
                    const cardNameMatch = item.cardName && item.cardName.toLowerCase().includes(lowerQuery);
                    
                    // Verifica se o item corresponde a alguma palavra-chave especial
                    const specialMatch = specialMatches.some(appName => {
                        const itemLower = item.text.toLowerCase();
                        const appNameLower = appName.toLowerCase();
                        return itemLower.includes(appNameLower) || appNameLower.includes(itemLower);
                    });
                    
                    // Busca parcial mais flex√≠vel (para nomes compostos)
                    const partialMatch = lowerQuery.length >= 3 && (
                        item.text.toLowerCase().indexOf(lowerQuery) !== -1 ||
                        (item.extraKeywords && item.extraKeywords.toLowerCase().indexOf(lowerQuery) !== -1)
                    );
                    
                    if (textMatch || originalTextMatch || keywordMatch || categoryMatch || cardNameMatch || specialMatch || partialMatch) {
                        foundItems.push(item);
                        
                        // Destaca o item
                        item.element.classList.add('search-highlighted-item');
                        
                        // Expande acorde√µes pais para tornar o item vis√≠vel
                        expandParentAccordions(item.element);
                        
                        // Log para debug
                        console.log(`üîç Encontrado: "${item.text}" (tipo: ${item.type})`);
                        
                        // Rola para o primeiro item encontrado
                        if (foundItems.length === 1) {
                            item.element.scrollIntoView({
                                behavior: 'smooth',
                                block: 'center'
                            });
                        }
                    }
                });
                
                console.log(`Busca por "${query}": encontrados ${foundItems.length} itens`);
                
                // Feedback visual no campo de busca
                if (foundItems.length > 0) {
                    searchInput.style.borderColor = '#4CAF50';
                    searchInput.style.boxShadow = '0 0 10px rgba(76, 175, 80, 0.3)';
                } else {
                    searchInput.style.borderColor = '#FF5722';
                    searchInput.style.boxShadow = '0 0 10px rgba(255, 87, 34, 0.3)';
                }
            }
            
            // Event listener para busca em tempo real
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.trim();
                performSearch(query);
            });
            
            // Event listener para limpar busca
            clearButton.addEventListener('click', () => {
                searchInput.value = '';
                clearHighlights();
                clearButton.style.display = 'none';
                searchInput.style.borderColor = 'rgba(255, 255, 255, 0.2)';
                searchInput.style.boxShadow = 'none';
                searchInput.focus();
            });
            
            // Event listener para tecla ESC
            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    searchInput.value = '';
                    clearHighlights();
                    clearButton.style.display = 'none';
                    searchInput.style.borderColor = 'rgba(255, 255, 255, 0.2)';
                    searchInput.style.boxShadow = 'none';
                }
            });
            
            // Coleta inicial dos itens
            collectAllMenuItems();
            
            // Ativa re-indexa√ß√£o autom√°tica
            setupAutoReindexing();
            
            // Re-indexa periodicamente para capturar elementos carregados dinamicamente
            setInterval(() => {
                console.log('üîÑ Re-indexa√ß√£o peri√≥dica...');
                collectAllMenuItems();
            }, 30000); // A cada 30 segundos
            
            // Re-coleta itens quando o DOM muda (√∫til para itens din√¢micos)
            const observer = new MutationObserver(() => {
                setTimeout(collectAllMenuItems, 100);
            });
            
            observer.observe(document.querySelector('aside'), {
                childList: true,
                subtree: true
            });
            
            console.log('Busca em tempo real configurada com sucesso!');
            
            } catch (error) {
                console.error('Erro ao configurar busca em tempo real:', error);
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            // ===== DEBUG INICIAL =====
            alert('üöÄ JavaScript carregou! DOMContentLoaded executando...');
            
            const aside = document.querySelector('aside'); // Definir aside aqui para escopo
            const menuToggle = document.getElementById('menuToggle');
            const body = document.body;

            // Inicializa o menu mobile
            if (menuToggle) {
                menuToggle.addEventListener('click', () => {
                    body.classList.toggle('sidebar-open');
                });
            }

            // Event listeners para modo de edi√ß√£o
            const editModeToggle = document.getElementById('editModeToggle');
            const confirmEditMode = document.getElementById('confirmEditMode');
            const cancelEditMode = document.getElementById('cancelEditMode');
            const editModeConfirmClose = document.getElementById('editModeConfirmClose');
            const supportLogo = document.getElementById('supportLogo');

            // LIMPEZA COMPLETA E FOR√áADA - ESTADO SEMPRE LIMPO
            // Remove TODOS os estados salvos relacionados ao modo de edi√ß√£o
            localStorage.removeItem('editMode');
            localStorage.removeItem('toggleVisible');
            
            // For√ßa estado inicial completamente limpo
            isEditMode = false;
            isToggleVisible = false;
            
            // Remove todas as classes e estados visuais
            body.classList.remove('edit-mode');
            document.getElementById('headerTitle').textContent = 'Acessos';
            document.getElementById('editModeToggleContainer').style.setProperty('display', 'none', 'important');
            
            // Limpa o toggle e logo
            if (editModeToggle) editModeToggle.checked = false;
            if (supportLogo) {
                supportLogo.classList.remove('toggle-visible');
                supportLogo.style.opacity = '0.4'; // For√ßa opacidade inicial
            }
            
            // Remove classes edit√°veis
            removeEditableClasses();
            
            // Debug para verificar estado inicial
            console.log('Estado inicial:', {
                isEditMode: isEditMode,
                isToggleVisible: isToggleVisible,
                toggleDisplay: document.getElementById('editModeToggleContainer').style.display,
                bodyClasses: body.className
            });

            // N√£o restaurar NADA do localStorage - sempre come√ßar do zero
            // Comentado para for√ßar estado limpo:
            // const savedToggleVisible = localStorage.getItem('toggleVisible') === 'true';
            // if (savedToggleVisible) { ... }

            // Preparando para futuras implementa√ß√µes de controle de acesso/pagamento

            // Clique no logo de suporte para mostrar/esconder toggle
            if (supportLogo) {
                supportLogo.addEventListener('click', () => {
                    toggleEditModeVisibility();
                });
            }

            // Toggle do modo de edi√ß√£o
            if (editModeToggle) {
                editModeToggle.addEventListener('change', (e) => {
                    if (e.target.checked && !isEditMode) {
                        // Tentar ativar - mostrar confirma√ß√£o
                        showEditModeConfirmation();
                        // Reverter o toggle at√© a confirma√ß√£o
                        e.target.checked = false;
                    } else if (!e.target.checked && isEditMode) {
                        // Desativar diretamente
                        toggleEditMode(false);
                    }
                });
            }

            // Confirmar ativa√ß√£o do modo de edi√ß√£o
            if (confirmEditMode) {
                confirmEditMode.addEventListener('click', () => {
                    toggleEditMode(true);
                    hideEditModeConfirmation();
                });
            }

            // Cancelar ativa√ß√£o do modo de edi√ß√£o
            if (cancelEditMode) {
                cancelEditMode.addEventListener('click', () => {
                    hideEditModeConfirmation();
                });
            }

            // Fechar modal de confirma√ß√£o
            if (editModeConfirmClose) {
                editModeConfirmClose.addEventListener('click', () => {
                    hideEditModeConfirmation();
                });
            }

            // Adiciona um listener para cliques fora da sidebar quando ela est√° aberta
            document.addEventListener('click', (event) => {
                if (body.classList.contains('sidebar-open') &&
                    !aside.contains(event.target) &&
                    !menuToggle.contains(event.target) &&
                    !event.target.closest('#searchResults')) {
                    closeSidebar();
                }
            });

            adjustForEmbeddedMode(); 
            fetchCategories();
            renderMeusAppsCategoriesSidebar(); // Adicionando chamada para renderizar a nova categoria 'MeusApps'
            // renderPaiCategoriesSidebar(); // COMENTADO: N√£o sobrescrever estrutura HTML customizada
            // renderSuporteIaSubcategoriesSidebar(); // COMENTADO: N√£o sobrescrever estrutura HTML customizada
            // renderParticipeCategoriesSidebar(); // COMENTADO: N√£o sobrescrever estrutura HTML customizada
            renderVideosCategoriesSidebar(); // Adicionando chamada para renderizar a nova categoria 'Videos'
            
            // ================ INICIALIZA√á√ÉO FAVORITOS ================
            console.log('üöÄ JavaScript executando...');
            
            // Inicializar lista de favoritos
            setTimeout(() => {
                updateFavoritesList();
                console.log('‚úÖ Lista de favoritos inicializada');
            }, 1000);
            
            // Inicializar busca em tempo real
            setupRealTimeMenuSearch();

            // ============== SISTEMA DE PERSONALIZA√á√ÉO DE CORES ==============
            initializeColorCustomization();

            // ============== CARREGAMENTO DA NOMENCLATURA INDIVIDUAL ==============
            loadUserTypeLabel();
            
            // ============== CARREGAMENTO DO LOGO DO USU√ÅRIO ==============
            loadUserTypeLogo();
            
            // ============== SINCRONIZA√á√ÉO DE LOGOS ==============
            console.log('üéØ Sistema de Logo sincronizado carregado!');

            const paiModal = document.getElementById('paiModal');
            const paiModalClose = document.getElementById('paiModalClose');
            const paiModalIframe = document.getElementById('paiModalIframe');

            if (paiModal && paiModalClose && paiModalIframe) {
                paiModalClose.addEventListener('click', () => {
                    paiModal.classList.add('hidden');
                    paiModalIframe.src = 'about:blank'; // Limpa o iframe para parar carregamento
                });
            }

            // Event listeners para o modal de app
            const appModal = document.getElementById('appModal');
            const appModalClose = document.getElementById('appModalClose');

            if (appModal && appModalClose) {
                appModalClose.addEventListener('click', () => {
                    appModal.classList.add('hidden');
                });
            }

            // Accordion functionality for sidebar
            document.querySelectorAll('aside .accordion-header').forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;
                    const icon = header.querySelector('.accordion-icon');
                    const isMeusAppsHeader = header.textContent.trim().startsWith('Meus Apps');
                    const isPaiHeader = header.textContent.trim().startsWith('EXCLUSIVO');
                    const isParticipeHeader = header.textContent.trim().startsWith('Participe');
                    
                    if (!content) return;

                    const isVisible = content.style.display === 'block';
                    
                    // Remove active de todos os cabe√ßalhos principais
                    document.querySelectorAll('aside .accordion-header').forEach(h => {
                        if (h !== header) {
                            h.classList.remove('active');
                        }
                    });
                    
                    document.querySelectorAll('aside .accordion-content').forEach(c => {
                        if (c !== content) {
                            c.style.display = 'none';
                            const otherIcon = c.previousElementSibling.querySelector('.accordion-icon');
                            if (otherIcon) otherIcon.textContent = '‚ñ∫';
                        }
                    });

                    content.style.display = isVisible ? 'none' : 'block';
                    if (icon) {
                        icon.textContent = isVisible ? '‚ñ∫' : '‚ñº';
                    }
                    
                    // Adiciona ou remove active do cabe√ßalho clicado
                    if (isVisible) {
                        header.classList.remove('active');
                    } else {
                        header.classList.add('active');
                    }

                    // Mensagens espec√≠ficas para cada categoria principal
                    if (isMeusAppsHeader && !isVisible) {
                        document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma subcategoria de Meus Apps na lista.</p>';
                    } else if (isMeusAppsHeader && isVisible) {
                        document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione um conte√∫do ou ferramenta ao lado.</p>';
                    } else if (isPaiHeader && !isVisible) {
                        document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma categoria dentro de EXCLUSIVO na lista.</p>';
                    } else if (isPaiHeader && isVisible) {
                        document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione um conte√∫do ou ferramenta ao lado.</p>';
                    } else if (isParticipeHeader && !isVisible) {
                        document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma op√ß√£o da categoria Participe na lista.</p>';
                    } else if (isParticipeHeader && isVisible) {
                        document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma op√ß√£o da categoria Participe na lista.</p>';
                    }
                });
            });

            // Sub-accordion functionality for PAI category
            document.querySelectorAll('.sub-accordion-header').forEach(subHeader => {
                subHeader.addEventListener('click', () => {
                    const subContent = subHeader.nextElementSibling;
                    const subIcon = subHeader.querySelector('.sub-accordion-icon');
                    const subHeaderText = subHeader.textContent.trim();
                    
                    if (!subContent) return;

                    const isSubVisible = subContent.style.display === 'block';
                    
                    // Fecha todos os outros sub-acorde√µes
                    document.querySelectorAll('.sub-accordion-content').forEach(c => {
                        if (c !== subContent) {
                            c.style.display = 'none';
                            const otherSubIcon = c.previousElementSibling.querySelector('.sub-accordion-icon');
                            if (otherSubIcon) otherSubIcon.textContent = '‚ñ∫';
                            c.previousElementSibling.classList.remove('active');
                        }
                    });

                    subContent.style.display = isSubVisible ? 'none' : 'block';
                    if (subIcon) {
                        subIcon.textContent = isSubVisible ? '‚ñ∫' : '‚ñº';
                    }
                    
                    if (isSubVisible) {
                        subHeader.classList.remove('active');
                        document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma categoria dentro de EXCLUSIVO na lista.</p>';
                    } else {
                        subHeader.classList.add('active');
                        
                        // Mensagens espec√≠ficas para cada sub-categoria
                        if (subHeaderText.startsWith('Videos Dispon√≠veis')) {
                            document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma op√ß√£o da categoria Videos Dispon√≠veis na lista.</p>';
                        } else if (subHeaderText.startsWith('Conte√∫do de Apoio')) {
                            document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma categoria ao lado para ver os recursos.</p>';
                        } else if (subHeaderText.startsWith('Ferramentas')) {
                            document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma subcategoria de Ferramentas & Neg√≥cios na lista.</p>';
                        } else if (subHeaderText.startsWith('Suporte - IA')) {
                            document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma subcategoria de Suporte - IA na lista.</p>';
                        } else if (subHeaderText.startsWith('Parcerias')) {
                            document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma subcategoria de Parcerias na lista.</p>';
                        }
                    }
                });
            });

            // Sub-sub-accordion functionality (Terceiro N√≠vel)
            document.querySelectorAll('.sub-sub-accordion-header').forEach(subSubHeader => {
                subSubHeader.addEventListener('click', () => {
                    const subSubContent = subSubHeader.nextElementSibling;
                    const subSubIcon = subSubHeader.querySelector('.sub-accordion-icon');
                    const subSubHeaderText = subSubHeader.textContent.trim();
                    
                    if (!subSubContent) return;

                    const isSubSubVisible = subSubContent.style.display === 'block';
                    
                    // Fecha todos os outros sub-sub-acorde√µes
                    document.querySelectorAll('.sub-sub-accordion-content').forEach(c => {
                        if (c !== subSubContent) {
                            c.style.display = 'none';
                            const otherSubSubIcon = c.previousElementSibling.querySelector('.sub-accordion-icon');
                            if (otherSubSubIcon) otherSubSubIcon.textContent = '‚ñ∫';
                            c.previousElementSibling.classList.remove('active');
                        }
                    });

                    subSubContent.style.display = isSubSubVisible ? 'none' : 'block';
                    if (subSubIcon) {
                        subSubIcon.textContent = isSubSubVisible ? '‚ñ∫' : '‚ñº';
                    }
                    
                    if (isSubSubVisible) {
                        subSubHeader.classList.remove('active');
                        document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione um card na lista.</p>';
                    } else {
                        subSubHeader.classList.add('active');
                        
                        // Mensagens espec√≠ficas para cada sub-sub-categoria
                        if (subSubHeaderText.startsWith('FNW Assessoria')) {
                            document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma ferramenta da FNW Assessoria na lista.</p>';
                        } else if (subSubHeaderText.startsWith('50+ | Maduros')) {
                            document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione um recurso para Maduros e Idosos na lista.</p>';
                        } else if (subSubHeaderText.startsWith('Assistentes')) {
                            document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione um assistente de IA na lista.</p>';
                        } else if (subSubHeaderText.startsWith('Empresas Parceiras')) {
                            document.getElementById('coursesContainer').innerHTML = '<p class="instruction-message">Selecione uma empresa parceira na lista.</p>';
                        }
                    }
                });
            });

            // Card menu items functionality
            document.querySelectorAll('.card-menu-item').forEach(cardItem => {
                cardItem.addEventListener('click', () => {
                    const cardName = cardItem.getAttribute('data-card-name');
                    
                    // Remove active de todos os card-menu-items
                    document.querySelectorAll('.card-menu-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    
                    // Adiciona active ao item clicado
                    cardItem.classList.add('active');
                    
                    // Procura pelo card correspondente na √°rea principal
                    const realCard = Array.from(document.querySelectorAll('.card, .course-card, .resource-card')).find(card => {
                        const cardTitle = card.querySelector('h3, .card-title, .course-title');
                        return cardTitle && cardTitle.textContent.trim() === cardName;
                    });
                    
                    if (realCard) {
                        // Simula um clique no card da √°rea principal
                        realCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        
                        // Adiciona destaque tempor√°rio
                        realCard.classList.add('card-highlighted');
                        setTimeout(() => {
                            realCard.classList.remove('card-highlighted');
                        }, 2000);
                        
                        // Se o card for clic√°vel, simula o clique
                        if (realCard.onclick || realCard.getAttribute('onclick')) {
                            realCard.click();
                        }
                    } else {
                        // Se n√£o encontrar o card, mostra uma mensagem
                        document.getElementById('coursesContainer').innerHTML = `
                            <p class="instruction-message">
                                üîç Procurando por "${cardName}"...<br>
                                <small>Este card pode estar em outra categoria ou ainda n√£o foi carregado.</small>
                            </p>
                        `;
                    }
                    
                    // Fecha o sidebar no mobile
                    closeSidebar();
                });
            });

            // Event listeners para o Modal de Edi√ß√£o Individual
            const itemEditClose = document.getElementById('itemEditClose');
            const cancelItemEdit = document.getElementById('cancelItemEdit');
            const saveItemEdit = document.getElementById('saveItemEdit');

            if (itemEditClose) {
                itemEditClose.addEventListener('click', closeItemEditModal);
            }

            if (cancelItemEdit) {
                cancelItemEdit.addEventListener('click', closeItemEditModal);
            }

            if (saveItemEdit) {
                saveItemEdit.addEventListener('click', () => {
                    saveItemEditData();
                });
            }

            // Carrega dados personalizados salvos
            loadCustomItemData();

            // Event listeners para modal de edi√ß√£o de cards
            document.getElementById('cardEditModalClose').addEventListener('click', closeCardEditModal);
            document.getElementById('cancelCardEdit').addEventListener('click', closeCardEditModal);
            document.getElementById('saveCardEdit').addEventListener('click', saveCardEdit);

            // Fecha modal de edi√ß√£o de cards ao clicar fora
            document.getElementById('cardEditModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeCardEditModal();
                }
            });

            // Carrega dados personalizados
            loadCustomItemData();

            // Event listeners para modal de edi√ß√£o de itens simples
            document.getElementById('simpleItemEditModalClose').addEventListener('click', closeSimpleItemEditModal);
            document.getElementById('cancelSimpleItemEdit').addEventListener('click', closeSimpleItemEditModal);
            document.getElementById('saveSimpleItemEdit').addEventListener('click', saveSimpleItemEdit);

            // Fecha modal de edi√ß√£o de itens simples ao clicar fora
            document.getElementById('simpleItemEditModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeSimpleItemEditModal();
                }
            });

            // Carrega dados personalizados
            loadCustomItemData();
            
            // Event listeners para modal de adicionar favorito
            document.getElementById('addFavoriteModalClose').addEventListener('click', closeAddFavoriteModal);
            document.getElementById('cancelAddFavorite').addEventListener('click', closeAddFavoriteModal);
            document.getElementById('saveAddFavorite').addEventListener('click', saveNewFavorite);

            // Event listeners para o modal de substitui√ß√£o
            document.getElementById('replaceFavoriteClose').addEventListener('click', closeReplaceFavoriteModal);
            document.getElementById('cancelReplace').addEventListener('click', closeReplaceFavoriteModal);

            // Fecha modal de adicionar favorito ao clicar fora
            document.getElementById('addFavoriteModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeAddFavoriteModal();
                }
            });
            
            // Criar √≠ndice de busca ap√≥s tudo estar carregado
            setTimeout(() => {
                createMenuSearchIndex();
                setupCardMenuEventListeners(); // Adiciona event listeners para os card-menu-items
                setupCardKeyboardNavigation(); // Ativa navega√ß√£o por teclado
                setupBidirectionalSync(); // Sincroniza√ß√£o bidirecional
                console.log('üîç √çndice de busca criado ap√≥s estrutura HTML estar pronta');
                console.log('‚å®Ô∏è Navega√ß√£o por teclado ativada (setas + Enter)');
                console.log('üîÑ Sincroniza√ß√£o bidirecional ativada');
            }, 1000);
        });

        // Fun√ß√£o para configurar event listeners dos card-menu-items
        function setupCardMenuEventListeners() {
            console.log('üéØ Configurando event listeners para card-menu-items...');
            
            // Remove event listeners anteriores para evitar duplica√ß√£o
            document.querySelectorAll('.card-menu-item').forEach(cardItem => {
                cardItem.replaceWith(cardItem.cloneNode(true));
            });
            
            // Adiciona novos event listeners
            document.querySelectorAll('.card-menu-item').forEach(cardItem => {
                cardItem.addEventListener('click', () => {
                    const cardName = cardItem.getAttribute('data-card-name');
                    console.log('üéØ Card menu clicado:', cardName);
                    
                    // SINCRONIZA√á√ÉO: Atualiza estado do menu
                    syncMenuSelection(cardName);
                    
                    // Procura pelo card correspondente na √°rea principal
                    const realCard = Array.from(document.querySelectorAll('.card, .course-card, .resource-card')).find(card => {
                        const cardTitle = card.querySelector('h3, .card-title, .course-title');
                        return cardTitle && cardTitle.textContent.trim() === cardName;
                    });
                    
                    if (realCard) {
                        console.log('‚úÖ Card encontrado na √°rea principal:', cardName);
                        // Centraliza o card no carrossel
                        centerCardInCarousel(realCard);
                        
                        // Adiciona destaque tempor√°rio
                        realCard.classList.add('card-highlighted');
                        setTimeout(() => {
                            realCard.classList.remove('card-highlighted');
                        }, 2000);
                    } else {
                        console.log('‚ùå Card n√£o encontrado na √°rea principal:', cardName);
                        // Tenta carregar a categoria correspondente primeiro
                        loadCardCategory(cardName);
                    }
                    
                    // Fecha o sidebar no mobile
                    closeSidebar();
                });
            });
            
            console.log('‚úÖ Event listeners configurados para', document.querySelectorAll('.card-menu-item').length, 'card-menu-items');
        }

        // Fun√ß√£o para sincronizar sele√ß√£o do menu
        function syncMenuSelection(cardName) {
            console.log('üîÑ Sincronizando sele√ß√£o do menu para:', cardName);
            
            // Remove active de todos os card-menu-items
            document.querySelectorAll('.card-menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Remove destaque de todos os cards
            document.querySelectorAll('.course-card, .card, .resource-card').forEach(card => {
                card.classList.remove('card-selected');
            });
            
            // Busca EXATA por correspond√™ncia no menu
            const targetMenuItem = Array.from(document.querySelectorAll('.card-menu-item')).find(item => {
                const itemCardName = item.getAttribute('data-card-name');
                return itemCardName && itemCardName.trim() === cardName.trim();
            });
            
            if (targetMenuItem) {
                targetMenuItem.classList.add('active');
                console.log('‚úÖ Menu item ativado:', cardName);
                
                // Expande o caminho do menu at√© o item se necess√°rio
                expandMenuPathToItem(targetMenuItem);
                
                // Scroll suave at√© o item no menu
                targetMenuItem.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center',
                    inline: 'nearest'
                });
            } else {
                console.log('‚ö†Ô∏è Menu item n√£o encontrado para:', cardName);
                // Lista todos os card-menu-items dispon√≠veis para debug
                const availableItems = Array.from(document.querySelectorAll('.card-menu-item')).map(item => 
                    item.getAttribute('data-card-name')
                );
                console.log('üìã Itens dispon√≠veis no menu:', availableItems);
            }
            
            // Busca EXATA por correspond√™ncia no card
            const targetCard = Array.from(document.querySelectorAll('.course-card, .card, .resource-card')).find(card => {
                const cardTitle = card.querySelector('h3, .card-title, .course-title');
                return cardTitle && cardTitle.textContent.trim() === cardName.trim();
            });
            
            if (targetCard) {
                targetCard.classList.add('card-selected');
                console.log('‚úÖ Card destacado:', cardName);
                
                // Centraliza o card no carrossel
                centerCardInCarousel(targetCard);
            } else {
                console.log('‚ö†Ô∏è Card n√£o encontrado na √°rea principal para:', cardName);
                // Lista todos os cards dispon√≠veis para debug
                const availableCards = Array.from(document.querySelectorAll('.course-card, .card, .resource-card')).map(card => {
                    const cardTitle = card.querySelector('h3, .card-title, .course-title');
                    return cardTitle ? cardTitle.textContent.trim() : 'Sem t√≠tulo';
                });
                console.log('üìã Cards dispon√≠veis na √°rea principal:', availableCards);
            }
            
            // Atualiza estado global
            window.currentSelectedCard = cardName;
            
            // Dispara evento personalizado para outros componentes
            window.dispatchEvent(new CustomEvent('cardSelectionChanged', { 
                detail: { cardName: cardName } 
            }));
        }

        // Fun√ß√£o para expandir o caminho do menu at√© um item espec√≠fico
        function expandMenuPathToItem(menuItem) {
            console.log('üîç Expandindo caminho do menu at√© o item...');
            
            // Encontra todos os containers pais que precisam estar expandidos
            let currentElement = menuItem;
            const containersToExpand = [];
            
            while (currentElement && currentElement !== document.body) {
                // Verifica se √© um accordion content que precisa estar vis√≠vel
                if (currentElement.classList.contains('sub-sub-accordion-content') ||
                    currentElement.classList.contains('sub-accordion-content') ||
                    currentElement.classList.contains('accordion-content')) {
                    
                    const header = currentElement.previousElementSibling;
                    if (header && currentElement.style.display === 'none') {
                        containersToExpand.push(header);
                    }
                }
                currentElement = currentElement.parentElement;
            }
            
            // Expande os containers na ordem correta (do mais externo para o mais interno)
            containersToExpand.reverse().forEach((header, index) => {
                setTimeout(() => {
                    if (header.click) {
                        console.log('üîì Expandindo container:', header.textContent.trim());
                        header.click();
                    }
                }, index * 100); // Pequeno delay entre cada expans√£o
            });
        }

        // Fun√ß√£o para navegar entre cards com teclado
        function setupCardKeyboardNavigation() {
            document.addEventListener('keydown', (e) => {
                const currentCards = document.querySelectorAll('.course-card');
                const currentActive = document.querySelector('.card-menu-item.active');
                
                if (currentCards.length === 0) return;
                
                let currentIndex = -1;
                if (currentActive) {
                    const activeCardName = currentActive.getAttribute('data-card-name');
                    currentIndex = Array.from(currentCards).findIndex(card => {
                        const cardTitle = card.querySelector('h3');
                        return cardTitle && cardTitle.textContent.trim() === activeCardName;
                    });
                }
                
                let newIndex = currentIndex;
                
                // Navega√ß√£o com setas
                if (e.key === 'ArrowRight' || e.key === 'ArrowDown') {
                    e.preventDefault();
                    newIndex = (currentIndex + 1) % currentCards.length;
                } else if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') {
                    e.preventDefault();
                    newIndex = currentIndex <= 0 ? currentCards.length - 1 : currentIndex - 1;
                } else if (e.key === 'Enter' && currentIndex >= 0) {
                    e.preventDefault();
                    currentCards[currentIndex].click();
                    return;
                }
                
                // Atualiza sele√ß√£o se mudou
                if (newIndex !== currentIndex && newIndex >= 0) {
                    const newCard = currentCards[newIndex];
                    const newCardTitle = newCard.querySelector('h3');
                    if (newCardTitle) {
                        const cardName = newCardTitle.textContent.trim();
                        syncMenuSelection(cardName);
                        
                        // Destaca o card visualmente e centraliza no carrossel
                        centerCardInCarousel(newCard);
                        newCard.classList.add('card-highlighted');
                        setTimeout(() => {
                            newCard.classList.remove('card-highlighted');
                        }, 1000);
                        
                        console.log('‚å®Ô∏è Navega√ß√£o por teclado:', cardName);
                    }
                }
            });
        }

        // Fun√ß√£o para configurar sincroniza√ß√£o bidirecional
        function setupBidirectionalSync() {
            console.log('üîÑ Configurando sincroniza√ß√£o bidirecional...');
            
            // Observer para detectar quando novos cards s√£o adicionados
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.type === 'childList') {
                        mutation.addedNodes.forEach((node) => {
                            if (node.nodeType === 1) { // Element node
                                // Procura por cards rec√©m-adicionados
                                const newCards = node.querySelectorAll ? 
                                    node.querySelectorAll('.course-card, .card, .resource-card') :
                                    (node.classList && (node.classList.contains('course-card') || 
                                                    node.classList.contains('card') || 
                                                    node.classList.contains('resource-card')) ? [node] : []);
                                
                                newCards.forEach(card => {
                                    addCardSyncListener(card);
                                });
                            }
                        });
                    }
                });
            });
            
            // Observa mudan√ßas no container principal
            const mainContent = document.querySelector('.main-content, .content-area, .cards-container');
            if (mainContent) {
                observer.observe(mainContent, { childList: true, subtree: true });
            }
            
            // Adiciona listeners aos cards existentes
            document.querySelectorAll('.course-card, .card, .resource-card').forEach(card => {
                addCardSyncListener(card);
            });
            
            console.log('‚úÖ Sincroniza√ß√£o bidirecional configurada');
        }

        // Fun√ß√£o para adicionar listener de sincroniza√ß√£o a um card
        function addCardSyncListener(card) {
            // Evita duplicar listeners
            if (card._syncListenerAdded) return;
            card._syncListenerAdded = true;
            
            // Listener para cliques no card
            card.addEventListener('click', () => {
                const cardTitle = card.querySelector('h3, .card-title, .course-title');
                if (cardTitle) {
                    const cardName = cardTitle.textContent.trim();
                    console.log('üéØ Card clicado na √°rea principal:', cardName);
                    
                    // Sincroniza com o menu
                    syncMenuSelection(cardName);
                }
            });
            
            // Listener para hover no card
            card.addEventListener('mouseenter', () => {
                const cardTitle = card.querySelector('h3, .card-title, .course-title');
                if (cardTitle) {
                    const cardName = cardTitle.textContent.trim();
                    
                    // Destaca o item correspondente no menu
                    const menuItem = document.querySelector(`.card-menu-item[data-card-name="${cardName}"]`);
                    if (menuItem) {
                        menuItem.classList.add('menu-hover-highlight');
                    }
                }
            });
            
            card.addEventListener('mouseleave', () => {
                // Remove destaque do menu
                document.querySelectorAll('.card-menu-item').forEach(item => {
                    item.classList.remove('menu-hover-highlight');
                });
            });
        }

        // Fun√ß√£o para centralizar card no carrossel
        function centerCardInCarousel(targetCard) {
            console.log('üéØ Centralizando card no carrossel...', targetCard);
            
            // Primeiro, tenta encontrar o container do carrossel
            let carouselTrack = targetCard.closest('.carousel-track');
            
            // Se n√£o encontrou, procura por containers de scroll horizontal
            if (!carouselTrack) {
                carouselTrack = targetCard.closest('.cards-container, .content-area, main');
                console.log('üîç Usando container alternativo:', carouselTrack);
            }
            
            if (!carouselTrack) {
                console.log('‚ö†Ô∏è Container de scroll n√£o encontrado, usando scroll padr√£o');
                targetCard.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center',
                    inline: 'center'
                });
                return;
            }
            
            // Aguarda um pouco para garantir que o DOM est√° atualizado
            setTimeout(() => {
                // Recalcula posi√ß√µes ap√≥s o delay
                const cardRect = targetCard.getBoundingClientRect();
                const containerRect = carouselTrack.getBoundingClientRect();
                
                // Posi√ß√£o atual do scroll
                const currentScrollLeft = carouselTrack.scrollLeft;
                
                // Posi√ß√£o do card em rela√ß√£o ao container
                const cardOffsetLeft = targetCard.offsetLeft;
                
                // Largura do container vis√≠vel
                const containerWidth = carouselTrack.clientWidth;
                
                // Largura do card
                const cardWidth = targetCard.offsetWidth;
                
                // Calcula a posi√ß√£o para centralizar o card
                const targetScrollLeft = cardOffsetLeft - (containerWidth / 2) + (cardWidth / 2);
                
                console.log('üìä Dados detalhados do carrossel:', {
                    cardName: targetCard.querySelector('h3, .card-title, .course-title')?.textContent?.trim(),
                    cardOffsetLeft,
                    containerWidth,
                    cardWidth,
                    currentScrollLeft,
                    targetScrollLeft,
                    cardRect,
                    containerRect
                });
                
                // M√©todo 1: scrollTo com comportamento suave
                if (carouselTrack.scrollTo) {
                    carouselTrack.scrollTo({
                        left: Math.max(0, targetScrollLeft),
                        behavior: 'smooth'
                    });
                    console.log('‚úÖ Usando scrollTo para centralizar');
                } else {
                    // M√©todo 2: scrollLeft com anima√ß√£o manual
                    const startScrollLeft = carouselTrack.scrollLeft;
                    const distance = Math.max(0, targetScrollLeft) - startScrollLeft;
                    const duration = 500;
                    const startTime = Date.now();
                    
                    function animateScroll() {
                        const elapsed = Date.now() - startTime;
                        const progress = Math.min(elapsed / duration, 1);
                        
                        // Easing function (ease-out)
                        const easeOut = 1 - Math.pow(1 - progress, 3);
                        
                        carouselTrack.scrollLeft = startScrollLeft + (distance * easeOut);
                        
                        if (progress < 1) {
                            requestAnimationFrame(animateScroll);
                        }
                    }
                    
                    animateScroll();
                    console.log('‚úÖ Usando anima√ß√£o manual para centralizar');
                }
                
                // Tamb√©m faz scroll vertical se necess√°rio
                targetCard.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center',
                    inline: 'nearest'
                });
                
                console.log('‚úÖ Card centralizado no carrossel');
                
            }, 100); // Pequeno delay para garantir que o DOM est√° atualizado
        }

        // Fun√ß√£o para carregar a categoria do card
        function loadCardCategory(cardName) {
            console.log('üîÑ Tentando carregar categoria para:', cardName);
            
            // MAPEAMENTO PRECISO E DIRETO - Cada card tem seu caminho exato no menu
            const cardNavigationMap = {
                // EXCLUSIVO ‚Üí Ferramentas & Neg√≥cios ‚Üí FNW Assessoria
                'FNW - Formul√°rio Estrat√©gico': {
                    category: 'EXCLUSIVO',
                    subcategory: 'Ferramentas & Neg√≥cios', 
                    subsubcategory: 'FNW Assessoria',
                    dataSource: 'paiCategoriesData',
                    dataKey: 'FNW Assessoria'
                },
                'FNW - ROI Maker': {
                    category: 'EXCLUSIVO',
                    subcategory: 'Ferramentas & Neg√≥cios',
                    subsubcategory: 'FNW Assessoria',
                    dataSource: 'paiCategoriesData',
                    dataKey: 'FNW Assessoria'
                },
                'Painel ETO': {
                    category: 'EXCLUSIVO',
                    subcategory: 'Ferramentas & Neg√≥cios',
                    subsubcategory: 'FNW Assessoria',
                    dataSource: 'paiCategoriesData',
                    dataKey: 'FNW Assessoria'
                },
                'MKT HUB': {
                    category: 'EXCLUSIVO',
                    subcategory: 'Ferramentas & Neg√≥cios',
                    subsubcategory: 'FNW Assessoria',
                    dataSource: 'paiCategoriesData',
                    dataKey: 'FNW Assessoria'
                },
                
                // EXCLUSIVO ‚Üí Ferramentas & Neg√≥cios ‚Üí 50+ | Maduros e Idosos
                'Longevidade': {
                    category: 'EXCLUSIVO',
                    subcategory: 'Ferramentas & Neg√≥cios',
                    subsubcategory: '50+ | Maduros e Idosos',
                    dataSource: 'paiCategoriesData',
                    dataKey: '50+ | Maduros e Idosos'
                },
                'Analise CNIS': {
                    category: 'EXCLUSIVO',
                    subcategory: 'Ferramentas & Neg√≥cios',
                    subsubcategory: '50+ | Maduros e Idosos',
                    dataSource: 'paiCategoriesData',
                    dataKey: '50+ | Maduros e Idosos'
                },
                'CNIS Suporte': {
                    category: 'EXCLUSIVO',
                    subcategory: 'Ferramentas & Neg√≥cios',
                    subsubcategory: '50+ | Maduros e Idosos',
                    dataSource: 'paiCategoriesData',
                    dataKey: '50+ | Maduros e Idosos'
                },
                
                // EXCLUSIVO ‚Üí Suporte - IA ‚Üí Wizzards
                'IA Prompt Wizzard': {
                    category: 'EXCLUSIVO',
                    subcategory: 'Suporte - IA',
                    subsubcategory: 'Wizzards',
                    dataSource: 'suporteIaCategoriesData',
                    dataKey: 'Wizzards'
                },
                
                // EXCLUSIVO ‚Üí Suporte - IA ‚Üí Assistentes
                'Chat Rosio Livia Geriah': {
                    category: 'EXCLUSIVO',
                    subcategory: 'Suporte - IA',
                    subsubcategory: 'Assistentes',
                    dataSource: 'suporteIaCategoriesData',
                    dataKey: 'Assistentes'
                },
                'HumanIA': {
                    category: 'EXCLUSIVO',
                    subcategory: 'Suporte - IA',
                    subsubcategory: 'Assistentes',
                    dataSource: 'suporteIaCategoriesData',
                    dataKey: 'Assistentes'
                },
                'London Lord': {
                    category: 'EXCLUSIVO',
                    subcategory: 'Suporte - IA',
                    subsubcategory: 'Assistentes',
                    dataSource: 'suporteIaCategoriesData',
                    dataKey: 'Assistentes'
                },
                
                // PARTICIPE ‚Üí Parcerias ‚Üí Empresas Parceiras
                'FNW Sinergias': {
                    category: 'PARTICIPE',
                    subcategory: 'Parcerias',
                    subsubcategory: 'Empresas Parceiras',
                    dataSource: 'participeCategoriesData',
                    dataKey: 'Parcerias'
                },
                'IDEIA21': {
                    category: 'PARTICIPE',
                    subcategory: 'Parcerias',
                    subsubcategory: 'Empresas Parceiras',
                    dataSource: 'participeCategoriesData',
                    dataKey: 'Parcerias'
                },
                'IPSOLON': {
                    category: 'PARTICIPE',
                    subcategory: 'Parcerias',
                    subsubcategory: 'Empresas Parceiras',
                    dataSource: 'participeCategoriesData',
                    dataKey: 'Parcerias'
                },
                
                // PARTICIPE ‚Üí Parcerias ‚Üí Feito Por Voc√™
                'Feito Por Voc√™': {
                    category: 'PARTICIPE',
                    subcategory: 'Parcerias',
                    subsubcategory: 'Feito Por Voc√™',
                    dataSource: 'participeCategoriesData',
                    dataKey: 'Feito Por Voc√™'
                }
            };
            
            const cardInfo = cardNavigationMap[cardName];
            if (cardInfo) {
                console.log(`üéØ NAVEGA√á√ÉO PRECISA: ${cardName}`);
                console.log(`üìç Caminho: ${cardInfo.category} ‚Üí ${cardInfo.subcategory} ‚Üí ${cardInfo.subsubcategory}`);
                console.log(`üóÇÔ∏è Fonte de dados: ${cardInfo.dataSource} ‚Üí ${cardInfo.dataKey}`);
                
                // PASSO 1: Abrir categoria principal (EXCLUSIVO/PARTICIPE)
                const categoryButton = Array.from(document.querySelectorAll('.accordion-header')).find(header => 
                    header.textContent.includes(cardInfo.category)
                );
                
                if (categoryButton) {
                    const categoryContent = categoryButton.parentElement.querySelector('.accordion-content');
                    if (categoryContent && categoryContent.style.display === 'none') {
                        console.log('üîì PASSO 1: Abrindo categoria principal:', cardInfo.category);
                        categoryButton.click();
                    }
                    
                    // PASSO 2: Abrir subcategoria (Ferramentas & Neg√≥cios / Suporte - IA / Parcerias)
                    setTimeout(() => {
                        const subcategoryButton = Array.from(document.querySelectorAll('.sub-accordion-header')).find(header => 
                            header.textContent.includes(cardInfo.subcategory)
                        );
                        
                        if (subcategoryButton) {
                            const subcategoryContent = subcategoryButton.parentElement.querySelector('.sub-accordion-content');
                            if (subcategoryContent && subcategoryContent.style.display === 'none') {
                                console.log('üîì PASSO 2: Abrindo subcategoria:', cardInfo.subcategory);
                                subcategoryButton.click();
                            }
                            
                            // PASSO 3: Abrir sub-subcategoria (FNW Assessoria / 50+ / Wizzards / etc)
                            setTimeout(() => {
                                const subsubcategoryButton = Array.from(document.querySelectorAll('.sub-sub-accordion-header')).find(header => 
                                    header.textContent.includes(cardInfo.subsubcategory)
                                );
                                
                                if (subsubcategoryButton) {
                                    const subsubcategoryContent = subsubcategoryButton.parentElement.querySelector('.sub-sub-accordion-content');
                                    if (subsubcategoryContent && subsubcategoryContent.style.display === 'none') {
                                        console.log('üîì PASSO 3: Abrindo sub-subcategoria:', cardInfo.subsubcategory);
                                        subsubcategoryButton.click();
                                    }
                                }
                                
                                // PASSO 4: Carregar dados e renderizar cards
                                setTimeout(() => {
                                    let dataSource = null;
                                    
                                    // Buscar dados da fonte correta
                                    if (cardInfo.dataSource === 'paiCategoriesData') {
                                        dataSource = paiCategoriesData.find(cat => cat.name === cardInfo.dataKey);
                                    } else if (cardInfo.dataSource === 'suporteIaCategoriesData') {
                                        dataSource = suporteIaCategoriesData.find(cat => cat.name === cardInfo.dataKey);
                                    } else if (cardInfo.dataSource === 'participeCategoriesData') {
                                        dataSource = participeCategoriesData.find(cat => cat.name === cardInfo.dataKey);
                                    }
                                    
                                    if (dataSource) {
                                        console.log('‚úÖ PASSO 4: Carregando dados de:', cardInfo.dataSource, '‚Üí', cardInfo.dataKey);
                                        displayPaiCategoryItems(dataSource, cardInfo.category);
                                        
                                        // PASSO 5: Destacar card espec√≠fico
                                        setTimeout(() => {
                                            const realCard = Array.from(document.querySelectorAll('.course-card')).find(card => {
                                                const cardTitle = card.querySelector('h3');
                                                return cardTitle && cardTitle.textContent.trim() === cardName;
                                            });
                                            
                                            if (realCard) {
                                                console.log('üéØ SUCESSO: Card encontrado e destacado:', cardName);
                                                realCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                                realCard.classList.add('card-highlighted');
                                                setTimeout(() => {
                                                    realCard.classList.remove('card-highlighted');
                                                }, 2000);
                                            } else {
                                                console.log('‚ùå ERRO: Card n√£o encontrado ap√≥s navega√ß√£o completa:', cardName);
                                            }
                                        }, 400);
                                    } else {
                                        console.log('‚ùå ERRO: Fonte de dados n√£o encontrada:', cardInfo.dataSource, cardInfo.dataKey);
                                    }
                                }, 200);
                            }, 200);
                        } else {
                            console.log('‚ùå ERRO: Subcategoria n√£o encontrada no DOM:', cardInfo.subcategory);
                        }
                    }, 200);
                } else {
                    console.log('‚ùå ERRO: Categoria principal n√£o encontrada no DOM:', cardInfo.category);
                }
            } else {
                console.log('‚ùå Mapeamento n√£o encontrado para card:', cardName);
                // Mostra mensagem de busca
                document.getElementById('coursesContainer').innerHTML = `
                    <p class="instruction-message">
                        üîç Procurando por "${cardName}"...<br>
                        <small>Este card pode estar em outra categoria ou ainda n√£o foi carregado.</small>
                    </p>
                `;
            }
        }

        function renderPaiCategoriesSidebar() {
            const paiListUl = document.getElementById('paiItemsList');
            paiListUl.innerHTML = ''; // Limpa itens anteriores, como "Nenhum item P.A.I configurado."

            if (!paiCategoriesData || paiCategoriesData.length === 0) {
                const li = document.createElement('li');
                li.textContent = 'Nenhuma categoria P.A.I. configurada.';
                paiListUl.appendChild(li);
                return;
            }

            paiCategoriesData.forEach(paiCategory => {
                const li = document.createElement('li');
                const btn = document.createElement('button');
                btn.textContent = paiCategory.name;
                // Adiciona a classe 'active' ao primeiro bot√£o por padr√£o ou com base em estado salvo
                // if (index === 0) btn.classList.add('active'); 

                btn.addEventListener('click', () => {
                    // Remove 'active' de todos os bot√µes P.A.I.
                    paiListUl.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                    // Adiciona 'active' ao bot√£o clicado
                    btn.classList.add('active');
                    // Exibe os itens da categoria P.A.I. selecionada
                    displayPaiCategoryItems(paiCategory, "EXCLUSIVO"); // Passa o nome da categoria pai
                    closeSidebar(); // Fechar sidebar ap√≥s selecionar categoria P.A.I.
                });

                li.appendChild(btn);
                paiListUl.appendChild(li);
            });
        }

        function renderParticipeCategoriesSidebar() {
            const participeListUl = document.getElementById('participeItemsList');
            participeListUl.innerHTML = '';

            if (!participeCategoriesData || participeCategoriesData.length === 0) {
                const li = document.createElement('li');
                li.textContent = 'Nenhuma categoria de Participa√ß√£o configurada.';
                participeListUl.appendChild(li);
                return;
            }

            participeCategoriesData.forEach(participeCategory => {
                const li = document.createElement('li');
                const btn = document.createElement('button');
                btn.textContent = participeCategory.name;

                btn.addEventListener('click', () => {
                    participeListUl.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    displayPaiCategoryItems(participeCategory, "Participe"); // Passa o nome da categoria pai
                    closeSidebar();
                });

                li.appendChild(btn);
                participeListUl.appendChild(li);
            });
        }

        function renderMeusAppsCategoriesSidebar() {
            console.log('renderMeusAppsCategoriesSidebar chamada, isEditMode:', isEditMode); // Debug
            // Agora os sub-acorde√µes s√£o renderizados diretamente no HTML
            // Esta fun√ß√£o renderiza os conte√∫dos de cada sub-acorde√£o

            // Renderizar Sa√∫de
            const saudeUl = document.getElementById('saudeItemsList');
            const saudeData = meusAppsCategoriesData.find(cat => cat.name === "Sa√∫de");
            renderSubCategoryItems(saudeUl, saudeData);

            // Renderizar Comunicar
            const comunicacaoUl = document.getElementById('comunicacaoItemsList');
            const comunicacaoData = meusAppsCategoriesData.find(cat => cat.name === "Comunicar");
            renderSubCategoryItems(comunicacaoUl, comunicacaoData);

            // Renderizar Banco
            const bancoUl = document.getElementById('bancoItemsList');
            const bancoData = meusAppsCategoriesData.find(cat => cat.name === "Banco");
            renderSubCategoryItems(bancoUl, bancoData);

            // Renderizar Alimenta√ß√£o
            const alimentacaoUl = document.getElementById('alimentacaoItemsList');
            const alimentacaoData = meusAppsCategoriesData.find(cat => cat.name === "Alimenta√ß√£o");
            renderSubCategoryItems(alimentacaoUl, alimentacaoData);

            // Renderizar Transporte
            const transporteUl = document.getElementById('transporteItemsList');
            const transporteData = meusAppsCategoriesData.find(cat => cat.name === "Transporte");
            renderSubCategoryItems(transporteUl, transporteData);

            // Renderizar Utilidades
            const utilidadesUl = document.getElementById('utilidadesItemsList');
            const utilidadesData = meusAppsCategoriesData.find(cat => cat.name === "Utilidades");
            renderSubCategoryItems(utilidadesUl, utilidadesData);

            // Renderizar Lazer
            const lazerUl = document.getElementById('lazerItemsList');
            const lazerData = meusAppsCategoriesData.find(cat => cat.name === "Lazer");
            renderSubCategoryItems(lazerUl, lazerData);
        }

        function renderSubCategoryItems(ul, categoryData) {
            if (!categoryData || !categoryData.items || categoryData.items.length === 0) {
                ul.innerHTML = '<li>Nenhum item dispon√≠vel.</li>';
                return;
            }

            ul.innerHTML = '';
            
            // Lista dos apps testados e funcionando
            const testedApps = ['Bradesco', 'Banco do Brasil', 'Caixa', 'Nubank', 'Santander', 'WhatsApp', 'Telegram', 'PlutoTV', 'YouTube', 'Google Meet', 'WhatsApp Business', 'iFood', 'P√£o de A√ß√∫car', 'Uber', '99'];
            
            // Lista dos apps implementados (mas podem n√£o estar testados)
            const implementedApps = ['Bradesco', 'Banco do Brasil', 'Caixa', 'Nubank', 'Santander', 'Ita√∫', 'WhatsApp', 'Telegram', 'PlutoTV', 'YouTube', 'Google Meet', 'WhatsApp Business', 'iFood', 'P√£o de A√ß√∫car', 'Uber', '99'];
            
            categoryData.items.forEach(item => {
                const li = document.createElement('li');
                const btn = document.createElement('button');
                
                // Verifica se h√° dados personalizados para este item
                const itemKey = generateItemKey(item);
                const customData = customItemData[itemKey];
                let displayName = customData ? customData.name : item.name;
                const targetUrl = customData ? customData.url : item.url;
                
                // Adiciona √≠cone baseado no status real
                const isReserved = item.disabled || item.name === "Reservado";
                const isTested = testedApps.includes(item.name);
                const isImplemented = implementedApps.includes(item.name);
                let statusIcon = '';
                
                if (!isReserved && isTested) {
                    statusIcon = '<span class="app-check">‚úì</span> ';
                } else if (!isReserved && isImplemented && !isTested) {
                    statusIcon = '<span class="app-pending">‚óè</span> ';
                }
                // Apps n√£o implementados ficam sem √≠cone
                
                // Se o item tem subitens, adiciona um indicador visual
                if (item.hasSubItems) {
                    // Conta quantos subitens n√£o s√£o "Reservado" ou disabled
                    const activeSubItems = item.subItems ? item.subItems.filter(subItem => 
                        !subItem.disabled && subItem.name !== "Reservado"
                    ).length : 0;
                    
                    statusIcon += `<span style="color: #4CAF50; margin-right: 4px;">üìã</span> `;
                    // O contador ser√° adicionado depois do nome APENAS no modo edi√ß√£o
                    console.log(`Verificando contador para ${item.name}:`, { 
                        isEditMode: isEditMode, 
                        activeSubItems: activeSubItems,
                        shouldShowCounter: isEditMode 
                    }); // Debug detalhado
                    
                    if (isEditMode) {
                        console.log(`‚úÖ Adicionando contador ${activeSubItems} para ${item.name} (modo edi√ß√£o ativo)`); // Debug
                        displayName += ` <span style="color: #4CAF50; font-size: 0.8em; font-weight: bold;">${activeSubItems}</span>`;
                    } else {
                        console.log(`‚ùå N√ÉO adicionando contador para ${item.name} (modo edi√ß√£o inativo)`); // Debug
                    }
                }
                
                btn.innerHTML = statusIcon + displayName;

                // Tratamento especial para itens reservados
                if (isReserved) {
                    if (isEditMode) {
                        // No modo de edi√ß√£o, itens reservados ficam edit√°veis
                        btn.style.opacity = '0.7';
                        btn.style.cursor = 'pointer';
                        btn.style.color = '#cccccc';
                        btn.disabled = false;
                        btn.title = 'Clique para personalizar este espa√ßo reservado';
                        
                        btn.addEventListener('click', (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            console.log('Editando item reservado:', item.name);
                            openSimpleItemEditModal(categoryData.name, item.name);
                        });
                        
                        // Adiciona bot√£o de edi√ß√£o para itens reservados
                        li.style.position = 'relative';
                        
                        const editBtn = document.createElement('button');
                        editBtn.className = 'edit-simple-item-btn';
                        editBtn.innerHTML = '‚úèÔ∏è';
                        editBtn.style.cssText = `
                            position: absolute;
                            right: 8px;
                            top: 50%;
                            transform: translateY(-50%);
                            background: rgba(101, 31, 57, 0.9);
                            border: none;
                            border-radius: 50%;
                            width: 22px;
                            height: 22px;
                            cursor: pointer;
                            font-size: 11px;
                            z-index: 10;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
                        `;
                        
                        editBtn.addEventListener('click', (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            console.log('Editando item reservado via bot√£o:', item.name);
                            openSimpleItemEditModal(categoryData.name, item.name);
                        });
                        
                        li.appendChild(editBtn);
                    } else {
                        // No modo normal, itens reservados ficam desabilitados
                        btn.style.opacity = '0.4';
                        btn.style.cursor = 'not-allowed';
                        btn.style.color = '#666666';
                        btn.disabled = true;
                        btn.title = 'Espa√ßo reservado para futuras funcionalidades';
                    }
                } else if (!isImplemented && !item.hasSubItems) {
                    // Apps n√£o implementados ainda (mas permite subitens mesmo sem implementa√ß√£o)
                    btn.style.opacity = '0.5';
                    btn.style.color = '#999999';
                    btn.style.cursor = 'not-allowed';
                    btn.disabled = true;
                    btn.title = 'App ainda n√£o implementado';
                } else if (isImplemented && !isTested && !item.hasSubItems) {
                    // Apps implementados mas n√£o testados ainda (apenas Ita√∫)
                    btn.style.opacity = '0.7';
                    btn.style.color = '#cccccc';
                    btn.title = 'App implementado mas ainda n√£o testado';
                } else {
                    // Apps testados e funcionais OU itens com subitens
                    // Adiciona classe se foi personalizado
                    if (customData) {
                        btn.classList.add('customized-item');
                    }
                    
                    btn.addEventListener('click', (e) => {
                        console.log('Bot√£o clicado:', { 
                            itemName: item.name, 
                            isEditMode: isEditMode,
                            hasSubItems: item.hasSubItems,
                            hasEditableClass: btn.classList.contains('editable-item')
                        }); // Debug
                        
                        // Se estiver no modo de edi√ß√£o, abre o modal de edi√ß√£o
                        if (isEditMode) {
                            e.preventDefault();
                            e.stopPropagation();
                            console.log('Abrindo modal de edi√ß√£o para:', item.name); // Debug
                            openItemEditModal(item, btn);
                            return;
                        }
                        
                        console.log('Abrindo item normalmente:', item.name); // Debug
                        
                        
                        // Comportamento normal - abre o item
                        ul.querySelectorAll('button:not([disabled])').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        
                        // Se o item tem subitens, exibe os cards
                        if (item.hasSubItems && item.subItems) {
                            displaySubItemsAsCards(item, categoryData.name);
                        } else {
                            // Usa a URL personalizada se existir
                            const itemToOpen = {
                                ...item,
                                name: displayName,
                                url: targetUrl
                            };
                            
                            openPaiItemInModal(itemToOpen);
                        }
                        closeSidebar();
                    });
                    
                    // Adiciona bot√£o de edi√ß√£o para itens simples no modo de edi√ß√£o
                    if (isEditMode && !item.hasSubItems) {
                        li.style.position = 'relative';
                        
                        const editBtn = document.createElement('button');
                        editBtn.className = 'edit-simple-item-btn';
                        editBtn.innerHTML = '‚úèÔ∏è';
                        editBtn.style.cssText = `
                            position: absolute;
                            right: 8px;
                            top: 50%;
                            transform: translateY(-50%);
                            background: rgba(101, 31, 57, 0.9);
                            border: none;
                            border-radius: 50%;
                            width: 22px;
                            height: 22px;
                            cursor: pointer;
                            font-size: 11px;
                            z-index: 10;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
                        `;
                        
                        editBtn.addEventListener('click', (e) => {
                            e.preventDefault();
                            e.stopPropagation();
                            console.log('Editando item simples:', item.name);
                            openSimpleItemEditModal(categoryData.name, item.name);
                        });
                        
                        li.appendChild(editBtn);
                    }
                }

                li.appendChild(btn);
                ul.appendChild(li);
            });
        }

        // Nova fun√ß√£o para exibir subitens como cards no carrossel
        function displaySubItemsAsCards(parentItem, categoryName) {
            console.log('=== DEBUG: displaySubItemsAsCards chamada ===');
            console.log('parentItem:', parentItem);
            console.log('categoryName:', categoryName);
            
            const container = document.getElementById('coursesContainer');
            if (!container) {
                console.error('ERRO: coursesContainer n√£o encontrado!');
                return;
            }
            
            console.log('Container encontrado, limpando conte√∫do...');
            container.innerHTML = '';

            // Cria o t√≠tulo da subcategoria
            const categoryHeader = document.createElement('h2');
            categoryHeader.className = 'category-title-header';
            categoryHeader.textContent = `${categoryName} - ${parentItem.name}`;
            container.appendChild(categoryHeader);
            console.log('T√≠tulo adicionado:', categoryHeader.textContent);

            if (!parentItem.subItems || parentItem.subItems.length === 0) {
                console.log('Nenhum subitem encontrado, exibindo mensagem...');
                const noItemsMessage = document.createElement('p');
                noItemsMessage.textContent = `Nenhum recurso encontrado em ${parentItem.name}.`;
                noItemsMessage.style.color = '#ccc';
                noItemsMessage.style.marginTop = '20px';
                container.appendChild(noItemsMessage);
                return;
            }

            console.log(`Criando ${parentItem.subItems.length} cards...`);
            
            // Cria o trilho do carrossel
            const carouselTrack = document.createElement('div');
            carouselTrack.className = 'carousel-track';

            parentItem.subItems.forEach((subItem, index) => {
                console.log(`Criando card ${index + 1}:`, subItem.name);
                
                const card = document.createElement('div');
                card.className = 'course-card';
                
                // Verifica se h√° dados personalizados para este card
                const cardKey = generateCardKey(categoryName, parentItem.name, index);
                const customData = customCardData[cardKey];
                
                // Usa dados personalizados se dispon√≠veis, sen√£o usa os originais
                const displayName = customData ? customData.name : subItem.name;
                const displayDescription = customData ? customData.description : (subItem.description || 'Clique para acessar');
                const displayUrl = customData ? customData.url : subItem.url;
                
                // Verifica se √© um card edit√°vel
                if (subItem.isCard) {
                    // Card edit√°vel com imagem personalizada
                    const cardImage = customData ? customData.cardImage : (subItem.cardImage || subItem.image || 'https://via.placeholder.com/308x196.png?text=AudioLivro');
                    
                    console.log(`Renderizando card edit√°vel: ${displayName}`, {
                        isEditMode: isEditMode,
                        shouldShowButton: isEditMode,
                        parentItemName: parentItem.name,
                        cardIndex: index
                    });
                    
                    card.innerHTML = `
                        <div class="card-image-container" style="position: relative;">
                            <img src="${cardImage}" alt="${displayName}" style="width:100%; height:196px; object-fit:cover; border-bottom: 1px solid rgba(80, 48, 96, 0.9);">
                            ${isEditMode ? `<button class="edit-card-btn" onclick="openCardEditModal('${parentItem.name}', ${index})" style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; border: none; border-radius: 50%; width: 30px; height: 30px; cursor: pointer; font-size: 14px;">‚úèÔ∏è</button>` : ''}
                        </div>
                        <div class="info" style="padding:15px;">
                            <h3 style="margin:0 0 10px; font-size:1.05em; color:#fff; height: 56px; overflow: hidden;">${displayName}</h3>
                            <p style="font-size:0.85em; color:#ccc; margin:0; line-height: 1.3; height: 70px; overflow: hidden;">${displayDescription}</p>
                        </div>
                    `;
                } else {
                    // Card padr√£o
                    card.innerHTML = `
                        <img src="${subItem.image || 'https://via.placeholder.com/308x196.png?text=Recurso'}" alt="${subItem.name}" style="width:100%; height:196px; object-fit:cover; border-bottom: 1px solid rgba(80, 48, 96, 0.9);">
                        <div class="info" style="padding:15px;">
                            <h3 style="margin:0 0 10px; font-size:1.05em; color:#fff; height: 56px; overflow: hidden;">${subItem.name}</h3>
                            <p style="font-size:0.85em; color:#ccc; margin:0; line-height: 1.3; height: 70px; overflow: hidden;">${subItem.description || 'Clique para acessar'}</p>
                        </div>
                    `;
                }

                card.addEventListener('click', (e) => {
                    // N√£o abrir se clicou no bot√£o de editar
                    if (e.target.classList.contains('edit-card-btn')) {
                        return;
                    }
                    
                    // Cria objeto com dados personalizados se dispon√≠veis
                    const itemToOpen = {
                        name: displayName,
                        url: displayUrl,
                        description: displayDescription
                    };
                    
                    // Detecta se √© URL da Play Store para mostrar modal espec√≠fico
                    if (displayUrl.includes('play.google.com/store/apps')) {
                        showAppModal(itemToOpen);
                    } else {
                        // Para URLs web, abre em modal iframe
                        openPaiItemInModal(itemToOpen);
                    }
                });

                carouselTrack.appendChild(card);
                console.log(`Card ${index + 1} adicionado ao carrossel`);
            });

            container.appendChild(carouselTrack);
            console.log('Carrossel adicionado ao container');
            console.log('Container final HTML:', container.innerHTML.substring(0, 200) + '...');

            // Adiciona funcionalidade de carrossel
            const debouncedUpdateFocus = debounce(() => updateCarouselFocus(carouselTrack), 50);
            let scrollEndTimer = null;
            carouselTrack.addEventListener('scroll', () => {
                debouncedUpdateFocus();
                clearTimeout(scrollEndTimer);
                scrollEndTimer = setTimeout(() => {
                    snapToNearestCard(carouselTrack);
                }, 150);
            });

            setTimeout(() => {
                updateCarouselFocus(carouselTrack);
                console.log('Focus do carrossel atualizado');
            }, 0);
            
            console.log('=== FIM DEBUG: displaySubItemsAsCards ===');
        }

        function renderVideosCategoriesSidebar() {
            const videosListUl = document.getElementById('videosItemsList');
            videosListUl.innerHTML = '';

            if (!videosCategoriesData || videosCategoriesData.length === 0) {
                const li = document.createElement('li');
                li.textContent = 'Nenhuma categoria de V√≠deos configurada.';
                videosListUl.appendChild(li);
                return;
            }

            videosCategoriesData.forEach(videoCategory => {
                const li = document.createElement('li');
                const btn = document.createElement('button');
                btn.textContent = videoCategory.name;

                btn.addEventListener('click', () => {
                    videosListUl.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    displayPaiCategoryItems(videoCategory, "Videos"); // Passa o nome da categoria pai
                    closeSidebar();
                });

                li.appendChild(btn);
                videosListUl.appendChild(li);
            });
        }

        // Nova estrutura para categoria "Meus Apps"
        const meusAppsCategoriesData = [
            {
                name: "Sa√∫de",
                items: [
                    { 
                        name: "Preven√ß√£o", 
                        hasSubItems: true,
                        subItems: [
                            { 
                                name: "Drogasil", 
                                url: "https://play.google.com/store/apps/details?id=br.com.drogasil", 
                                image: "https://api.iconify.design/tabler/pill.svg?color=%23e5e5e5", 
                                description: "Drogaria Online 24h - App oficial",
                                isCard: true,
                                cardImage: "https://logoeps.com/wp-content/uploads/2013/03/drogasil-vector-logo.png"
                            },
                            { 
                                name: "SUS Digital", 
                                url: "https://play.google.com/store/apps/details?id=br.gov.datasus.cnsdigital", 
                                image: "https://api.iconify.design/tabler/id-badge.svg?color=%23e5e5e5", 
                                description: "Cart√£o Nacional de Sa√∫de Digital",
                                isCard: true,
                                cardImage: "https://www.gov.br/saude/pt-br/assuntos/saude-digital/cartao-nacional-de-saude/sus-digital.png"
                            },
                            { 
                                name: "Conecte SUS", 
                                url: "https://play.google.com/store/apps/details?id=br.gov.datasus.conectesus", 
                                image: "https://api.iconify.design/tabler/heart-handshake.svg?color=%23e5e5e5", 
                                description: "Aplicativo oficial do SUS",
                                isCard: true,
                                cardImage: "https://conectesus.saude.gov.br/static/media/logo-conecte-sus.png"
                            },
                            { 
                                name: "Naturais", 
                                url: "#", 
                                image: "https://api.iconify.design/tabler/leaf.svg?color=%23e5e5e5", 
                                description: "Produtos naturais e fitoter√°picos",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?w=400&h=250&fit=crop"
                            }
                        ]
                    },
                    { name: "Nutri√ß√£o", url: "https://www.dietbox.me/", image: "https://api.iconify.design/tabler/apple.svg?color=%23e5e5e5" },
                    { name: "Atividades", url: "https://www.smartfit.com.br/", image: "https://api.iconify.design/tabler/barbell.svg?color=%23e5e5e5" },
                    { name: "Conv√™nio", url: "https://www.unimed.coop.br/", image: "https://api.iconify.design/tabler/shield-heart.svg?color=%23e5e5e5" },
                    { name: "M√©dico", url: "https://www.doctoralia.com.br/", image: "https://api.iconify.design/tabler/stethoscope.svg?color=%23e5e5e5" },
                    { name: "Farm√°cia", url: "https://www.drogasil.com.br/", image: "https://api.iconify.design/tabler/pill.svg?color=%23e5e5e5" },
                    { name: "Hospital", url: "https://www.hospitalsiriolibanes.org.br/", image: "https://api.iconify.design/tabler/building-hospital.svg?color=%23e5e5e5" }
                ]
            },
            {
                name: "Comunicar",
                items: [
                    { name: "WhatsApp", url: "https://play.google.com/store/apps/details?id=com.whatsapp", image: "https://api.iconify.design/logos/whatsapp-icon.svg?color=%23e5e5e5" },
                    { name: "Telegram", url: "https://play.google.com/store/apps/details?id=org.telegram.messenger", image: "https://api.iconify.design/logos/telegram.svg?color=%23e5e5e5" },
                    { name: "Email Gmail", url: "https://mail.google.com/", image: "https://api.iconify.design/logos/google-gmail.svg?color=%23e5e5e5" },
                    { name: "Google Meet", url: "https://meet.google.com/", image: "https://api.iconify.design/logos/google-meet.svg?color=%23e5e5e5" },
                    { name: "Zoom", url: "https://zoom.us/", image: "https://api.iconify.design/logos/zoom-icon.svg?color=%23e5e5e5" },
                    { name: "WhatsApp Business", url: "https://play.google.com/store/apps/details?id=com.whatsapp.w4b", image: "https://api.iconify.design/logos/whatsapp-icon.svg?color=%23e5e5e5" },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true }
                ]
            },
            {
                name: "Banco",
                items: [
                    { name: "Banco do Brasil", url: "https://play.google.com/store/apps/details?id=br.com.bb.android", image: "https://api.iconify.design/tabler/building-bank.svg?color=%23e5e5e5" },
                    { name: "Bradesco", url: "https://play.google.com/store/apps/details?id=com.bradesco", image: "https://api.iconify.design/tabler/credit-card.svg?color=%23e5e5e5" },
                    { name: "Caixa", url: "https://play.google.com/store/apps/details?id=br.com.gabba.Caixa", image: "https://api.iconify.design/tabler/home.svg?color=%23e5e5e5" },
                    { name: "Ita√∫", url: "https://play.google.com/store/apps/details?id=com.itau", image: "https://api.iconify.design/tabler/building-bank.svg?color=%23e5e5e5" },
                    { name: "Nubank", url: "https://play.google.com/store/apps/details?id=com.nu.production", image: "https://api.iconify.design/tabler/credit-card.svg?color=%23e5e5e5" },
                    { name: "Santander", url: "https://play.google.com/store/apps/details?id=com.santander.app", image: "https://api.iconify.design/tabler/credit-card.svg?color=%23e5e5e5" },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true }
                ]
            },
            {
                name: "Utilidades",
                items: [
                    { 
                        name: "Calculadora", 
                        hasSubItems: true,
                        subItems: [
                            { 
                                name: "Calculadora Google", 
                                url: "https://www.google.com/search?q=calculator", 
                                image: "https://api.iconify.design/tabler/calculator.svg?color=%23e5e5e5", 
                                description: "Calculadora online do Google",
                                isCard: true,
                                cardImage: "https://www.google.com/images/branding/googlelogo/2x/googlelogo_color_272x92dp.png"
                            },
                            { 
                                name: "Calculadora Cient√≠fica", 
                                url: "https://web2.0calc.com/", 
                                image: "https://api.iconify.design/tabler/math-function.svg?color=%23e5e5e5", 
                                description: "Calculadora cient√≠fica avan√ßada",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1635070041078-e363dbe005cb?w=400&h=250&fit=crop"
                            },
                            { 
                                name: "Conversor de Unidades", 
                                url: "https://www.convertworld.com/pt/", 
                                image: "https://api.iconify.design/tabler/arrows-exchange.svg?color=%23e5e5e5", 
                                description: "Conversor de medidas e unidades",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1554224155-6726b3ff858f?w=400&h=250&fit=crop"
                            },
                            { 
                                name: "Calculadora Financeira", 
                                url: "https://www.calculadorafinanceira.com.br/", 
                                image: "https://api.iconify.design/tabler/coin.svg?color=%23e5e5e5", 
                                description: "C√°lculos financeiros e investimentos",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1554224155-6726b3ff858f?w=400&h=250&fit=crop"
                            }
                        ]
                    },
                    { 
                        name: "Clima", 
                        hasSubItems: true,
                        subItems: [
                            { 
                                name: "Weather.com", 
                                url: "https://weather.com/pt-BR", 
                                image: "https://api.iconify.design/tabler/cloud.svg?color=%23e5e5e5", 
                                description: "Previs√£o do tempo detalhada",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1504608524841-42fe6f032b4b?w=400&h=250&fit=crop"
                            },
                            { 
                                name: "ClimaTempo", 
                                url: "https://www.climatempo.com.br/", 
                                image: "https://api.iconify.design/tabler/sun.svg?color=%23e5e5e5", 
                                description: "Previs√£o do tempo no Brasil",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=400&h=250&fit=crop"
                            },
                            { 
                                name: "INMET", 
                                url: "https://portal.inmet.gov.br/", 
                                image: "https://api.iconify.design/tabler/cloud-rain.svg?color=%23e5e5e5", 
                                description: "Instituto Nacional de Meteorologia",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1534088568595-a066f4102d71?w=400&h=250&fit=crop"
                            },
                            { 
                                name: "AccuWeather", 
                                url: "https://www.accuweather.com/pt/br/brazil-weather", 
                                image: "https://api.iconify.design/tabler/temperature.svg?color=%23e5e5e5", 
                                description: "Previs√£o meteorol√≥gica global",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1592210454359-9043f067919b?w=400&h=250&fit=crop"
                            }
                        ]
                    },
                    { 
                        name: "Tradutor", 
                        hasSubItems: true,
                        subItems: [
                            { 
                                name: "Google Tradutor", 
                                url: "https://translate.google.com/", 
                                image: "https://api.iconify.design/logos/google-translate.svg?color=%23e5e5e5", 
                                description: "Tradutor do Google",
                                isCard: true,
                                cardImage: "https://ssl.gstatic.com/translate/community/backgrounds/globe_small.png"
                            },
                            { 
                                name: "DeepL", 
                                url: "https://www.deepl.com/translator", 
                                image: "https://api.iconify.design/tabler/language.svg?color=%23e5e5e5", 
                                description: "Tradutor com IA avan√ßada",
                                isCard: true,
                                cardImage: "https://static.deepl.com/img/logo/deepl-logo-blue.svg"
                            },
                            { 
                                name: "Reverso", 
                                url: "https://www.reverso.net/text-translation", 
                                image: "https://api.iconify.design/tabler/abc.svg?color=%23e5e5e5", 
                                description: "Tradutor com contexto e exemplos",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1455390582262-044cdead277a?w=400&h=250&fit=crop"
                            },
                            { 
                                name: "Linguee", 
                                url: "https://www.linguee.com.br/", 
                                image: "https://api.iconify.design/tabler/book.svg?color=%23e5e5e5", 
                                description: "Dicion√°rio e tradutor bil√≠ngue",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=250&fit=crop"
                            }
                        ]
                    },
                    { 
                        name: "Mapas", 
                        hasSubItems: true,
                        subItems: [
                            { 
                                name: "Google Maps", 
                                url: "https://maps.google.com/", 
                                image: "https://api.iconify.design/logos/google-maps.svg?color=%23e5e5e5", 
                                description: "Mapas e navega√ß√£o do Google",
                                isCard: true,
                                cardImage: "https://developers.google.com/static/maps/images/maps-icon.svg"
                            },
                            { 
                                name: "Waze", 
                                url: "https://www.waze.com/pt-BR/live-map", 
                                image: "https://api.iconify.design/tabler/route.svg?color=%23e5e5e5", 
                                description: "Navega√ß√£o com tr√¢nsito em tempo real",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1569154941061-e231b4725ef1?w=400&h=250&fit=crop"
                            },
                            { 
                                name: "OpenStreetMap", 
                                url: "https://www.openstreetmap.org/", 
                                image: "https://api.iconify.design/tabler/map-2.svg?color=%23e5e5e5", 
                                description: "Mapa colaborativo mundial",
                                isCard: true,
                                cardImage: "https://wiki.openstreetmap.org/w/images/thumb/b/b0/Openstreetmap_logo.svg/256px-Openstreetmap_logo.svg.png"
                            },
                            { 
                                name: "Here Maps", 
                                url: "https://wego.here.com/", 
                                image: "https://api.iconify.design/tabler/map-pin.svg?color=%23e5e5e5", 
                                description: "Mapas e navega√ß√£o Here",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1524661135-423995f22d0b?w=400&h=250&fit=crop"
                            }
                        ]
                    },
                    { 
                        name: "Calend√°rio", 
                        hasSubItems: true,
                        subItems: [
                            { 
                                name: "Google Calendar", 
                                url: "https://calendar.google.com/", 
                                image: "https://api.iconify.design/logos/google-calendar.svg?color=%23e5e5e5", 
                                description: "Calend√°rio do Google",
                                isCard: true,
                                cardImage: "https://ssl.gstatic.com/calendar/images/dynamiclogo_2020q4/calendar_31_2x.png"
                            },
                            { 
                                name: "Outlook Calendar", 
                                url: "https://outlook.live.com/calendar/", 
                                image: "https://api.iconify.design/logos/microsoft-outlook.svg?color=%23e5e5e5", 
                                description: "Calend√°rio do Outlook",
                                isCard: true,
                                cardImage: "https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/assets/brand-icons/product/svg/outlook_48x1.svg"
                            },
                            { 
                                name: "Calend√°rio Online", 
                                url: "https://www.calendario.com.br/", 
                                image: "https://api.iconify.design/tabler/calendar-event.svg?color=%23e5e5e5", 
                                description: "Calend√°rio brasileiro online",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=250&fit=crop"
                            },
                            { 
                                name: "TimeAndDate", 
                                url: "https://www.timeanddate.com/calendar/", 
                                image: "https://api.iconify.design/tabler/clock.svg?color=%23e5e5e5", 
                                description: "Calend√°rio mundial com fusos",
                                isCard: true,
                                cardImage: "https://images.unsplash.com/photo-1495364141860-b066f4102d75?w=400&h=250&fit=crop"
                            }
                        ]
                    },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true }
                ]
            },
            {
                name: "Lazer",
                items: [
                    { 
                        name: "AudioLivros", 
                        hasSubItems: true,
                        subItems: [
                            { 
                                name: "Audible", 
                                url: "https://www.audible.com.br/", 
                                image: "https://api.iconify.design/tabler/headphones.svg?color=%23e5e5e5", 
                                description: "Plataforma de audiolivros da Amazon",
                                isCard: true,
                                cardImage: "https://m.media-amazon.com/images/G/32/audible/web/logo-audible-white._CB1565125222_.png"
                            },
                            { 
                                name: "Storytel", 
                                url: "https://www.storytel.com/br/pt/", 
                                image: "https://api.iconify.design/tabler/book-2.svg?color=%23e5e5e5", 
                                description: "Streaming de audiolivros e e-books",
                                isCard: true,
                                cardImage: "https://cdn.storytel.com/web/assets/storytel-logo-white.svg"
                            }
                        ]
                    },
                    { name: "Netflix", url: "https://www.netflix.com/", image: "https://api.iconify.design/logos/netflix-icon.svg?color=%23e5e5e5" },
                    { name: "PlutoTV", url: "https://pluto.tv/br/", image: "https://api.iconify.design/tabler/device-tv.svg?color=%23e5e5e5" },
                    { name: "Prime Video", url: "https://www.primevideo.com/", image: "https://api.iconify.design/tabler/video.svg?color=%23e5e5e5" },
                    { name: "Spotify", url: "https://open.spotify.com/", image: "https://api.iconify.design/logos/spotify-icon.svg?color=%23e5e5e5" },
                    { name: "YouTube", url: "https://play.google.com/store/apps/details?id=com.google.android.youtube", image: "https://api.iconify.design/logos/youtube-icon.svg?color=%23e5e5e5" },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true }
                ]
            },
            {
                name: "Alimenta√ß√£o",
                items: [
                    { name: "iFood", url: "https://play.google.com/store/apps/details?id=br.com.brainweb.ifood", image: "https://api.iconify.design/tabler/tools-kitchen-2.svg?color=%23e5e5e5" },
                    { name: "P√£o de A√ß√∫car", url: "https://play.google.com/store/apps/details?id=br.com.paodeacucar.mobile", image: "https://api.iconify.design/tabler/shopping-cart.svg?color=%23e5e5e5" },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
                    { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true }
                ]
            },
            {
                name: "Transporte",
                items: [
        { name: "Uber", url: "https://play.google.com/store/apps/details?id=com.ubercab", image: "https://api.iconify.design/tabler/car.svg?color=%23e5e5e5" },
        { name: "99", url: "https://play.google.com/store/apps/details?id=com.taxis99", image: "https://api.iconify.design/tabler/taxi.svg?color=%23e5e5e5" },
        { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
        { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
        { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
        { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true },
        { name: "Reservado", url: "#", image: "https://api.iconify.design/tabler/dots.svg?color=%23666666", disabled: true }
            ]
        },   
    ];
        

        // Nova estrutura para categoria "Participe"

        // Vari√°veis para controle do modo de edi√ß√£o - MOVIDAS PARA O TOPO
        // let isEditMode = false; // REMOVIDO - j√° definido no in√≠cio
        // let isToggleVisible = false; // REMOVIDO - j√° definido no in√≠cio  
        // let currentEditingItem = null; // REMOVIDO - j√° definido no in√≠cio
        // let customItemData = {}; // REMOVIDO - j√° definido no in√≠cio
        
        // Fun√ß√£o para ativar/desativar modo de edi√ß√£o
        function toggleEditMode(activate) {
            isEditMode = activate;
            const body = document.body;
            const headerTitle = document.getElementById('headerTitle');
            const editToggle = document.getElementById('editModeToggle');
            
            console.log(`Modo de edi√ß√£o ${activate ? 'ATIVADO' : 'DESATIVADO'}:`, {
                isEditMode: isEditMode,
                bodyHasClass: body.classList.contains('edit-mode')
            });

            if (activate) {
                body.classList.add('edit-mode');
                
                // Obter nome personalizado do usu√°rio
                const customUserName = document.getElementById('userTypeLabel')?.textContent || 'INDIVIDUAL';
                headerTitle.textContent = `Edi√ß√£o... [${customUserName}]`;
                
                // Adicionar logo personalizado ao lado do t√≠tulo se dispon√≠vel
                updateHeaderWithCustomLogo();
                
                if (editToggle) editToggle.checked = true;
                
                // Adiciona classes edit√°veis aos elementos
                addEditableClasses();
                
                // Adiciona indicadores de upgrade
                addUpgradeIndicators();
                
                // Ativa intercepta√ß√£o de edi√ß√£o de categorias
                interceptCategoryEdit();
                
                // Ativa edi√ß√£o da nomenclatura INDIVIDUAL
                enableUserTypeEditing();
                
                // Ativa edi√ß√£o do logo do usu√°rio
                toggleUserTypeLogoEdit(true);
            } else {
                body.classList.remove('edit-mode');
                headerTitle.textContent = 'Acessos';
                
                // Atualiza logo (mant√©m se for personalizado, remove se for padr√£o)
                updateHeaderWithCustomLogo();
                
                if (editToggle) editToggle.checked = false;
                
                // Remove classes edit√°veis
                removeEditableClasses();
                
                // Remove indicadores de upgrade
                addUpgradeIndicators();
                
                // Desativa edi√ß√£o da nomenclatura INDIVIDUAL
                disableUserTypeEditing();
                
                // Desativa edi√ß√£o do logo do usu√°rio
                toggleUserTypeLogoEdit(false);
            }

            // Re-renderiza a sidebar para atualizar contadores
            renderMeusAppsCategoriesSidebar();
            
            // Re-renderiza cards se estiver visualizando qualquer subcategoria com cards
            const currentTitle = document.querySelector('.category-title-header');
            if (currentTitle) {
                const titleText = currentTitle.textContent;
                
                // Extrai o nome da categoria e subcategoria do t√≠tulo (formato: "Categoria - Subcategoria")
                const titleParts = titleText.split(' - ');
                if (titleParts.length === 2) {
                    const categoryName = titleParts[0].trim();
                    const subCategoryName = titleParts[1].trim();
                    
                    // Encontra a categoria nos dados
                    const category = meusAppsCategoriesData.find(cat => cat.name === categoryName);
                    if (category) {
                        // Encontra o item/subcategoria
                        const subCategoryItem = category.items.find(item => item.name === subCategoryName);
                        if (subCategoryItem && subCategoryItem.hasSubItems) {
                            console.log(`Re-renderizando cards para: ${categoryName} - ${subCategoryName}`);
                            displaySubItemsAsCards(subCategoryItem, categoryName);
                        }
                    }
                }
            }
            
            // Salva o estado no localStorage
            localStorage.setItem('editMode', activate.toString());
        }
        
        // Fun√ß√£o para atualizar o header com logo personalizado
        function updateHeaderWithCustomLogo() {
            const headerTitle = document.getElementById('headerTitle');
            const logoImage = document.getElementById('logoImage');
            
            // Remove logo anterior se existir
            const existingLogo = headerTitle.querySelector('.custom-header-logo');
            if (existingLogo) {
                existingLogo.remove();
            }
            
            // Verifica se √© um logo personalizado (diferente do padr√£o)
            const defaultLogo = 'https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png';
            const isCustomLogo = logoImage && logoImage.src && logoImage.src !== defaultLogo;
            
            // Adiciona logo se for personalizado OU se estiver em modo de edi√ß√£o
            if (logoImage && logoImage.src && (isCustomLogo || isEditMode)) {
                const miniLogo = document.createElement('img');
                miniLogo.src = logoImage.src;
                miniLogo.className = 'custom-header-logo';
                miniLogo.style.cssText = `
                    width: 20px;
                    height: 20px;
                    margin-right: 8px;
                    border-radius: 3px;
                    vertical-align: middle;
                    object-fit: cover;
                    border: 1px solid rgba(255,255,255,0.2);
                `;
                
                // Insere o logo no in√≠cio do t√≠tulo
                headerTitle.insertBefore(miniLogo, headerTitle.firstChild);
                
                console.log('üñºÔ∏è Logo adicionado ao header:', logoImage.src, '(Custom:', isCustomLogo, ', EditMode:', isEditMode, ')');
            }
        }
        
        // Fun√ß√£o para re-renderizar os bot√µes de Meus Apps
        function reRenderMeusAppsButtons() {
            console.log('Re-renderizando bot√µes, isEditMode:', isEditMode); // Debug
            renderMeusAppsCategoriesSidebar();
        }
        
        // Fun√ß√£o para adicionar classes edit√°veis
        function addEditableClasses() {
            // Adicionar apenas aos bot√µes de Meus Apps (nos sub-acorde√µes)
            const meusAppsSubButtons = document.querySelectorAll('#saudeItemsList button:not([disabled]), #comunicacaoItemsList button:not([disabled]), #bancoItemsList button:not([disabled]), #utilidadesItemsList button:not([disabled]), #lazerItemsList button:not([disabled])');
            console.log('addEditableClasses: Encontrados', meusAppsSubButtons.length, 'bot√µes para adicionar classe editable'); // Debug
            meusAppsSubButtons.forEach((btn, index) => {
                btn.classList.add('editable-item');
                console.log(`Classe editable-item adicionada ao bot√£o ${index + 1}:`, btn.textContent); // Debug
                
                // Intercepta cliques em bot√µes "Reservado"
                if (btn.textContent.trim() === 'Reservado') {
                    btn.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        showUpgradeAlert('Adicionar novos aplicativos');
                    });
                    
                    // Adiciona indicador visual
                    if (!btn.querySelector('.PERSONALIZADO-mini-indicator')) {
                        const miniIndicator = document.createElement('span');
                        miniIndicator.className = 'PERSONALIZADO-mini-indicator';
                        miniIndicator.innerHTML = 'üöÄ';
                        miniIndicator.style.cssText = `
                            position: absolute;
                            top: -5px;
                            right: -5px;
                            background: #ff6b35;
                            border-radius: 50%;
                            width: 16px;
                            height: 16px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            z-index: 10;
                        `;
                        btn.style.position = 'relative';
                        btn.appendChild(miniIndicator);
                    }
                }
            });
        }
        
        // Fun√ß√£o para remover classes edit√°veis
        function removeEditableClasses() {
            const editableItems = document.querySelectorAll('.editable-item');
            editableItems.forEach(item => {
                item.classList.remove('editable-item');
                
                // Remove indicadores mini de upgrade
                const miniIndicator = item.querySelector('.PERSONALIZADO-mini-indicator');
                if (miniIndicator) {
                    miniIndicator.remove();
                }
            });
        }
        
        // Fun√ß√£o para mostrar modal de confirma√ß√£o
        function showEditModeConfirmation() {
            document.getElementById('editModeConfirmModal').classList.remove('hidden');
        }
        
        // Fun√ß√£o para esconder modal de confirma√ß√£o
        function hideEditModeConfirmation() {
            document.getElementById('editModeConfirmModal').classList.add('hidden');
        }

        // Fun√ß√£o para mostrar/esconder o toggle de edi√ß√£o
        function toggleEditModeVisibility() {
            const toggleContainer = document.getElementById('editModeToggleContainer');
            const supportLogo = document.getElementById('supportLogo');
            
            isToggleVisible = !isToggleVisible;
            
            if (isToggleVisible) {
                toggleContainer.style.display = 'flex';
                supportLogo.classList.add('toggle-visible');
                // N√ÉO salvar estado no localStorage - sempre for√ßa clique manual
                // localStorage.setItem('toggleVisible', 'true'); // REMOVIDO
            } else {
                toggleContainer.style.display = 'none';
                supportLogo.classList.remove('toggle-visible');
                // Sempre desativar o modo de edi√ß√£o ao esconder o toggle
                if (isEditMode) {
                    toggleEditMode(false);
                }
                // N√£o salvar estado - sempre inicia oculto
                // localStorage.removeItem('editMode'); // J√° removido na fun√ß√£o toggleEditMode
                // localStorage.setItem('toggleVisible', 'false'); // REMOVIDO
            }
        }

        // Fun√ß√µes para o Modal de Edi√ß√£o Individual
        function openItemEditModal(itemData, buttonElement) {
            currentEditingItem = { data: itemData, element: buttonElement };
            
            // Carrega dados personalizados se existirem
            const itemKey = generateItemKey(itemData);
            const customData = customItemData[itemKey] || {};
            
            // Preenche os campos do modal
            document.getElementById('editItemName').value = customData.name || itemData.name;
            document.getElementById('editItemUrl').value = customData.url || itemData.url;
            
            // Mostra o modal
            document.getElementById('itemEditModal').classList.remove('hidden');
        }

        function closeItemEditModal() {
            document.getElementById('itemEditModal').classList.add('hidden');
            currentEditingItem = null;
        }

        function saveItemEditData() {
            if (!currentEditingItem) return;
            
            const newName = document.getElementById('editItemName').value.trim();
            const newUrl = document.getElementById('editItemUrl').value.trim();
            
            // Valida√ß√£o b√°sica
            if (!newName) {
                alert('Por favor, digite um nome para o aplicativo.');
                return;
            }
            
            if (!newUrl) {
                alert('Por favor, digite uma URL v√°lida.');
                return;
            }
            
            // Adiciona https:// se n√£o tiver protocolo
            let finalUrl = newUrl;
            if (!newUrl.startsWith('http://') && !newUrl.startsWith('https://')) {
                finalUrl = 'https://' + newUrl;
            }
            
            // Salva os dados personalizados
            const itemKey = generateItemKey(currentEditingItem.data);
            customItemData[itemKey] = {
                name: newName,
                url: finalUrl,
                originalName: currentEditingItem.data.name,
                originalUrl: currentEditingItem.data.url
            };
            
            // Salva no localStorage
            localStorage.setItem('customItemData', JSON.stringify(customItemData));
            
            // Atualiza o bot√£o visualmente
            updateButtonDisplay(currentEditingItem.element, newName);
            
            // Fecha o modal
            closeItemEditModal();
            
            // Feedback visual
            showSaveConfirmation();
        }

        function generateItemKey(itemData) {
            // Gera uma chave √∫nica baseada no nome original do item
            return itemData.name.toLowerCase().replace(/\s+/g, '_');
        }

        function updateButtonDisplay(buttonElement, newName) {
            // Atualiza o texto do bot√£o
            buttonElement.textContent = newName;
            
            // Adiciona uma classe para indicar que foi personalizado
            buttonElement.classList.add('customized-item');
        }

        function showSaveConfirmation() {
            // Cria um feedback visual tempor√°rio
            const feedback = document.createElement('div');
            feedback.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 4px;
                z-index: 10000;
                box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            `;
            feedback.textContent = '‚úÖ Altera√ß√µes salvas com sucesso!';
            document.body.appendChild(feedback);
            
            // Remove ap√≥s 3 segundos
            setTimeout(() => {
                document.body.removeChild(feedback);
            }, 3000);
        }

        function loadCustomItemData() {
            // Carrega dados personalizados do localStorage
            const saved = localStorage.getItem('customItemData');
            if (saved) {
                try {
                    customItemData = JSON.parse(saved);
                } catch (e) {
                    console.error('Erro ao carregar dados personalizados:', e);
                    customItemData = {};
                }
            }
            
            // Carrega tamb√©m os dados de cards
            loadCustomCardData();
            
            // Migra dados antigos para novo formato se necess√°rio
            migrateOldDataFormat();
        }

        // Fun√ß√£o para migrar dados antigos para novo formato
        function migrateOldDataFormat() {
            let needsSave = false;
            
            // Migra dados de cards
            const oldCardKeys = Object.keys(customCardData).filter(key => !key.startsWith('card_') && !key.startsWith('item_'));
            oldCardKeys.forEach(oldKey => {
                const parts = oldKey.split('_');
                if (parts.length === 3) {
                    const [categoryName, parentItemName, cardIndex] = parts;
                    const newKey = generateCardKey(categoryName, parentItemName, cardIndex);
                    
                    // Move dados para nova chave se n√£o existir
                    if (!customCardData[newKey]) {
                        customCardData[newKey] = customCardData[oldKey];
                        needsSave = true;
                    }
                    
                    // Remove chave antiga
                    delete customCardData[oldKey];
                    needsSave = true;
                }
            });
            
            // Migra dados de itens simples
            const oldItemKeys = Object.keys(customItemData).filter(key => !key.startsWith('item_'));
            oldItemKeys.forEach(oldKey => {
                const parts = oldKey.split('_');
                if (parts.length === 2) {
                    const [categoryName, itemName] = parts;
                    const newKey = generateItemKey(categoryName, itemName);
                    
                    // Move dados para nova chave se n√£o existir
                    if (!customItemData[newKey]) {
                        customItemData[newKey] = customItemData[oldKey];
                        needsSave = true;
                    }
                    
                    // Remove chave antiga
                    delete customItemData[oldKey];
                    needsSave = true;
                }
            });
            
            // Salva se houve mudan√ßas
            if (needsSave) {
                localStorage.setItem('customCardData', JSON.stringify(customCardData));
                localStorage.setItem('customItemData', JSON.stringify(customItemData));
                console.log('Dados migrados para novo formato de chaves');
            }
        }

        // Vari√°veis para controle da edi√ß√£o de cards
        let currentEditingCard = null;

        // Fun√ß√£o para abrir modal de edi√ß√£o de card
        function openCardEditModal(parentItemName, cardIndex) {
            // Encontra o item pai e o card espec√≠fico
            const category = meusAppsCategoriesData.find(cat => 
                cat.items.some(item => item.name === parentItemName)
            );
            
            if (!category) return;
            
            const parentItem = category.items.find(item => item.name === parentItemName);
            if (!parentItem || !parentItem.subItems || !parentItem.subItems[cardIndex]) return;
            
            const card = parentItem.subItems[cardIndex];
            currentEditingCard = { 
                categoryName: category.name,
                parentItemName: parentItemName, 
                cardIndex: cardIndex,
                originalCard: card 
            };
            
            // Carrega dados personalizados se existirem
            const cardKey = generateCardKey(category.name, parentItemName, cardIndex);
            const customData = customCardData[cardKey] || {};
            
            // Preenche os campos do modal
            document.getElementById('editCardTitle').value = customData.name || card.name;
            document.getElementById('editCardImage').value = customData.cardImage || card.cardImage || card.image;
            document.getElementById('editCardUrl').value = customData.url || card.url;
            document.getElementById('editCardDescription').value = customData.description || card.description || '';
            
            // Mostra o modal
            document.getElementById('cardEditModal').classList.remove('hidden');
        }

        // Fun√ß√£o para fechar modal de edi√ß√£o de card
        function closeCardEditModal() {
            document.getElementById('cardEditModal').classList.add('hidden');
            currentEditingCard = null;
        }

        // Fun√ß√£o para salvar edi√ß√£o de card
        function saveCardEdit() {
            if (!currentEditingCard) return;
            
            const newTitle = document.getElementById('editCardTitle').value.trim();
            const newImage = document.getElementById('editCardImage').value.trim();
            const newUrl = document.getElementById('editCardUrl').value.trim();
            const newDescription = document.getElementById('editCardDescription').value.trim();
            
            // Valida√ß√£o b√°sica
            if (!newTitle) {
                alert('Por favor, digite um t√≠tulo para o card.');
                return;
            }
            
            if (!newUrl) {
                alert('Por favor, digite uma URL de acesso v√°lida.');
                return;
            }
            
            // Adiciona https:// se n√£o tiver protocolo
            let finalUrl = newUrl;
            if (!newUrl.startsWith('http://') && !newUrl.startsWith('https://')) {
                finalUrl = 'https://' + newUrl;
            }
            
            // Salva os dados personalizados
            const cardKey = generateCardKey(
                currentEditingCard.categoryName, 
                currentEditingCard.parentItemName, 
                currentEditingCard.cardIndex
            );
            
            customCardData[cardKey] = {
                name: newTitle,
                cardImage: newImage,
                url: finalUrl,
                description: newDescription,
                originalName: currentEditingCard.originalCard.name,
                originalCardImage: currentEditingCard.originalCard.cardImage,
                originalUrl: currentEditingCard.originalCard.url,
                originalDescription: currentEditingCard.originalCard.description
            };
            
            // Salva no localStorage
            localStorage.setItem('customCardData', JSON.stringify(customCardData));
            
            // Re-renderiza os cards para mostrar as mudan√ßas
            const category = meusAppsCategoriesData.find(cat => cat.name === currentEditingCard.categoryName);
            const parentItem = category.items.find(item => item.name === currentEditingCard.parentItemName);
            displaySubItemsAsCards(parentItem, currentEditingCard.categoryName);
            
            // Fecha o modal
            closeCardEditModal();
            
            // Feedback visual
            showSaveConfirmation();
        }

        // Fun√ß√£o para gerar chave √∫nica do card
        function generateCardKey(categoryName, parentItemName, cardIndex) {
            // Encontra o √≠ndice da categoria para garantir unicidade absoluta
            const categoryIndex = meusAppsCategoriesData.findIndex(cat => cat.name === categoryName);
            // Inclui mais informa√ß√µes para garantir unicidade absoluta
            return `card_${categoryIndex}_${categoryName}_${parentItemName}_${cardIndex}`.toLowerCase().replace(/\s+/g, '_').replace(/[^a-z0-9_]/g, '');
        }

        // Fun√ß√£o para carregar dados personalizados de cards
        function loadCustomCardData() {
            const saved = localStorage.getItem('customCardData');
            if (saved) {
                try {
                    customCardData = JSON.parse(saved);
                } catch (e) {
                    console.error('Erro ao carregar dados personalizados de cards:', e);
                    customCardData = {};
                }
            }
        }

        // Fun√ß√£o para aplicar dados personalizados aos cards
        function applyCustomCardData() {
            Object.keys(customCardData).forEach(cardKey => {
                const customData = customCardData[cardKey];
                
                // Novo formato: card_index_categoria_subcategoria_cardindex
                if (cardKey.startsWith('card_')) {
                    const parts = cardKey.substring(5).split('_'); // Remove 'card_' e divide
                    if (parts.length >= 4) {
                        const cardIndex = parts.pop(); // √öltimo elemento √© o √≠ndice do card
                        const parentItemName = parts.pop(); // Pen√∫ltimo √© o item pai
                        const categoryIndex = parts.shift(); // Primeiro √© o √≠ndice da categoria
                        const categoryName = parts.join('_'); // Resto √© a categoria
                        
                        // Usa o √≠ndice da categoria para encontrar a categoria correta
                        const category = meusAppsCategoriesData[parseInt(categoryIndex)];
                        
                        if (category && category.name.toLowerCase().replace(/\s+/g, '_').replace(/[^a-z0-9_]/g, '') === categoryName) {
                            const parentItem = category.items.find(item => 
                                item.name.toLowerCase().replace(/\s+/g, '_').replace(/[^a-z0-9_]/g, '') === parentItemName
                            );
                            
                            if (parentItem && parentItem.subItems && parentItem.subItems[parseInt(cardIndex)]) {
                                const card = parentItem.subItems[parseInt(cardIndex)];
                                // Aplica os dados personalizados temporariamente para renderiza√ß√£o
                                card._customName = customData.name;
                                card._customCardImage = customData.cardImage;
                                card._customUrl = customData.url;
                                card._customDescription = customData.description;
                            }
                        }
                    }
                } else {
                    // Formato antigo para compatibilidade (ser√° removido gradualmente)
                    const [categoryName, parentItemName, cardIndex] = cardKey.split('_');
                    
                    const category = meusAppsCategoriesData.find(cat => 
                        cat.name.toLowerCase().replace(/\s+/g, '_') === categoryName
                    );
                    
                    if (category) {
                        const parentItem = category.items.find(item => 
                            item.name.toLowerCase().replace(/\s+/g, '_') === parentItemName
                        );
                        
                        if (parentItem && parentItem.subItems && parentItem.subItems[parseInt(cardIndex)]) {
                            const card = parentItem.subItems[parseInt(cardIndex)];
                            // Aplica os dados personalizados temporariamente para renderiza√ß√£o
                            card._customName = customData.name;
                            card._customCardImage = customData.cardImage;
                            card._customUrl = customData.url;
                            card._customDescription = customData.description;
                        }
                    }
                }
            });
        }

        // === FUN√á√ïES PARA EDI√á√ÉO DA NOMENCLATURA INDIVIDUAL ===
        
        // Fun√ß√£o para ativar edi√ß√£o da nomenclatura INDIVIDUAL
        function enableUserTypeEditing() {
            const userTypeLabel = document.getElementById('userTypeLabel');
            const sidebarHeader = document.querySelector('.sidebar-user-header');
            
            if (!userTypeLabel) return;
            
            // Torna o elemento edit√°vel
            userTypeLabel.contentEditable = true;
            userTypeLabel.classList.add('editable');
            sidebarHeader.classList.add('edit-mode');
            
            // Adiciona listeners de eventos
            userTypeLabel.addEventListener('click', handleUserTypeLabelClick);
            userTypeLabel.addEventListener('blur', saveUserTypeLabel);
            userTypeLabel.addEventListener('keydown', handleUserTypeLabelKeydown);
            
            console.log('Edi√ß√£o de nomenclatura INDIVIDUAL ativada');
        }
        
        // Fun√ß√£o para desativar edi√ß√£o da nomenclatura INDIVIDUAL
        function disableUserTypeEditing() {
            const userTypeLabel = document.getElementById('userTypeLabel');
            const sidebarHeader = document.querySelector('.sidebar-user-header');
            
            if (!userTypeLabel) return;
            
            // Remove editabilidade
            userTypeLabel.contentEditable = false;
            userTypeLabel.classList.remove('editable');
            sidebarHeader.classList.remove('edit-mode');
            
            // Remove listeners de eventos
            userTypeLabel.removeEventListener('click', handleUserTypeLabelClick);
            userTypeLabel.removeEventListener('blur', saveUserTypeLabel);
            userTypeLabel.removeEventListener('keydown', handleUserTypeLabelKeydown);
            
            console.log('Edi√ß√£o de nomenclatura INDIVIDUAL desativada');
        }
        
        // Fun√ß√£o para lidar com clique no label de usu√°rio
        function handleUserTypeLabelClick(event) {
            const label = event.target;
            
            // Seleciona todo o texto
            const range = document.createRange();
            const selection = window.getSelection();
            range.selectNodeContents(label);
            selection.removeAllRanges();
            selection.addRange(range);
        }
        
        // Fun√ß√£o para salvar nomenclatura editada
        function saveUserTypeLabel() {
            const userTypeLabel = document.getElementById('userTypeLabel');
            if (!userTypeLabel) return;
            
            let newText = userTypeLabel.textContent.trim();
            
            // Se estiver vazio, volta para o padr√£o
            if (!newText) {
                newText = 'INDIVIDUAL';
            }
            
            // Atualiza o texto
            userTypeLabel.textContent = newText;
            
            // Salva no localStorage
            localStorage.setItem('userTypeLabel', newText);
            
            // Atualiza tamb√©m o t√≠tulo do header quando em modo de edi√ß√£o
            if (isEditMode) {
                const headerTitle = document.getElementById('headerTitle');
                headerTitle.textContent = `Edi√ß√£o... [${newText}]`;
                
                // Atualiza o logo personalizado no header
                updateHeaderWithCustomLogo();
            }
            
            console.log('Nomenclatura salva:', newText);
            showSaveConfirmation();
        }
        
        // Fun√ß√£o para lidar com teclas pressionadas
        function handleUserTypeLabelKeydown(event) {
            if (event.key === 'Enter') {
                event.preventDefault();
                event.target.blur(); // Isso vai chamar saveUserTypeLabel
            }
            
            if (event.key === 'Escape') {
                event.preventDefault();
                loadUserTypeLabel(); // Restaura valor salvo
                event.target.blur();
            }
        }
        
        // Fun√ß√£o para carregar nomenclatura salva
        function loadUserTypeLabel() {
            const savedLabel = localStorage.getItem('userTypeLabel');
            const userTypeLabel = document.getElementById('userTypeLabel');
            
            if (savedLabel && userTypeLabel) {
                // Remove emoji de alvo se existir
                let cleanLabel = savedLabel.replace(/^üéØ\s*/, '');
                if (!cleanLabel) cleanLabel = 'INDIVIDUAL';
                
                userTypeLabel.textContent = cleanLabel;
                
                // Atualiza o localStorage com o valor limpo
                localStorage.setItem('userTypeLabel', cleanLabel);
                
                console.log('Nomenclatura carregada e limpa:', cleanLabel);
            }
        }
        
        // === FUN√á√ïES PARA EDI√á√ÉO DO LOGO DO USU√ÅRIO ===
        
        // Fun√ß√£o para carregar logo do usu√°rio salvo
        function loadUserTypeLogo() {
            const userTypeLogo = document.getElementById('userTypeLogo');
            const mainLogo = document.getElementById('logoImage');
            
            if (userTypeLogo && mainLogo) {
                // Sincroniza com o logo principal
                userTypeLogo.src = mainLogo.src;
                userTypeLogo.alt = mainLogo.alt || 'User Logo';
                console.log('Logo do usu√°rio sincronizado com logo principal:', mainLogo.src);
            }
        }
        
        // Fun√ß√£o para salvar logo do usu√°rio (agora salva no logo principal)
        function saveUserTypeLogo(src, alt) {
            const mainLogo = document.getElementById('logoImage');
            const userTypeLogo = document.getElementById('userTypeLogo');
            
            if (mainLogo && userTypeLogo) {
                // Atualiza ambos os logos
                mainLogo.src = src;
                mainLogo.alt = alt || 'Logo';
                userTypeLogo.src = src;
                userTypeLogo.alt = alt || 'User Logo';
                
                // Salva no localStorage do logo principal
                const logoData = { src, alt };
                localStorage.setItem('customLogo', JSON.stringify(logoData));
                console.log('Logo principal e do usu√°rio atualizados:', logoData);
                
                // Atualizar header sempre
                updateHeaderWithCustomLogo();
            }
        }
        
        // Fun√ß√£o para abrir seletor de logo do usu√°rio
        function openUserTypeLogoSelector() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const userTypeLogo = document.getElementById('userTypeLogo');
                        userTypeLogo.src = e.target.result;
                        saveUserTypeLogo(e.target.result, file.name);
                        
                        // Feedback visual
                        userTypeLogo.style.transform = 'scale(1.2)';
                        setTimeout(() => {
                            userTypeLogo.style.transform = '';
                        }, 300);
                        
                        console.log('üñºÔ∏è Logo do usu√°rio alterado:', file.name);
                    };
                    reader.readAsDataURL(file);
                }
            };
            
            input.click();
        }
        
        // Fun√ß√£o para ativar/desativar edi√ß√£o do logo do usu√°rio
        function toggleUserTypeLogoEdit(isEditMode) {
            const userTypeLogo = document.getElementById('userTypeLogo');
            const sidebarHeader = document.querySelector('.sidebar-user-header');
            
            if (isEditMode) {
                sidebarHeader.classList.add('edit-mode');
                userTypeLogo.addEventListener('click', openUserTypeLogoSelector);
            } else {
                sidebarHeader.classList.remove('edit-mode');
                userTypeLogo.removeEventListener('click', openUserTypeLogoSelector);
            }
        }
        


        // Vari√°veis para controle da edi√ß√£o de itens simples
        let currentEditingSimpleItem = null;

        // Fun√ß√£o para abrir modal de edi√ß√£o de item simples
        function openSimpleItemEditModal(categoryName, itemName) {
            // Encontra o item espec√≠fico
            const category = meusAppsCategoriesData.find(cat => cat.name === categoryName);
            if (!category) return;
            
            const item = category.items.find(i => i.name === itemName);
            if (!item || item.hasSubItems) return; // S√≥ para itens simples
            
            currentEditingSimpleItem = { 
                categoryName: categoryName,
                itemName: itemName,
                originalItem: item 
            };
            
            // Carrega dados personalizados se existirem
            const itemKey = generateItemKey(categoryName, itemName);
            const customData = customItemData[itemKey] || {};
            
            // Preenche os campos do modal
            document.getElementById('editSimpleItemName').value = customData.name || item.name;
            document.getElementById('editSimpleItemUrl').value = customData.url || item.url;
            
            // Mostra o modal
            document.getElementById('simpleItemEditModal').classList.remove('hidden');
        }

        // Fun√ß√£o para fechar modal de edi√ß√£o de item simples
        function closeSimpleItemEditModal() {
            document.getElementById('simpleItemEditModal').classList.add('hidden');
            currentEditingSimpleItem = null;
        }

        // Fun√ß√£o para salvar edi√ß√£o de item simples
        function saveSimpleItemEdit() {
            if (!currentEditingSimpleItem) return;
            
            const newName = document.getElementById('editSimpleItemName').value.trim();
            const newUrl = document.getElementById('editSimpleItemUrl').value.trim();
            
            // Valida√ß√£o b√°sica
            if (!newName) {
                alert('Por favor, digite um nome para o item.');
                return;
            }
            
            if (!newUrl) {
                alert('Por favor, digite uma URL de acesso v√°lida.');
                return;
            }
            
            // Adiciona https:// se n√£o tiver protocolo
            let finalUrl = newUrl;
            if (!newUrl.startsWith('http://') && !newUrl.startsWith('https://')) {
                finalUrl = 'https://' + newUrl;
            }
            
            // Salva os dados personalizados
            const itemKey = generateItemKey(
                currentEditingSimpleItem.categoryName, 
                currentEditingSimpleItem.itemName
            );
            
            customItemData[itemKey] = {
                name: newName,
                url: finalUrl,
                originalName: currentEditingSimpleItem.originalItem.name,
                originalUrl: currentEditingSimpleItem.originalItem.url
            };
            
            // Salva no localStorage
            localStorage.setItem('customItemData', JSON.stringify(customItemData));
            
            // Re-renderiza a sidebar para mostrar as mudan√ßas
            renderMeusAppsCategoriesSidebar();
            
            // Fecha o modal
            closeSimpleItemEditModal();
            
            // Feedback visual
            showSaveConfirmation();
        }

        // Fun√ß√£o para gerar chave √∫nica do item simples
        function generateItemKey(categoryName, itemName) {
            // Encontra o √≠ndice da categoria para garantir unicidade absoluta
            const categoryIndex = meusAppsCategoriesData.findIndex(cat => cat.name === categoryName);
            // Inclui prefixo, √≠ndice da categoria e sanitiza√ß√£o para garantir unicidade absoluta
            return `item_${categoryIndex}_${categoryName}_${itemName}`.toLowerCase().replace(/\s+/g, '_').replace(/[^a-z0-9_]/g, '');
        }

        function loadCustomItemData() {
            // Carrega dados personalizados do localStorage
            const saved = localStorage.getItem('customItemData');
            if (saved) {
                try {
                    customItemData = JSON.parse(saved);
                } catch (e) {
                    console.error('Erro ao carregar dados personalizados:', e);
                    customItemData = {};
                }
            }
            
            // Carrega tamb√©m os dados de cards
            loadCustomCardData();
        }

        // Fun√ß√£o para limpar dados conflitantes (usar apenas em caso de emerg√™ncia)
        function clearConflictingData() {
            if (confirm('ATEN√á√ÉO: Isso ir√° limpar TODAS as personaliza√ß√µes. Tem certeza?')) {
                customCardData = {};
                customItemData = {};
                localStorage.removeItem('customCardData');
                localStorage.removeItem('customItemData');
                
                // Re-renderiza tudo
                renderMeusAppsCategoriesSidebar();
                
                alert('Dados limpos com sucesso! Todas as personaliza√ß√µes foram removidas.');
                console.log('Dados conflitantes limpos pelo usu√°rio');
            }
        }

        // Inicializa√ß√£o quando a p√°gina carrega
        document.addEventListener('DOMContentLoaded', function() {
            // VERS√ÉO INDIVIDUAL: SEM limpeza autom√°tica - dados s√£o persistidos
            console.log('üîß Vers√£o INDIVIDUAL inicializada - dados persistidos');
            
            // Carrega dados existentes
            loadCustomItemData();
            renderMeusAppsCategoriesSidebar();
            renderVideosCategoriesSidebar();
            
            // Fun√ß√£o global para emerg√™ncia (acess√≠vel via console)
            window.clearAllCustomData = clearConflictingData;
            
            console.log('üîß Sistema de edi√ß√£o INDIVIDUAL inicializado');
            console.log('üí° Fun√ß√µes dispon√≠veis:');
            console.log('   - clearAllCustomData() - Limpa todas as personaliza√ß√µes');
        });



        // Fun√ß√£o para mostrar aviso de upgrade
        function showUpgradeAlert(feature) {
            const upgradeModal = document.createElement('div');
            upgradeModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: linear-gradient(135deg, #2d1810, #4a2f16);
                padding: 30px;
                border-radius: 15px;
                text-align: center;
                max-width: 400px;
                border: 2px solid #ff6b35;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            `;
            
            modalContent.innerHTML = `
                <div style="color: #ff6b35; font-size: 3rem; margin-bottom: 15px;">üöÄ</div>
                <h2 style="color: #ffcc80; margin-bottom: 15px; font-size: 1.5rem;">Recurso PERSONALIZADO</h2>
                <p style="color: #e5e5e5; margin-bottom: 20px; line-height: 1.5;">
                    <strong>${feature}</strong> est√° dispon√≠vel apenas na vers√£o <strong>PERSONALIZADO</strong>.
                </p>
                <div style="background: rgba(255, 107, 53, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <p style="color: #ffcc80; margin: 0; font-size: 0.9rem;">
                        ‚ú® <strong>PERSONALIZADO inclui:</strong><br>
                        ‚Ä¢ Criar/editar categorias<br>
                        ‚Ä¢ Personalizar cores e logo<br>
                        ‚Ä¢ Configura√ß√µes avan√ßadas<br>
                        ‚Ä¢ Suporte priorit√°rio
                    </p>
                </div>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button id="upgradeBtn" style="
                        background: linear-gradient(135deg, #ff6b35, #e55a2b);
                        border: none;
                        padding: 12px 20px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    ">üöÄ FAZER UPGRADE</button>
                    <button id="closeUpgradeModal" style="
                        background: transparent;
                        color: #e5e5e5;
                        border: 1px solid #666;
                        padding: 12px 20px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    ">Fechar</button>
                </div>
            `;
            
            upgradeModal.appendChild(modalContent);
            document.body.appendChild(upgradeModal);
            
            // Event listeners
            document.getElementById('upgradeBtn').onclick = function() {
                alert('üöÄ Entre em contato para upgrade PERSONALIZADO!\n\nüìß Email: novosnegocios@geriah.com\nüì± WhatsApp: +55 11 91159-5028');
                document.body.removeChild(upgradeModal);
            };
            
            document.getElementById('closeUpgradeModal').onclick = function() {
                document.body.removeChild(upgradeModal);
            };
            
            upgradeModal.onclick = function(e) {
                if (e.target === upgradeModal) {
                    document.body.removeChild(upgradeModal);
                }
            };
        }

        // Fun√ß√£o para interceptar tentativas de edi√ß√£o de categoria
        function interceptCategoryEdit() {
            // Intercepta cliques nos headers das categorias principais
            document.addEventListener('click', function(e) {
                // Se estiver em modo de edi√ß√£o e clicar em header de categoria
                if (isEditMode && e.target.closest('.accordion-header')) {
                    const header = e.target.closest('.accordion-header');
                    const categoryName = header.textContent.trim().split('\n')[0].trim();
                    
                    // Verifica se √© uma categoria principal (n√£o subcategoria)
                    if (header.parentElement.classList.contains('accordion-item')) {
                        e.preventDefault();
                        e.stopPropagation();
                        showUpgradeAlert(`Editar categoria "${categoryName}"`);
            return false;
                    }
                }
                
                // Intercepta tentativas de adicionar nova categoria/subcategoria
                if (isEditMode && e.target.closest('.sub-accordion-header')) {
                    const subHeader = e.target.closest('.sub-accordion-header');
                    const subCategoryName = subHeader.textContent.trim().split('\n')[0].trim();
                    
                    // Se clicar com Ctrl ou Alt (indicando inten√ß√£o de adicionar)
                    if (e.ctrlKey || e.altKey) {
                        e.preventDefault();
                        e.stopPropagation();
                        showUpgradeAlert(`Adicionar nova subcategoria em "${subCategoryName}"`);
                        return false;
                    }
                }
            });
        }

        // Fun√ß√£o para adicionar indicadores visuais de upgrade
        function addUpgradeIndicators() {
            if (isEditMode) {
                // Adiciona indicadores nas categorias principais
                const categoryHeaders = document.querySelectorAll('.accordion-header');
                categoryHeaders.forEach(header => {
                    if (!header.querySelector('.PERSONALIZADO-indicator')) {
                        const indicator = document.createElement('span');
                        indicator.className = 'PERSONALIZADO-indicator';
                        indicator.innerHTML = 'üöÄ';
                        indicator.style.cssText = `
                            position: absolute;
                            right: 30px;
                            top: 50%;
                            transform: translateY(-50%);
                            background: linear-gradient(135deg, #ff6b35, #e55a2b);
                            border-radius: 10px;
                            font-size: 0.7rem;
                            cursor: pointer;
                            z-index: 100;
                        `;
                        indicator.title = 'Clique para upgrade PERSONALIZADO';
                        indicator.onclick = function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            showUpgradeAlert('Editar estrutura de categorias');
                        };
                        header.style.position = 'relative';
                        header.appendChild(indicator);
                    }
                });
            } else {
                // Remove indicadores quando sair do modo de edi√ß√£o
                document.querySelectorAll('.PERSONALIZADO-indicator').forEach(indicator => {
                    indicator.remove();
                });
            }
        }

        // ========== FUN√á√ïES PARA MEUS FAVORITOS (USER) ==========

        // Fun√ß√£o para carregar favoritos do localStorage (UNIFICADA)
        function loadUserFavorites() {
            const saved = localStorage.getItem('userFavorites');
            if (saved) {
                try {
                    userFavorites = JSON.parse(saved);
                } catch (e) {
                    console.error('Erro ao carregar favoritos:', e);
                    userFavorites = [];
                }
            }
            // Usar fun√ß√£o unificada
            updateFavoritesCounter();
            updateFavoritesDisplay();
            
            // Inicializar estado das estrelas ap√≥s carregar favoritos
            setTimeout(() => {
                initializeStarsState();
                observeStarsChanges(); // Ativar observer para mudan√ßas futuras
            }, 500); // Delay para garantir que o DOM est√° carregado
        }

        // Fun√ß√£o para salvar favoritos no localStorage
        function saveUserFavorites() {
            localStorage.setItem('userFavorites', JSON.stringify(userFavorites));
        }

        // Fun√ß√£o para renderizar a lista de favoritos COM SUBCATEGORIAS (SUBSTITU√çDA)
        function renderUserFavorites() {
            // Chamar nossa fun√ß√£o unificada
            updateFavoritesDisplay();
        }

        // Fun√ß√£o para abrir modal de adicionar favorito
        function openAddFavoriteModal() {
            // Sempre abre o modal - a verifica√ß√£o de limite ser√° feita ao salvar
            
            // Limpa campos
            document.getElementById('addFavoriteName').value = '';
            document.getElementById('addFavoriteUrl').value = '';
            document.getElementById('addFavoriteDescription').value = '';
            
            // Mostra modal
            document.getElementById('addFavoriteModal').classList.remove('hidden');
        }

        // Fun√ß√£o para fechar modal de adicionar favorito
        function closeAddFavoriteModal() {
            document.getElementById('addFavoriteModal').classList.add('hidden');
        }

        // Fun√ß√£o para salvar novo favorito (UNIFICADA)
        function saveNewFavorite() {
            const name = document.getElementById('addFavoriteName').value.trim();
            const url = document.getElementById('addFavoriteUrl').value.trim();
            const description = document.getElementById('addFavoriteDescription').value.trim();
            
            // Valida√ß√£o
            if (!name) {
                alert('Por favor, digite um nome para o favorito.');
                return;
            }
            
            if (!url) {
                alert('Por favor, digite uma URL v√°lida.');
                return;
            }
            
            // Adiciona https:// se necess√°rio
            let finalUrl = url;
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                finalUrl = 'https://' + url;
            }
            
            // Verifica limite - se atingido, mostra modal de substitui√ß√£o/upgrade
            if (userFavorites.length >= MAX_USER_FAVORITES) {
                // Armazenar dados do novo favorito temporariamente
                window.pendingNewFavorite = {
                    name: name,
                    type: 'manual',
                    url: finalUrl,
                    image: "https://api.iconify.design/tabler/world.svg?color=%23a8a8a8",
                    description: description,
                    dateAdded: new Date().toISOString()
                };
                
                // Fechar modal de adicionar favorito
                closeAddFavoriteModal();
                
                // Mostrar modal de substitui√ß√£o/upgrade
                showAddFavoriteReplacementModal(name);
                return;
            }
            
            // Adiciona favorito com estrutura UNIFICADA
            const newFavorite = {
                name: name,
                type: 'manual', // Identificar como manual
                url: finalUrl,
                image: "https://api.iconify.design/tabler/world.svg?color=%23a8a8a8", // √çcone padr√£o para manuais
                description: description,
                dateAdded: new Date().toISOString()
            };
            
            userFavorites.push(newFavorite);
            localStorage.setItem('userFavorites', JSON.stringify(userFavorites));
            
            // Usar a fun√ß√£o unificada de atualiza√ß√£o
            updateFavoritesCounter();
            updateFavoritesDisplay();
            closeAddFavoriteModal();
            
            // Feedback unificado
            showFavoriteToast(`"${name}" adicionado aos favoritos!`);
        }

        // Fun√ß√£o para deletar favorito (UNIFICADA)
        function deleteFavorite(index) {
            if (index >= 0 && index < userFavorites.length) {
                const favorite = userFavorites[index];
                if (confirm(`Remover "${favorite.name}" dos favoritos?`)) {
                    userFavorites.splice(index, 1);
                    localStorage.setItem('userFavorites', JSON.stringify(userFavorites));
                    updateFavoritesCounter();
                    updateFavoritesDisplay();
                    showFavoriteToast(`"${favorite.name}" removido dos favoritos!`);
                }
            }
        }

        // Event listeners para modal de favoritos
        document.addEventListener('DOMContentLoaded', function() {
            // Carregar favoritos na inicializa√ß√£o
            loadUserFavorites();
            
            // Garantir que as estrelas sejam inicializadas mesmo se j√° houver conte√∫do
            setTimeout(() => {
                initializeStarsState();
            }, 1000);
        });

        // ========== FIM DAS FUN  ES DE FAVORITOS ==========

        // Fun√ß√£o para mostrar modal de substitui√ß√£o/upgrade quando adicionar favorito manual
        function showAddFavoriteReplacementModal(newItemName) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: linear-gradient(135deg, #2d1810, #4a2f16);
                padding: 30px;
                border-radius: 15px;
                text-align: center;
                max-width: 500px;
                border: 2px solid #ff6b35;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            `;
            
            modalContent.innerHTML = `
                <div style="color: #ff6b35; font-size: 2.5rem; margin-bottom: 15px;">‚ö†Ô∏è</div>
                <h2 style="color: #ffcc80; margin-bottom: 15px; font-size: 1.4rem;">Limite de Favoritos Atingido!</h2>
                <p style="color: #e5e5e5; margin-bottom: 20px; line-height: 1.5;">
                    Voc√™ j√° tem ${MAX_USER_FAVORITES} favoritos. Para adicionar "<strong>${newItemName}</strong>", escolha uma op√ß√£o:
                </p>
                
                <div style="display: flex; flex-direction: column; gap: 15px; margin-bottom: 25px;">
                    <button id="replaceOption" style="
                        background: linear-gradient(135deg, #4CAF50, #45a049);
                        color: white;
                        border: none;
                        padding: 15px 20px;
                        border-radius: 8px;
                        cursor: pointer;
                        font-weight: bold;
                        font-size: 1rem;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                    ">
                        üîÑ Substituir um favorito existente
                    </button>
                    
                    <button id="upgradeOption" style="
                        background: linear-gradient(135deg, #ff6b35, #e55a2b);
                        color: white;
                        border: none;
                        padding: 15px 20px;
                        border-radius: 8px;
                        cursor: pointer;
                        font-weight: bold;
                        font-size: 1rem;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                    ">
                        üöÄ Fazer Upgrade para PERSONALIZADO
                    </button>
                </div>
                
                <button id="cancelAddFavorite" style="
                    background: transparent;
                    color: #999;
                    border: 1px solid #555;
                    padding: 10px 20px;
                    border-radius: 6px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                ">Cancelar</button>
            `;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            // Event listeners
            document.getElementById('replaceOption').onclick = function() {
                document.body.removeChild(modal);
                showReplaceFavoriteListModal(newItemName);
            };
            
            document.getElementById('upgradeOption').onclick = function() {
                document.body.removeChild(modal);
                showContactAlert();
            };
            
            document.getElementById('cancelAddFavorite').onclick = function() {
                window.pendingNewFavorite = null;
                document.body.removeChild(modal);
            };
            
            modal.onclick = function(e) {
                if (e.target === modal) {
                    window.pendingNewFavorite = null;
                    document.body.removeChild(modal);
                }
            };
        }
        
        // Fun√ß√£o para mostrar lista de favoritos para substitui√ß√£o
        function showReplaceFavoriteListModal(newItemName) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: linear-gradient(135deg, #2d1810, #4a2f16);
                padding: 30px;
                border-radius: 15px;
                text-align: center;
                max-width: 600px;
                max-height: 80vh;
                overflow-y: auto;
                border: 2px solid #4CAF50;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            `;
            
            // Separar favoritos por tipo
            const selecoes = userFavorites.filter(fav => fav.type === 'aplicativo');
            const adicoes = userFavorites.filter(fav => fav.type === 'manual');
            
            let favoritesList = '<div style="display: flex; flex-direction: column; gap: 15px;">';
            
            // Se√ß√£o Sele√ß√µes (estrelas)
            if (selecoes.length > 0) {
                favoritesList += `
                    <div style="margin-bottom: 10px;">
                        <h4 style="color: #4CAF50; margin: 0 0 10px 0; font-size: 1rem; display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 1.2rem;">‚≠ê</span> Sele√ß√£o (${selecoes.length})
                        </h4>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                `;
                selecoes.forEach((favorite, originalIndex) => {
                    const realIndex = userFavorites.findIndex(fav => fav === favorite);
                    favoritesList += `
                                            <button onclick="replaceFavoriteWithNew(${realIndex})" style="
                        background: rgba(76, 175, 80, 0.1);
                        border: 1px solid #4CAF50;
                        color: #e5e5e5;
                        padding: 12px 15px;
                        border-radius: 8px;
                        cursor: pointer;
                        text-align: left;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        gap: 10px;
                    " onmouseover="this.style.background='rgba(76, 175, 80, 0.2)'" 
                    onmouseout="this.style.background='rgba(76, 175, 80, 0.1)'">
                                                    <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.2rem; color: #FFD700;">‚≠ê</span>
                            <div>
                                <div style="font-weight: bold;">${favorite.name}</div>
                                <div style="font-size: 0.8rem; color: #4CAF50;">Navega√ß√£o interna</div>
                            </div>
                        </div>
                        <div style="background: #5e4b75; color: white; padding: 6px 12px; border-radius: 4px; font-size: 0.8rem; font-weight: bold;">
                            üîÑ Clique para Substituir
                        </div>
                        </button>
                    `;
                });
                favoritesList += '</div></div>';
            }
            
            // Se√ß√£o Adi√ß√µes (manuais)
            if (adicoes.length > 0) {
                favoritesList += `
                    <div>
                        <h4 style="color: #FF9800; margin: 0 0 10px 0; font-size: 1rem; display: flex; align-items: center; gap: 8px;">
                            <span style="font-size: 1.2rem;">‚ûï</span> Adi√ß√£o (${adicoes.length})
                        </h4>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                `;
                adicoes.forEach((favorite, originalIndex) => {
                    const realIndex = userFavorites.findIndex(fav => fav === favorite);
                    favoritesList += `
                                            <button onclick="replaceFavoriteWithNew(${realIndex})" style="
                        background: rgba(255, 152, 0, 0.1);
                        border: 1px solid #FF9800;
                        color: #e5e5e5;
                        padding: 12px 15px;
                        border-radius: 8px;
                        cursor: pointer;
                        text-align: left;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                        gap: 10px;
                    " onmouseover="this.style.background='rgba(255, 152, 0, 0.2)'" 
                    onmouseout="this.style.background='rgba(255, 152, 0, 0.1)'">
                                                    <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.2rem; color: #FF9800;">‚ûï</span>
                            <div>
                                <div style="font-weight: bold;">${favorite.name}</div>
                                <div style="font-size: 0.8rem; color: #FF9800;">URL externa</div>
                            </div>
                        </div>
                        <div style="background: #5e4b75; color: white; padding: 6px 12px; border-radius: 4px; font-size: 0.8rem; font-weight: bold;">
                            üîÑ Clique para Substituir
                        </div>
                        </button>
                    `;
                });
                favoritesList += '</div></div>';
            }
            
            favoritesList += '</div>';
            
            modalContent.innerHTML = `
                <div style="color: #4CAF50; font-size: 2rem; margin-bottom: 15px;">üîÑ</div>
                <h2 style="color: #ffcc80; margin-bottom: 15px; font-size: 1.4rem;">Substituir Favorito</h2>
                <p style="color: #e5e5e5; margin-bottom: 8px; line-height: 1.5;">
                    Clique no favorito que deseja substituir por "<strong style="color: #FFD700;">${newItemName}</strong>":
                </p>
                <p style="color: #999; margin-bottom: 20px; font-size: 0.9rem; font-style: italic;">
                    üí° A organiza√ß√£o abaixo reflete a ordem do seu menu de favoritos
                </p>
                
                ${favoritesList}
                
                <button id="cancelReplace" style="
                    background: transparent;
                    color: #999;
                    border: 1px solid #555;
                    padding: 10px 20px;
                    border-radius: 6px;
                    cursor: pointer;
                    margin-top: 20px;
                    transition: all 0.3s ease;
                ">Cancelar</button>
            `;
            
            modal.appendChild(modalContent);
            document.body.appendChild(modal);
            
            // Fun√ß√£o global para substituir favorito
            window.replaceFavoriteWithNew = function(index) {
                if (window.pendingNewFavorite && index >= 0 && index < userFavorites.length) {
                    const oldFavorite = userFavorites[index];
                    userFavorites[index] = window.pendingNewFavorite;
                    
                    localStorage.setItem('userFavorites', JSON.stringify(userFavorites));
                    updateFavoritesCounter();
                    updateFavoritesDisplay();
                    
                    showFavoriteToast(`"${oldFavorite.name}" substitu√≠do por "${window.pendingNewFavorite.name}"!`);
                    
                    window.pendingNewFavorite = null;
                    document.body.removeChild(modal);
                }
            };
            
            // Event listeners
            document.getElementById('cancelReplace').onclick = function() {
                window.pendingNewFavorite = null;
                document.body.removeChild(modal);
            };
            
            modal.onclick = function(e) {
                if (e.target === modal) {
                    window.pendingNewFavorite = null;
                    document.body.removeChild(modal);
                }
            };
        }

        // Disponibilizar as fun√ß√µes globalmente
        window.showAddFavoriteReplacementModal = showAddFavoriteReplacementModal;
        window.showReplaceFavoriteListModal = showReplaceFavoriteListModal;

        // Fun√ß√£o para mostrar aviso de contato para upgrade
        function showContactAlert() {
            const contactModal = document.createElement('div');
            contactModal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;
            
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: linear-gradient(135deg, #2d1810, #4a2f16);
                padding: 30px;
                border-radius: 15px;
                text-align: center;
                max-width: 450px;
                border: 2px solid #ff6b35;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            `;
            
            modalContent.innerHTML = `
                <div style="color: #ff6b35; font-size: 3rem; margin-bottom: 15px;">üöÄ</div>
                <h2 style="color: #ffcc80; margin-bottom: 15px; font-size: 1.5rem;">Upgrade para PERSONALIZADO</h2>
                <p style="color: #e5e5e5; margin-bottom: 20px; line-height: 1.5;">
                    Entre em contato conosco para fazer o upgrade e desbloquear todos os recursos!
                </p>
                <div style="background: rgba(255, 107, 53, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <p style="color: #ffcc80; margin: 0; font-size: 0.9rem; text-align: left;">
                        ‚ú® <strong>PERSONALIZADO inclui:</strong><br>
                        ‚Ä¢ Favoritos ilimitados<br>
                        ‚Ä¢ Criar/editar categorias personalizadas<br>
                        ‚Ä¢ Personalizar cores e logo<br>
                        ‚Ä¢ Configura√ß√µes avan√ßadas<br>
                        ‚Ä¢ Suporte priorit√°rio
                    </p>
                </div>
                <div style="background: rgba(76, 175, 80, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <p style="color: #81C784; margin: 0; font-size: 0.9rem;">
                        üìß <strong>Email:</strong> novosnegocios@geriah.com<br>
                        üì± <strong>WhatsApp:</strong> +55 11 91159-5028
                    </p>
                </div>
                <div style="display: flex; gap: 10px; justify-content: center;">
                    <button id="closeContactModal" style="
                        background: linear-gradient(135deg, #ff6b35, #e55a2b);
                        color: white;
                        border: none;
                        padding: 12px 20px;
                        border-radius: 6px;
                        cursor: pointer;
                        font-weight: bold;
                        transition: all 0.3s ease;
                    ">Entendi</button>
                </div>
            `;
            
            contactModal.appendChild(modalContent);
            document.body.appendChild(contactModal);
            
            // Event listeners
            document.getElementById('closeContactModal').onclick = function() {
                document.body.removeChild(contactModal);
            };
            
            contactModal.onclick = function(e) {
                if (e.target === contactModal) {
                    document.body.removeChild(contactModal);
                }
            };
        }
        
        // ========== FUNCIONALIDADE DE BUSCA DO MENU ==========
        
        // Vari√°vel global para armazenar √≠ndice de busca
        let menuSearchIndex = [];
        
        // Fun√ß√£o para criar √≠ndice de busca do menu
        function createMenuSearchIndex() {
            menuSearchIndex = [];
            
            // Indexar hierarquia completa do menu
            const sidebar = document.querySelector('aside');
            if (!sidebar) {
                console.log('‚ùå Sidebar n√£o encontrado');
                return;
            }
            
            // Processar cada categoria principal (accordions)
            const accordions = sidebar.querySelectorAll('.accordion-item');
            console.log(`üîç Encontrados ${accordions.length} accordions`);
            
            accordions.forEach(accordion => {
                const header = accordion.querySelector('.accordion-header');
                if (!header) return;
                
                const categoryName = cleanMenuText(header.textContent);
                
                // Indexar o cabe√ßalho da categoria principal
                if (categoryName.length > 2) {
                    menuSearchIndex.push({
                        name: categoryName,
                        originalText: header.textContent.trim(),
                        element: header,
                        path: [],
                        category: categoryName,
                        type: 'category'
                    });
                }
                
                // Processar conte√∫do da categoria
                const content = accordion.querySelector('.accordion-content');
                if (!content) return;
                
                // Buscar bot√µes diretos da categoria (sem subcategoria)
                const directButtons = content.querySelectorAll(':scope > button, :scope > a');
                directButtons.forEach(button => {
                    const itemName = cleanMenuText(button.textContent);
                    if (itemName.length > 2) {
                        menuSearchIndex.push({
                            name: itemName,
                            originalText: button.textContent.trim(),
                            element: button,
                            path: [categoryName],
                            category: categoryName,
                            type: 'item'
                        });
                    }
                });
                
                // Processar subcategorias (sub-accordions)
                const subAccordions = content.querySelectorAll('.sub-accordion-item');
                subAccordions.forEach(subAccordion => {
                    const subHeader = subAccordion.querySelector('.sub-accordion-header');
                    if (!subHeader) return;
                    
                    const subCategoryName = cleanMenuText(subHeader.textContent);
                    
                    // Indexar o cabe√ßalho da subcategoria
                    if (subCategoryName.length > 2) {
                        menuSearchIndex.push({
                            name: subCategoryName,
                            originalText: subHeader.textContent.trim(),
                            element: subHeader,
                            path: [categoryName],
                            category: categoryName,
                            subCategory: subCategoryName,
                            type: 'subcategory'
                        });
                    }
                    
                    // Processar itens da subcategoria
                    const subContent = subAccordion.querySelector('.sub-accordion-content');
                    if (subContent) {
                        // Processar bot√µes/links diretos da subcategoria
                        const subItems = subContent.querySelectorAll(':scope > button, :scope > a');
                        subItems.forEach(item => {
                            const itemName = cleanMenuText(item.textContent);
                            if (itemName.length > 2) {
                                menuSearchIndex.push({
                                    name: itemName,
                                    originalText: item.textContent.trim(),
                                    element: item,
                                    path: [categoryName, subCategoryName],
                                    category: categoryName,
                                    subCategory: subCategoryName,
                                    type: 'item'
                                });
                            }
                        });
                        
                        // Processar sub-sub-accordions (terceiro n√≠vel)
                        const subSubAccordions = subContent.querySelectorAll('.sub-sub-accordion-item');
                        subSubAccordions.forEach(subSubAccordion => {
                            const subSubHeader = subSubAccordion.querySelector('.sub-sub-accordion-header');
                            if (!subSubHeader) return;
                            
                            const subSubCategoryName = cleanMenuText(subSubHeader.textContent);
                            
                            // Indexar o cabe√ßalho da sub-subcategoria
                            if (subSubCategoryName.length > 2) {
                                menuSearchIndex.push({
                                    name: subSubCategoryName,
                                    originalText: subSubHeader.textContent.trim(),
                                    element: subSubHeader,
                                    path: [categoryName, subCategoryName],
                                    category: categoryName,
                                    subCategory: subCategoryName,
                                    subSubCategory: subSubCategoryName,
                                    type: 'subsubcategory'
                                });
                            }
                            
                            // Processar card-menu-items (cards no menu)
                            const subSubContent = subSubAccordion.querySelector('.sub-sub-accordion-content');
                            if (subSubContent) {
                                const cardItems = subSubContent.querySelectorAll('.card-menu-item');
                                cardItems.forEach(cardItem => {
                                    const cardName = cardItem.getAttribute('data-card-name') || cleanMenuText(cardItem.textContent);
                                    if (cardName.length > 2) {
                                        menuSearchIndex.push({
                                            name: cardName,
                                            originalText: cardItem.textContent.trim(),
                                            element: cardItem,
                                            path: [categoryName, subCategoryName, subSubCategoryName],
                                            category: categoryName,
                                            subCategory: subCategoryName,
                                            subSubCategory: subSubCategoryName,
                                            type: 'menu-card'
                                        });
                                    }
                                });
                            }
                        });
                    }
                });
            });
            
            // ADICIONAR CARDS REAIS - buscar apenas elementos que realmente existem
            indexRealCardsFromPage();
            
            console.log('üìã √çndice de busca criado:', menuSearchIndex.length, 'itens indexados');
            console.log('üîç Exemplo de itens indexados:', menuSearchIndex.slice(0, 5).map(item => ({
                name: item.name,
                path: item.path,
                type: item.type
            })));
        }
        
        // Fun√ß√£o para limpar texto do menu
        function cleanMenuText(text) {
            if (!text) return '';
            return text
                .replace(/[‚ñ∫‚ñº‚óè]/g, '') // Remove setas
                .replace(/[0-9]+\/[0-9]+/g, '') // Remove contadores como "1/5"
                .replace(/^\d+\s*/, '') // Remove n√∫meros no in√≠cio
                .replace(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu, '') // Remove emojis
                .replace(/\s+/g, ' ') // Normaliza espa√ßos
                .trim();
        }
        
                // Fun√ß√£o para indexar cards reais definidos no c√≥digo
        function indexRealCardsFromPage() {
            console.log('üîç Indexando cards reais definidos no c√≥digo...');
            
                        // Cards que N√ÉO est√£o no menu lateral (apenas apps externos)
            const realCards = [
                // 50+ | Maduros e Idosos - Cards reais do menu
                { name: "Longevidade", category: "50+ | Maduros e Idosos", menuPath: "50+ | Maduros e Idosos" },
                { name: "Analise CNIS", category: "50+ | Maduros e Idosos", menuPath: "50+ | Maduros e Idosos" },
                { name: "CNIS Suporte", category: "50+ | Maduros e Idosos", menuPath: "50+ | Maduros e Idosos" },
                
                // Ferramentas & Neg√≥cios - Cards reais do menu
                { name: "FNW - Formul√°rio Estrat√©gico", category: "Ferramentas & Neg√≥cios", menuPath: "FNW Assessoria" },
                { name: "FNW - ROI Maker", category: "Ferramentas & Neg√≥cios", menuPath: "FNW Assessoria" },
                { name: "Painel ETO", category: "Ferramentas & Neg√≥cios", menuPath: "FNW Assessoria" },
                { name: "MKT HUB", category: "Ferramentas & Neg√≥cios", menuPath: "FNW Assessoria" },
                
                // IA e Automa√ß√£o - Cards reais do menu
                { name: "IA Prompt Wizzard", category: "IA e Automa√ß√£o", menuPath: "Wizzards" },
                { name: "Chat Rosio Livia Geriah", category: "IA e Automa√ß√£o", menuPath: "Assistentes" },
                { name: "HumanIA", category: "IA e Automa√ß√£o", menuPath: "Assistentes" },
                { name: "London Lord", category: "IA e Automa√ß√£o", menuPath: "Assistentes" },
                
                // Parcerias - Cards reais do menu
                { name: "FNW Sinergias", category: "Parcerias", menuPath: "Parcerias" },
                { name: "IDEIA21", category: "Parcerias", menuPath: "Parcerias" },
                { name: "IPSOLON", category: "Parcerias", menuPath: "Parcerias" },
                { name: "Feito Por Voc√™", category: "Parcerias", menuPath: "Feito Por Voc√™" },
                
                // Entretenimento - REMOVIDOS: agora s√£o indexados como itens do menu
                // { name: "S√©ries", category: "Entretenimento" },
                // { name: "Curiosidades", category: "Entretenimento" },
                // { name: "Estilo de Vida", category: "Entretenimento" },
                // { name: "Not√≠cias de Europa", category: "Entretenimento" },
                // { name: "CNIS", category: "Entretenimento" },
                
                // Sa√∫de
                { name: "Nutri√ß√£o", category: "Sa√∫de" },
                { name: "Atividades", category: "Sa√∫de" },
                { name: "Conv√™nio", category: "Sa√∫de" },
                { name: "M√©dico", category: "Sa√∫de" },
                { name: "Farm√°cia", category: "Sa√∫de" },
                { name: "Hospital", category: "Sa√∫de" },
                
                // Comunica√ß√£o
                { name: "WhatsApp", category: "Comunica√ß√£o" },
                { name: "Telegram", category: "Comunica√ß√£o" },
                { name: "Email Gmail", category: "Comunica√ß√£o" },
                { name: "Google Meet", category: "Comunica√ß√£o" },
                { name: "Zoom", category: "Comunica√ß√£o" },
                { name: "WhatsApp Business", category: "Comunica√ß√£o" },
                
                // Finan√ßas
                { name: "Banco do Brasil", category: "Finan√ßas" },
                { name: "Bradesco", category: "Finan√ßas" },
                { name: "Caixa", category: "Finan√ßas" },
                { name: "Ita√∫", category: "Finan√ßas" },
                { name: "Nubank", category: "Finan√ßas" },
                { name: "Santander", category: "Finan√ßas" },
                
                // Lazer
                { name: "Netflix", category: "Lazer" },
                { name: "PlutoTV", category: "Lazer" },
                { name: "Prime Video", category: "Lazer" },
                { name: "Spotify", category: "Lazer" },
                { name: "YouTube", category: "Lazer" },
                
                // Culin√°ria
                { name: "iFood", category: "Culin√°ria e Gastronomia" },
                { name: "P√£o de A√ß√∫car", category: "Culin√°ria e Gastronomia" },
                
                // Transporte
                { name: "Uber", category: "Transporte" },
                { name: "99", category: "Transporte" }
            ];
            
            // Adicionar todos os cards reais ao √≠ndice
            realCards.forEach(card => {
                let pathArray = ['Cards', card.category];
                
                // Definir o caminho correto baseado na categoria
                if (card.category === '50+ | Maduros e Idosos') {
                    pathArray = ['Ferramentas & Neg√≥cios', '50+ | Maduros e Idosos'];
                } else if (card.category === 'Ferramentas & Neg√≥cios') {
                    pathArray = ['Ferramentas & Neg√≥cios', card.menuPath || 'FNW Assessoria'];
                } else if (card.category === 'IA e Automa√ß√£o') {
                    pathArray = ['Suporte - IA', card.menuPath || 'Assistentes'];
                } else if (card.category === 'Parcerias') {
                    pathArray = ['PARTICIPE', card.menuPath || 'Parcerias'];
                }
                
                menuSearchIndex.push({
                    name: card.name,
                    originalText: card.name,
                    element: null, // Ser√° encontrado dinamicamente quando necess√°rio
                    path: pathArray,
                    category: card.category,
                    menuPath: card.menuPath,
                    type: 'card'
                });
            });
            
            console.log(`üìö ${realCards.length} cards reais indexados das defini√ß√µes do c√≥digo`);
        }
        
                // Fun√ß√£o para realizar busca
        function searchMenu(query) {
            if (!query || query.length < 2) {
                return [];
            }

            const searchTerm = query.toLowerCase().trim();
            const results = [];

            menuSearchIndex.forEach(item => {
                const itemName = item.name.toLowerCase();
                const matchScore = calculateMatchScore(itemName, searchTerm);

                if (matchScore > 0) {
                    results.push({
                        ...item,
                        matchScore: matchScore,
                        highlightedName: highlightSearchTerm(item.name, searchTerm)
                    });
                }
            });

            // Ordenar por relev√¢ncia (score maior primeiro)
            return results.sort((a, b) => b.matchScore - a.matchScore);
        }
        
        // Fun√ß√£o para calcular score de match
        function calculateMatchScore(text, searchTerm) {
            const textLower = text.toLowerCase();
            const searchLower = searchTerm.toLowerCase();
            
            // Match exato tem score maior
            if (textLower === searchLower) return 100;
            
            // Come√ßa com o termo
            if (textLower.startsWith(searchLower)) return 80;
            
            // Cont√©m o termo exato
            if (textLower.includes(searchLower)) return 60;
            
            // Busca flex√≠vel - remover espa√ßos e s√≠mbolos para compara√ß√£o
            const textClean = textLower.replace(/[^a-z0-9]/g, '');
            const searchClean = searchLower.replace(/[^a-z0-9]/g, '');
            
            if (searchClean.length > 0 && textClean.includes(searchClean)) return 50;
            
            // Busca por palavras individuais
            const words = searchLower.split(/[\s\+\-\|]+/).filter(w => w.length > 0);
            let score = 0;
            words.forEach(word => {
                if (word.length > 1 && textLower.includes(word)) {
                    score += word.length;
                }
            });
            
            return score;
        }
        
        // Fun√ß√£o para destacar termo de busca
        function highlightSearchTerm(text, searchTerm) {
            // Escapar caracteres especiais do regex, mas preservar o significado na busca
            const escapedTerm = searchTerm.replace(/[.*?^${}()|[\]\\]/g, '\\$&').replace(/\\\+/g, '\\+');
            const regex = new RegExp(`(${escapedTerm})`, 'gi');
            return text.replace(regex, '<span class="search-highlight">$1</span>');
        }
        
        // Fun√ß√£o para exibir resultados de busca
        function displaySearchResults(results) {
            const searchResults = document.getElementById('searchResults');
            
            if (results.length === 0) {
                // Limpar destaques quando n√£o h√° resultados
                clearPreviousHighlights();
                searchResults.innerHTML = '<div class="search-no-results">Nenhum resultado encontrado</div>';
                searchResults.style.display = 'block';
                return;
            }
            
            // Expandir categorias e destacar itens no menu em tempo real
            expandAndHighlightItems(results);
            
            // Separar resultados por tipo
            const menuResults = results.filter(r => r.type !== 'card');
            const cardResults = results.filter(r => r.type === 'card');
            
            // Adicionar cabe√ßalho da lista
            let html = `
                <div style="padding: 12px 15px; border-bottom: 2px solid var(--color-primary-light, rgba(128, 76, 154, 0.3)); background: var(--color-primary-light, rgba(128, 76, 154, 0.1)); margin-bottom: 5px;">
                    <div style="color: var(--color-text-on-sidebar, #fff); font-weight: bold; font-size: 0.9em;">
                        üîç Resultados da Busca (${results.length})
                    </div>
                </div>
            `;
            
            // Mostrar resultados do Menu primeiro
            if (menuResults.length > 0) {
                html += `
                    <div style="padding: 8px 15px; background: rgba(255,255,255,0.05); margin: 5px 0; color: var(--color-text-on-sidebar, #fff);">
                        <strong>üìã Menu (${menuResults.length})</strong>
                    </div>
                `;
                
                menuResults.slice(0, 5).forEach((result, index) => {
                    // Construir caminho hier√°rquico completo
                    let pathText = '';
                    let typeIcon = '';
                    
                    if (result.type === 'category') {
                        pathText = 'Categoria Principal';
                        typeIcon = 'üìÅ';
                    } else if (result.type === 'subcategory') {
                        pathText = result.path.join(' ‚Ä∫ ');
                        typeIcon = 'üìÇ';
                    } else if (result.type === 'subsubcategory') {
                        pathText = result.path.join(' ‚Ä∫ ');
                        typeIcon = 'üìÇ';
                    } else if (result.type === 'menu-card') {
                        pathText = result.path.join(' ‚Ä∫ ');
                        typeIcon = 'üé¥';
                    } else if (result.type === 'item') {
                        pathText = result.path.join(' ‚Ä∫ ');
                        typeIcon = 'üìÑ';
                    } else {
                        // Fallback para itens antigos
                        pathText = result.path.length > 0 
                            ? result.path.join(' ‚Ä∫ ') 
                            : result.category;
                        typeIcon = 'üìã';
                    }
                    
                    html += `
                        <div class="search-result-item" data-card-name="${result.name}" data-result-index="menu-${index}">
                            <div class="search-result-name">${typeIcon} ${result.highlightedName}</div>
                            <div class="search-result-path">üìç ${pathText}</div>
                        </div>
                    `;
                });
            }
            
            // Mostrar Cards
            if (cardResults.length > 0) {
                html += `
                    <div style="padding: 8px 15px; background: rgba(255,255,255,0.05); margin: 5px 0; color: var(--color-text-on-sidebar, #fff);">
                        <strong>üìö Cards (${cardResults.length})</strong>
                    </div>
                `;
                
                cardResults.slice(0, 5).forEach((result, index) => {
                    html += `
                        <div class="search-result-item" data-card-name="${result.name}" data-result-index="card-${index}">
                            <div class="search-result-name">${result.highlightedName}</div>
                            <div class="search-result-path">üìö ${result.category}</div>
                        </div>
                    `;
                });
            }
            
            searchResults.innerHTML = html;
            searchResults.style.display = 'block';
            
            // Adicionar event listeners para cliques nos resultados
            const resultItems = searchResults.querySelectorAll('.search-result-item');
            resultItems.forEach(item => {
                item.addEventListener('click', function() {
                    const cardName = this.getAttribute('data-card-name');
                    const resultIndex = this.getAttribute('data-result-index');
                    
                    console.log(`üñ±Ô∏è Clique no resultado: "${cardName}" (${resultIndex})`);
                    
                    if (resultIndex.startsWith('card-')) {
                        // √â um card - navegar para o card
                        console.log('üéØ Navegando para CARD:', cardName);
                        navigateToCard(cardName);
                    } else {
                        // √â um item do menu - navegar para o item do menu
                        console.log('üìã Navegando para MENU:', cardName);
                        navigateToMenuItemByName(cardName);
                    }
                });
            });
        }
        
        // Fun√ß√£o para expandir categorias pai
        function expandParentCategories(element) {
            let parent = element.closest('.accordion-item');
            while (parent) {
                const header = parent.querySelector('.accordion-header');
                const content = parent.querySelector('.accordion-content');
                
                if (header && content && content.style.display === 'none') {
                    header.click(); // Simula clique para expandir
                }
                
                // Verificar se est√° dentro de um sub-acorde√£o
                const subParent = element.closest('.sub-accordion-item');
                if (subParent) {
                    const subHeader = subParent.querySelector('.sub-accordion-header');
                    const subContent = subParent.querySelector('.sub-accordion-content');
                    
                    if (subHeader && subContent && subContent.style.display === 'none') {
                        subHeader.click();
                    }
                }
                
                parent = parent.parentElement?.closest('.accordion-item');
            }
        }
        
        // Fun√ß√£o para destacar elemento temporariamente
        function highlightElement(element) {
            if (!element) return;
            
            console.log('‚ú® Destacando elemento:', element);
            
            // Remover destaque anterior
            const previousHighlighted = document.querySelector('.search-highlighted');
            if (previousHighlighted) {
                previousHighlighted.classList.remove('search-highlighted');
                previousHighlighted.style.cssText = '';
            }
            
            // Adicionar classe e estilo de destaque
            element.classList.add('search-highlighted');
            const originalStyle = element.style.cssText;
            
            element.style.cssText += `
                background: rgba(255, 215, 0, 0.2) !important;
                border: 3px solid #FFD700 !important;
                box-shadow: 0 0 15px rgba(255, 215, 0, 0.6) !important;
                transform: scale(1.02) !important;
                transition: all 0.3s ease !important;
                z-index: 1000 !important;
            `;
            
            // Remover destaque ap√≥s 5 segundos
            setTimeout(() => {
                element.classList.remove('search-highlighted');
                element.style.cssText = originalStyle;
            }, 5000);
        }
        
        // Fun√ß√£o para navegar at√© uma categoria espec√≠fica
        function navigateToCategory(categoryName) {
            console.log(`üìÇ Procurando categoria: "${categoryName}"`);
            
            // Buscar por headers de acorde√£o que contenham o nome da categoria
            const accordionHeaders = document.querySelectorAll('.accordion-header, .sub-accordion-header');
            
            for (let header of accordionHeaders) {
                const headerText = header.textContent?.trim();
                if (headerText && headerText.toLowerCase().includes(categoryName.toLowerCase())) {
                    console.log(`‚úÖ Categoria encontrada: ${headerText}`);
                    
                    // Expandir a categoria se estiver fechada
                    const content = header.parentElement?.querySelector('.accordion-content, .sub-accordion-content');
                    if (content && content.style.display === 'none') {
                        console.log('üîì Expandindo categoria...');
                        header.click();
                    }
                    
                    // Scroll at√© a categoria
                    header.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                    
                    // Destacar temporariamente o header
                    highlightElement(header);
                    
                    return true;
                }
            }
            
            console.log(`‚ùå Categoria "${categoryName}" n√£o encontrada no menu`);
            return false;
        }
        
        // Fun√ß√£o para navegar at√© um item do menu
        function navigateToMenuItem(menuElement) {
            console.log('üìã Navegando para item do menu:', menuElement);
            
            // Fechar resultados de busca
            const searchResults = document.getElementById('searchResults');
            if (searchResults) {
                searchResults.style.display = 'none';
            }
            
            // Expandir categorias pai se necess√°rio
            expandParentCategories(menuElement);
            
            // Navegar at√© o elemento
            setTimeout(() => {
                menuElement.scrollIntoView({
                    behavior: 'smooth',
                    block: 'center'
                });
                
                // Destacar o elemento
                highlightElement(menuElement);
            }, 500);
        }
        
        // Fun√ß√£o para navegar at√© um item do menu pelo nome
        function navigateToMenuItemByName(itemName) {
            console.log(`üìã Navegando para item do menu: "${itemName}"`);
            
            // Fechar resultados de busca
            const searchResults = document.getElementById('searchResults');
            if (searchResults) {
                searchResults.style.display = 'none';
            }
            
            // Encontrar o item no √≠ndice
            const menuItem = menuSearchIndex.find(item => item.name === itemName && item.type !== 'card');
            
            if (!menuItem) {
                console.log('‚ùå Item do menu n√£o encontrado no √≠ndice');
                return;
            }
            
            // Se √© uma categoria, expandir ela
            if (menuItem.type === 'category') {
                console.log('üìÅ Navegando para categoria principal');
                if (menuItem.element) {
                    const content = menuItem.element.parentElement.querySelector('.accordion-content');
                    if (content && content.style.display === 'none') {
                        menuItem.element.click();
                    }
                    menuItem.element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    highlightElement(menuItem.element);
                }
                return;
            }
            
            // Se √© uma subcategoria, expandir a categoria pai e depois ela
            if (menuItem.type === 'subcategory') {
                console.log('üìÇ Navegando para subcategoria');
                // Primeiro expandir a categoria pai
                const parentCategory = menuItem.category;
                const parentHeader = Array.from(document.querySelectorAll('.accordion-header')).find(header => 
                    cleanMenuText(header.textContent) === parentCategory
                );
                
                if (parentHeader) {
                    const parentContent = parentHeader.parentElement.querySelector('.accordion-content');
                    if (parentContent && parentContent.style.display === 'none') {
                        parentHeader.click();
                    }
                    
                    // Aguardar e depois clicar na subcategoria
                    setTimeout(() => {
                        if (menuItem.element) {
                            const subContent = menuItem.element.parentElement.querySelector('.sub-accordion-content');
                            if (subContent && subContent.style.display === 'none') {
                                menuItem.element.click();
                            }
                            menuItem.element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            highlightElement(menuItem.element);
                        }
                    }, 500);
                }
                return;
            }
            
            // Se √© um item final, expandir todas as categorias pai e navegar at√© ele
            if (menuItem.type === 'item') {
                console.log('üìÑ Navegando para item final');
                
                // Expandir categoria principal
                const parentCategory = menuItem.category;
                const parentHeader = Array.from(document.querySelectorAll('.accordion-header')).find(header => 
                    cleanMenuText(header.textContent) === parentCategory
                );
                
                if (parentHeader) {
                    const parentContent = parentHeader.parentElement.querySelector('.accordion-content');
                    if (parentContent && parentContent.style.display === 'none') {
                        parentHeader.click();
                    }
                    
                    // Se tem subcategoria, expandir ela tamb√©m
                    if (menuItem.subCategory) {
                        setTimeout(() => {
                            const subHeader = Array.from(document.querySelectorAll('.sub-accordion-header')).find(header => 
                                cleanMenuText(header.textContent) === menuItem.subCategory
                            );
                            
                            if (subHeader) {
                                const subContent = subHeader.parentElement.querySelector('.sub-accordion-content');
                                if (subContent && subContent.style.display === 'none') {
                                    subHeader.click();
                                }
                                
                                // Aguardar e navegar at√© o item final
                                setTimeout(() => {
                                    if (menuItem.element) {
                                        menuItem.element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                        highlightElement(menuItem.element);
                                    }
                                }, 500);
                            }
                        }, 500);
                    } else {
                        // Item direto da categoria (sem subcategoria)
                        setTimeout(() => {
                            if (menuItem.element) {
                                menuItem.element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                highlightElement(menuItem.element);
                            }
                        }, 500);
                    }
                }
            }
        }
        
        // Fun√ß√£o para navegar at√© um card
        function navigateToCard(cardName) {
            console.log(`üéØ NAVEGANDO PARA O CARD: "${cardName}"`);
            
            // Fechar resultados de busca
            const searchResults = document.getElementById('searchResults');
            if (searchResults) {
                searchResults.style.display = 'none';
            }
            
            // Encontrar informa√ß√µes do card
            const cardInfo = menuSearchIndex.find(item => item.name === cardName && item.type === 'card');
            
            if (!cardInfo) {
                console.log('‚ùå Card n√£o encontrado no √≠ndice');
                return;
            }
            
            console.log('üìã Info do card:', cardInfo);
            
            // Navegar para o menu correto baseado na categoria
            if (cardInfo.category === 'Ferramentas & Neg√≥cios') {
                console.log('üîß Navegando para Ferramentas & Neg√≥cios');
                navigateToFerramentasCard(cardInfo);
            } else if (cardInfo.category === 'IA e Automa√ß√£o') {
                console.log('ü§ñ Navegando para IA e Automa√ß√£o');
                navigateToIACard(cardInfo);
            } else if (cardInfo.category === 'Parcerias') {
                console.log('ü§ù Navegando para Parcerias');
                navigateToParceriasCard(cardInfo);
            } else if (cardInfo.category === '50+ | Maduros e Idosos') {
                console.log('üë¥ Navegando para 50+ | Maduros e Idosos');
                navigateToMadurosCard(cardInfo);
            } else {
                console.log(`üìÇ Navegando para categoria gen√©rica: ${cardInfo.category}`);
                // Para cards externos (Sa√∫de, Comunica√ß√£o, etc.), apenas mostrar onde est√£o
                alert(`Card "${cardName}" est√° na categoria "${cardInfo.category}". Este √© um app externo.`);
            }
        }
        
        // Navegar para cards de Ferramentas & Neg√≥cios
        function navigateToFerramentasCard(cardInfo) {
            console.log('üîß Procurando Ferramentas & Neg√≥cios...');
            const ferramentasButton = Array.from(document.querySelectorAll('.accordion-header')).find(header => 
                header.textContent.includes('Ferramentas & Neg√≥cios')
            );
            
            if (ferramentasButton) {
                console.log('‚úÖ Ferramentas & Neg√≥cios encontrado');
                // Expandir Ferramentas & Neg√≥cios
                const content = ferramentasButton.parentElement.querySelector('.accordion-content');
                if (content && content.style.display === 'none') {
                    console.log('üîì Expandindo Ferramentas & Neg√≥cios');
                    ferramentasButton.click();
                }
                
                // Aguardar e clicar no submenu
                setTimeout(() => {
                    console.log(`üîç Procurando submenu: "${cardInfo.menuPath}"`);
                    const submenuButton = Array.from(document.querySelectorAll('button')).find(btn => 
                        btn.textContent.trim() === cardInfo.menuPath
                    );
                    
                    if (submenuButton) {
                        console.log('‚úÖ Submenu encontrado, clicando...');
                        submenuButton.click();
                        
                        // Aguardar um pouco mais para garantir que o conte√∫do seja carregado
                        setTimeout(() => {
                            submenuButton.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            highlightElement(submenuButton);
                        }, 500);
                    } else {
                        console.log('‚ùå Submenu n√£o encontrado');
                    }
                }, 800);
            } else {
                console.log('‚ùå Ferramentas & Neg√≥cios n√£o encontrado');
            }
        }
        
        // Navegar para cards de IA e Automa√ß√£o
        function navigateToIACard(cardInfo) {
            const suporteButton = Array.from(document.querySelectorAll('.accordion-header')).find(header => 
                header.textContent.includes('Suporte - IA')
            );
            
            if (suporteButton) {
                // Expandir Suporte - IA
                const content = suporteButton.parentElement.querySelector('.accordion-content');
                if (content && content.style.display === 'none') {
                    suporteButton.click();
                }
                
                // Aguardar e clicar no submenu
                setTimeout(() => {
                    const submenuButton = Array.from(document.querySelectorAll('button')).find(btn => 
                        btn.textContent.trim() === cardInfo.menuPath
                    );
                    
                    if (submenuButton) {
                        submenuButton.click();
                        submenuButton.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        highlightElement(submenuButton);
                    }
                }, 500);
            }
        }
        
        // Navegar para cards de Parcerias
        function navigateToParceriasCard(cardInfo) {
            const participeButton = Array.from(document.querySelectorAll('.accordion-header')).find(header => 
                header.textContent.includes('PARTICIPE')
            );
            
            if (participeButton) {
                // Expandir PARTICIPE
                const content = participeButton.parentElement.querySelector('.accordion-content');
                if (content && content.style.display === 'none') {
                    participeButton.click();
                }
                
                // Aguardar e clicar no submenu
                setTimeout(() => {
                    const submenuButton = Array.from(document.querySelectorAll('button')).find(btn => 
                        btn.textContent.trim() === cardInfo.menuPath
                    );
                    
                    if (submenuButton) {
                        submenuButton.click();
                        submenuButton.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        highlightElement(submenuButton);
                    }
                }, 500);
            }
        }
        
        // Navegar para cards de 50+ | Maduros e Idosos
        function navigateToMadurosCard(cardInfo) {
            const ferramentasButton = Array.from(document.querySelectorAll('.accordion-header')).find(header => 
                header.textContent.includes('Ferramentas & Neg√≥cios')
            );
            
            if (ferramentasButton) {
                // Expandir Ferramentas & Neg√≥cios
                const content = ferramentasButton.parentElement.querySelector('.accordion-content');
                if (content && content.style.display === 'none') {
                    ferramentasButton.click();
                }
                
                // Aguardar e clicar em "50+ | Maduros e Idosos"
                setTimeout(() => {
                    const madurosButton = Array.from(document.querySelectorAll('button')).find(btn => 
                        btn.textContent.includes('50+ | Maduros e Idosos')
                    );
                    
                    if (madurosButton) {
                        madurosButton.click();
                        madurosButton.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        highlightElement(madurosButton);
                    }
                }, 500);
            }
        }
        
        // Fun√ß√£o para encontrar o card real na p√°gina
        function findRealCard(cardName) {
            console.log(`üîç Procurando card real: "${cardName}"`);
            
            // Buscar em diferentes seletores poss√≠veis, incluindo elementos vis√≠veis
            const selectors = [
                'a', 'button', '.card', '.course-card', '.resource-card', 
                '[class*="card"]', '.item', '[class*="item"]', 'li',
                '[onclick]', '.clickable', '.resource', '.content-item'
            ];
            
            for (let selector of selectors) {
                const elements = document.querySelectorAll(selector);
                for (let element of elements) {
                    const text = element.textContent?.trim() || '';
                    const title = element.title || element.getAttribute('data-title') || '';
                    
                    // Verificar se o elemento est√° vis√≠vel
                    const isVisible = element.offsetParent !== null;
                    
                    if (isVisible && (
                        text.toLowerCase().includes(cardName.toLowerCase()) ||
                        title.toLowerCase().includes(cardName.toLowerCase())
                    )) {
                        console.log(`‚úÖ Card encontrado: "${text}" (seletor: ${selector})`);
                        return element;
                    }
                }
            }
            
            console.log(`‚ùå Card "${cardName}" n√£o encontrado na p√°gina`);
            return null;
        }
        
        // Fun√ß√£o para destacar um card
        function highlightCard(cardElement) {
            // Remover destaque anterior
            const previousHighlighted = document.querySelector('.card-highlighted');
            if (previousHighlighted) {
                previousHighlighted.classList.remove('card-highlighted');
            }
            
            // Adicionar destaque ao card
            cardElement.classList.add('card-highlighted');
            
            // Adicionar efeito visual
            const originalStyle = cardElement.style.cssText;
            cardElement.style.cssText += `
                background: rgba(255, 215, 0, 0.2) !important;
                border: 3px solid #FFD700 !important;
                box-shadow: 0 0 20px rgba(255, 215, 0, 0.6) !important;
                transform: scale(1.02) !important;
                transition: all 0.3s ease !important;
                z-index: 1000 !important;
            `;
            
            // Remover destaque ap√≥s 5 segundos
            setTimeout(() => {
                cardElement.style.cssText = originalStyle;
                cardElement.classList.remove('card-highlighted');
            }, 5000);
        }
        

        
        // Vari√°vel para armazenar √∫ltimos resultados
        let lastSearchResults = [];
        

        
        // Event listeners para o campo de busca
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('menuSearchInput');
            const clearBtn = document.getElementById('clearSearchBtn');
            const searchResults = document.getElementById('searchResults');
            
            if (!searchInput) return;
            
            // Criar √≠ndice de busca ap√≥s carregar o DOM
            setTimeout(createMenuSearchIndex, 2000);
            
            // Event listener para digita√ß√£o
            searchInput.addEventListener('input', function() {
                const query = this.value.trim();
                
                if (query.length === 0) {
                    searchResults.style.display = 'none';
                    clearBtn.style.display = 'none';
                    clearPreviousHighlights(); // Limpar destaques quando n√£o h√° busca
                    return;
                }
                
                clearBtn.style.display = 'block';
                
                if (query.length < 2) {
                    clearPreviousHighlights(); // Limpar destaques para buscas muito curtas
                    searchResults.innerHTML = '<div class="search-no-results">Digite pelo menos 2 caracteres</div>';
                    searchResults.style.display = 'block';
                    return;
                }
                
                const results = searchMenu(query);
                lastSearchResults = results;
                displaySearchResults(results);
            });
            
            // Event listener para limpar busca
            clearBtn.addEventListener('click', function() {
                searchInput.value = '';
                searchResults.style.display = 'none';
                clearBtn.style.display = 'none';
                clearPreviousHighlights(); // Limpar destaques do menu
                searchInput.focus();
            });
            
            // Event listener para tecla ESC
            searchInput.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    this.value = '';
                    searchResults.style.display = 'none';
                    clearBtn.style.display = 'none';
                    this.blur();
                }
            });
            
            // Event listener para cliques nos resultados de busca
            searchResults.addEventListener('click', function(e) {
                const resultItem = e.target.closest('.search-result-item');
                if (resultItem) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const cardName = resultItem.getAttribute('data-card-name');
                    const isMenuItem = resultItem.getAttribute('data-result-index')?.startsWith('menu-');
                    
                    console.log('üñ±Ô∏è CLIQUE NO RESULTADO:', { cardName, isMenuItem });
                    
                    if (cardName) {
                        if (isMenuItem) {
                            // √â um item do menu
                            const menuElement = menuSearchIndex.find(item => item.name === cardName)?.element;
                            if (menuElement) {
                                console.log('üìã Navegando para item do menu');
                                navigateToMenuItem(menuElement);
                            }
                        } else {
                            // √â um card
                            console.log('üìö Navegando para card');
                            navigateToCard(cardName);
                        }
                    }
                }
            });
            
            // Fechar resultados ao clicar fora
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.menu-search-container') && !e.target.closest('#searchResults')) {
                    searchResults.style.display = 'none';
                }
            });
            
            // Recriar √≠ndice quando novos itens forem carregados
            const observer = new MutationObserver(function() {
                setTimeout(createMenuSearchIndex, 500);
            });
            
            const sidebar = document.querySelector('aside');
            if (sidebar) {
                observer.observe(sidebar, { 
                    childList: true, 
                    subtree: true 
                });
            }
        });
        
        // Fun√ß√£o para expandir categorias e destacar itens no menu em tempo real
        function expandAndHighlightItems(results) {
            // Limpar destaques anteriores
            clearPreviousHighlights();
            
            // Processar todos os resultados para destacar
            results.slice(0, 5).forEach(result => { // Processa os 5 primeiros resultados
                if (result.element) {
                    // L√≥gica especial para subcategorias de CEL APPS
                    if (result.type === 'cel-apps-subcategory' || result.type === 'cel-apps-item') {
                        console.log(`üîß Expandindo CEL APPS para: ${result.text}`);
                        
                        // 1. Expande CEL APPS principal
                        const celAppsHeader = document.querySelector('h2.accordion-header');
                        if (celAppsHeader && celAppsHeader.textContent.includes('CEL APPS')) {
                            const celAppsContent = celAppsHeader.nextElementSibling;
                            if (celAppsContent && celAppsContent.classList.contains('accordion-content')) {
                                if (celAppsContent.style.display === 'none') {
                                    celAppsHeader.click(); // Simula clique para expandir
                                }
                            }
                        }
                        
                        // 2. Se for um item de app espec√≠fico, tamb√©m expande a subcategoria
                        if (result.type === 'cel-apps-item' && result.subcategoryName) {
                            setTimeout(() => {
                                document.querySelectorAll('.sub-accordion-header').forEach(subHeader => {
                                    if (subHeader.textContent.includes(result.subcategoryName)) {
                                        const subContent = subHeader.nextElementSibling;
                                        if (subContent && subContent.classList.contains('sub-accordion-content')) {
                                            if (subContent.style.display === 'none') {
                                                subHeader.click(); // Simula clique para expandir
                                            }
                                        }
                                    }
                                });
                            }, 300);
                        }
                    }
                    
                    // Expandir categorias pai
                    expandParentCategoriesForSearch(result.element);
                    
                    // Destacar o item no menu (sem foco ainda)
                    result.element.classList.add('search-highlighted-item');
                } else if (result.type === 'card') {
                    // Para cards, expandir automaticamente o menu onde eles est√£o
                    expandMenuForCard(result);
                }
            });
            
            // Focar apenas no primeiro resultado (melhor match)
            if (results.length > 0) {
                if (results[0].element) {
                    setTimeout(() => {
                        results[0].element.scrollIntoView({
                            behavior: 'smooth',
                            block: 'center'
                        });
                    }, 800); // Delay maior para permitir que todas as categorias se expandam
                } else if (results[0].type === 'card') {
                    // Para cards, navegar automaticamente
                    setTimeout(() => {
                        navigateToCardAutomatically(results[0]);
                    }, 500);
                }
            }
        }
        
        // Fun√ß√£o para expandir menu onde o card est√° localizado
        function expandMenuForCard(cardInfo) {
            console.log(`üéØ Expandindo menu para card: ${cardInfo.name}`);
            
            if (cardInfo.category === 'Ferramentas & Neg√≥cios') {
                const ferramentasButton = Array.from(document.querySelectorAll('.accordion-header')).find(header => 
                    header.textContent.includes('Ferramentas & Neg√≥cios')
                );
                
                if (ferramentasButton) {
                    const content = ferramentasButton.parentElement.querySelector('.accordion-content');
                    if (content && content.style.display === 'none') {
                        ferramentasButton.click();
                        
                        // Expandir submenu tamb√©m
                        setTimeout(() => {
                            const submenuButton = Array.from(document.querySelectorAll('button')).find(btn => 
                                btn.textContent.trim() === cardInfo.menuPath
                            );
                            if (submenuButton) {
                                submenuButton.classList.add('search-highlighted-item');
                            }
                        }, 300);
                    }
                }
            } else if (cardInfo.category === 'IA e Automa√ß√£o') {
                const suporteButton = Array.from(document.querySelectorAll('.accordion-header')).find(header => 
                    header.textContent.includes('Suporte - IA')
                );
                
                if (suporteButton) {
                    const content = suporteButton.parentElement.querySelector('.accordion-content');
                    if (content && content.style.display === 'none') {
                        suporteButton.click();
                    }
                }
            } else if (cardInfo.category === 'Parcerias') {
                const participeButton = Array.from(document.querySelectorAll('.accordion-header')).find(header => 
                    header.textContent.includes('PARTICIPE')
                );
                
                if (participeButton) {
                    const content = participeButton.parentElement.querySelector('.accordion-content');
                    if (content && content.style.display === 'none') {
                        participeButton.click();
                    }
                }
            }
        }
        
        // Fun√ß√£o para navegar automaticamente para card (sem clique)
        function navigateToCardAutomatically(cardInfo) {
            console.log(`üéØ Navega√ß√£o autom√°tica para card: ${cardInfo.name}`);
            
            if (cardInfo.category === 'Ferramentas & Neg√≥cios') {
                const submenuButton = Array.from(document.querySelectorAll('button')).find(btn => 
                    btn.textContent.trim() === cardInfo.menuPath
                );
                if (submenuButton) {
                    submenuButton.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    submenuButton.classList.add('search-highlighted-item');
                }
            }
        }
        
        // Fun√ß√£o para expandir categorias pai (para busca)
        function expandParentCategoriesForSearch(element) {
            // Expandir acorde√£o principal se necess√°rio
            let parent = element.closest('.accordion-item');
            if (parent) {
                const header = parent.querySelector('.accordion-header');
                const content = parent.querySelector('.accordion-content');
                
                if (header && content && content.style.display === 'none') {
                    header.click(); // Simula clique para expandir
                }
            }
            
            // Expandir sub-acorde√£o se necess√°rio
            let subParent = element.closest('.sub-accordion-item');
            if (subParent) {
                const subHeader = subParent.querySelector('.sub-accordion-header');
                const subContent = subParent.querySelector('.sub-accordion-content');
                
                if (subHeader && subContent && subContent.style.display === 'none') {
                    subHeader.click(); // Simula clique para expandir
                }
            }
            
            // Expandir sub-sub-acorde√£o se necess√°rio (terceiro n√≠vel)
            let subSubParent = element.closest('.sub-sub-accordion-item');
            if (subSubParent) {
                const subSubHeader = subSubParent.querySelector('.sub-sub-accordion-header');
                const subSubContent = subSubParent.querySelector('.sub-sub-accordion-content');
                
                if (subSubHeader && subSubContent && subSubContent.style.display === 'none') {
                    subSubHeader.click(); // Simula clique para expandir
                }
            }
        }
        
        // Fun√ß√£o para destacar elemento no menu
        function highlightElementInMenu(element) {
            element.classList.add('search-highlighted-item');
        }
        
        // Fun√ß√£o para limpar destaques anteriores
        function clearPreviousHighlights() {
            const highlightedItems = document.querySelectorAll('.search-highlighted-item');
            highlightedItems.forEach(item => {
                item.classList.remove('search-highlighted-item');
            });
        }
        
        // Fun√ß√£o para navegar at√© item clicado na lista de resultados
        function navigateToMenuItemFromList(index) {
            if (index >= 0 && index < lastSearchResults.length) {
                const result = lastSearchResults[index];
                
                if (result && result.element) {
                    // Feedback visual no item clicado da lista
                    const clickedListItem = document.querySelector(`[data-result-index="${index}"]`);
                    if (clickedListItem) {
                        clickedListItem.classList.add('clicked');
                        setTimeout(() => clickedListItem.classList.remove('clicked'), 300);
                    }
                    
                    // Limpar destaques anteriores primeiro
                    clearPreviousHighlights();
                    
                    // Expandir categorias pai se necess√°rio
                    expandParentCategoriesForSearch(result.element);
                    
                    // Destacar apenas este item
                    result.element.classList.add('search-highlighted-item');
                    
                    // Fazer scroll suave at√© o elemento ap√≥s delay
                    setTimeout(() => {
                        result.element.scrollIntoView({
                            behavior: 'smooth',
                            block: 'center'
                        });
                    }, 400);
                    
                    // Feedback visual de que foi clicado
                    console.log(`üéØ Navegando para: ${result.name} em ${result.path.join(' ‚Ä∫ ')}`);
                }
            }
        }
        
                // =====================================================
        // IMPLEMENTA√á√ÉO DE BUSCA UNIVERSAL (DESABILITADA TEMPORARIAMENTE)
        // =====================================================
        
        /*
        // Substitui a fun√ß√£o original por uma busca universal
        const originalCreateMenuSearchIndex = createMenuSearchIndex;
        const originalSearchMenu = searchMenu;
        const originalDisplaySearchResults = displaySearchResults;
        
                // NOVA ABORDAGEM: Busca LIMPA e SIMPLES
        function createUniversalSearchIndex() {
            menuSearchIndex = [];
            console.log('üîç Criando √≠ndice LIMPO E SIMPLES...');
            
            // LISTA MANUAL dos itens reais do Menu (para garantir que s√£o limpos)
            const menuItemsManual = [
                { name: 'WhatsApp', element: null, type: 'menu' },
                { name: 'Telegram', element: null, type: 'menu' },
                { name: 'Instagram', element: null, type: 'menu' },
                { name: 'Facebook', element: null, type: 'menu' },
                { name: 'YouTube', element: null, type: 'menu' },
                { name: 'TikTok', element: null, type: 'menu' },
                { name: 'Gmail', element: null, type: 'menu' },
                { name: 'Google Meet', element: null, type: 'menu' },
                { name: 'Zoom', element: null, type: 'menu' },
                { name: 'Netflix', element: null, type: 'menu' },
                { name: 'Prime Video', element: null, type: 'menu' },
                { name: 'Spotify', element: null, type: 'menu' },
                { name: 'PlutoTV', element: null, type: 'menu' },
                { name: 'AudioLivros', element: null, type: 'menu' },
                { name: 'Artesanato', element: null, type: 'menu' },
                { name: 'Culin√°ria', element: null, type: 'menu' },
                { name: 'Eventos', element: null, type: 'menu' },
                { name: 'Turismo', element: null, type: 'menu' },
                { name: 'Hotelaria', element: null, type: 'menu' },
                { name: 'Direito', element: null, type: 'menu' },
                { name: 'Fisioterapia', element: null, type: 'menu' },
                { name: 'Fotografia', element: null, type: 'menu' },
                { name: 'Inform√°tica', element: null, type: 'menu' },
                { name: 'M√∫sica', element: null, type: 'menu' },
                { name: 'Instrumentos', element: null, type: 'menu' },
                { name: 'Suporte', element: null, type: 'menu' },
                { name: 'WhatsApp Business', element: null, type: 'menu' },
                { name: 'Feito Por Voc√™', element: null, type: 'menu' },
                { name: 'MEUS FAVORITOS', element: null, type: 'menu' }
            ];
            
            // ADICIONAR itens limpos do menu manual
            menuItemsManual.forEach(item => {
                menuSearchIndex.push({
                    name: item.name,
                    originalText: item.name,
                    element: findElementByText(item.name),
                    path: ['Menu'],
                    category: 'Menu',
                    type: 'menu',
                    section: 'Menu Lateral',
                    index: menuSearchIndex.length
                });
            });
            
            // CARDS REAIS - Buscar por elementos reais na √°rea principal
            const cardElements = document.querySelectorAll('#mainContent .card, #coursesContainer .card, .course-card, .resource-card');
            cardElements.forEach(card => {
                const text = getOriginalCardText(card);
                if (text && text.length > 2) {
                    menuSearchIndex.push({
                        name: text,
                        originalText: text,
                        element: card,
                        path: ['Cards'],
                        category: 'Cards',
                        type: 'card',
                        section: '√Årea de Cards',
                        index: menuSearchIndex.length
                    });
                }
            });
            
            // ADICIONAR CARDS CONHECIDOS (se n√£o encontrou cards reais)
            addKnownCards();
            
            const stats = {
                menu: menuSearchIndex.filter(item => item.type === 'menu').length,
                card: menuSearchIndex.filter(item => item.type === 'card').length
            };
            
            console.log('üìä √çndice LIMPO:', menuSearchIndex.length, 'itens');
            console.log('üìà Menu:', stats.menu, '| Cards:', stats.card);
            console.log('üßπ SEM LIXO T√âCNICO - Apenas conte√∫do real!');
        }
            
            // 2. CARDS REAIS - Apenas elementos com classes espec√≠ficas de card
            const realCards = document.querySelectorAll('.card, .course-card, .resource-card, [class*="card"]');
            realCards.forEach(card => {
                const titleElement = card.querySelector('h1, h2, h3, h4, .title, [class*="title"]') || card;
                const text = titleElement.textContent?.trim();
                
                // FILTRO ULTRA RIGOROSO para cards
                if (text && text.length > 2 && 
                    !text.includes('partial') && 
                    !text.includes('highlight') &&
                    !text.includes('t-partial') &&
                    !text.includes('">')) {
                    
                    const cleanText = ultraCleanText(text);
                    if (cleanText && cleanText.length > 2) {
                        menuSearchIndex.push({
                            name: cleanText,
                            originalText: text,
                            element: card,
                            path: ['Cards'],
                            category: 'Cards',
                            type: 'card',
                            section: '√Årea de Cards',
                            index: menuSearchIndex.length
                        });
                    }
                }
            });
            
            // 3. CABE√áALHOS IMPORTANTES
            const headers = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
            headers.forEach(header => {
                const text = header.textContent?.trim();
                
                // FILTRO ULTRA RIGOROSO para headers
                if (text && text.length > 2 && 
                    !text.includes('partial') && 
                    !text.includes('highlight') &&
                    !text.includes('t-partial') &&
                    !text.includes('">') &&
                    !header.closest('.search-results')) {
                    
                    const cleanText = ultraCleanText(text);
                    if (cleanText && cleanText.length > 2) {
                        menuSearchIndex.push({
                            name: cleanText,
                            originalText: text,
                            element: header,
                            path: ['Cabe√ßalhos'],
                            category: 'Headers',
                            type: 'header',
                            section: 'Cabe√ßalhos',
                            index: menuSearchIndex.length
                        });
                    }
                }
            });
            
            // 4. BOT√ïES IMPORTANTES (fora do menu)
            const importantButtons = document.querySelectorAll('.main-content button, #mainContent button');
            importantButtons.forEach(button => {
                const text = button.textContent?.trim();
                
                // FILTRO ULTRA RIGOROSO para buttons  
                if (text && text.length > 2 && 
                    !text.includes('partial') && 
                    !text.includes('highlight') &&
                    !text.includes('t-partial') &&
                    !text.includes('Debug') &&
                    !text.includes('">')) {
                    
                    const cleanText = ultraCleanText(text);
                    if (cleanText && cleanText.length > 2) {
                        menuSearchIndex.push({
                            name: cleanText,
                            originalText: text,
                            element: button,
                            path: ['Bot√µes'],
                            category: 'Buttons',
                            type: 'button',
                            section: '√Årea Principal',
                            index: menuSearchIndex.length
                        });
                    }
                }
            });
            
            const stats = {
                menu: menuSearchIndex.filter(item => item.type === 'menu').length,
                card: menuSearchIndex.filter(item => item.type === 'card').length,
                header: menuSearchIndex.filter(item => item.type === 'header').length,
                button: menuSearchIndex.filter(item => item.type === 'button').length
            };
            
            console.log('üìä √çndice FOCADO:', menuSearchIndex.length, 'itens');
            console.log('üìà Por tipo:', stats);
        }
        
        // Fun√ß√£o para encontrar elemento por texto limpo
        function findElementByText(searchText) {
            const elements = document.querySelectorAll('aside button, aside a');
            for (let element of elements) {
                const text = element.textContent?.trim();
                if (text && text.includes(searchText)) {
                    return element;
                }
            }
            return null;
        }
        
        // Fun√ß√£o para obter texto original do card (sem highlights)
        function getOriginalCardText(cardElement) {
            // Tentar obter texto limpo de diferentes formas
            const titleSelectors = ['h1', 'h2', 'h3', 'h4', 'h5', '.title', '.card-title', '[class*="title"]'];
            
            for (let selector of titleSelectors) {
                const titleElement = cardElement.querySelector(selector);
                if (titleElement) {
                    let text = titleElement.textContent?.trim();
                    if (text && !text.includes('partial') && !text.includes('highlight')) {
                        return text;
                    }
                }
            }
            
            // Se n√£o encontrou t√≠tulo, usar o texto do card (limitado)
            let cardText = cardElement.textContent?.trim();
            if (cardText && cardText.length < 100 && !cardText.includes('partial')) {
                return cardText;
            }
            
            return null;
        }
        
        // Lista de cards conhecidos (quando n√£o conseguir detectar automaticamente)
        function addKnownCards() {
            const knownCards = [
                'Or√ßamento Digital',
                'Netflix Mobile', 
                'Projeto Marketing',
                'Email Marketing Pro',
                'WhatsApp Business',
                'Telegram Premium',
                'Longevidade',
                'Sa√∫de e Bem-estar',
                'Culin√°ria Saud√°vel',
                'Artesanato Criativo'
            ];
            
            knownCards.forEach(cardName => {
                menuSearchIndex.push({
                    name: cardName,
                    originalText: cardName,
                    element: null, // Ser√° procurado quando necess√°rio
                    path: ['Cards'],
                    category: 'Cards',
                    type: 'card',
                    section: '√Årea de Cards',
                    index: menuSearchIndex.length
                });
            });
        }
        
        function shouldSkipForUniversalSearch(element) {
            const style = getComputedStyle(element);
            if (style.display === 'none' || style.visibility === 'hidden') return true;
            
            // Tags que nunca devem ser indexadas
            if (['SCRIPT', 'STYLE', 'META', 'LINK', 'TITLE', 'HEAD', 'NOSCRIPT'].includes(element.tagName)) return true;
            
            // FILTRO SUPER RIGOROSO - Texto contendo lixo t√©cnico
            const text = element.textContent?.trim() || '';
            
            // Se cont√©m qualquer coisa relacionada a highlight ou sistema interno
            if (text.includes('partial') || 
                text.includes('highlight') ||
                text.includes('search-') ||
                text.includes('t-partial') ||
                text.includes('Evt-partial') ||
                text.includes('ento,') ||
                text.includes('Ett-partial') ||
                text.includes('m√≥vt-partial') ||
                text.includes('Hott-partial') ||
                text.includes('Itt-partial') ||
                text.includes('Estt-partial') ||
                text.includes('"><') ||
                text.includes('">') ||
                text.includes('addevent') ||
                text.includes('::')) return true;
            
            // Elementos de busca e sistema
            if (element.id === 'searchInput' || 
                element.id === 'menuSearchInput' ||
                element.classList.contains('search-results') ||
                element.classList.contains('search-highlight') ||
                element.classList.contains('search-highlight-partial') ||
                element.id === 'searchResults') return true;
            
            // Elementos com classes t√©cnicas
            const elementClasses = element.className || '';
            if (elementClasses.includes('search') || 
                elementClasses.includes('highlight') ||
                elementClasses.includes('partial')) return true;
            
            // IDs t√©cnicos
            const elementId = element.id || '';
            if (elementId.includes('search') || elementId.includes('debug') || elementId.includes('btn')) return true;
            
            // Bot√µes de debug e sistema
            const debugButtons = ['Debug', 'Reindexar', 'Eto', 'Limpar', 'Testar', 'üêõ Debug Busca'];
            if (debugButtons.includes(text)) return true;
            
            // Texto muito pequeno, muito grande ou s√≥ n√∫meros/s√≠mbolos
            if (text.length < 3 || text.length > 100) return true; // Reduzindo o m√°ximo para 100
            if (/^\s*$/.test(text) || /^[\d\s\-_\.\/\(\)\[\]]+$/.test(text)) return true;
            
            // Texto que parece concatena√ß√£o de m√∫ltiplos elementos
            const wordsCount = text.split(/\s+/).length;
            if (wordsCount > 15) return true; // Se tem mais de 15 palavras, provavelmente √© concatena√ß√£o
            
            // Texto que cont√©m m√∫ltiplos nomes juntos (sem espa√ßos adequados)
            if (text.match(/[A-Z][a-z]+[A-Z][a-z]+[A-Z]/)) return true; // Ex: "WhatsAppTelegramEmail"
            
            // Se √© filho direto de elemento t√©cnico, pular
            if (element.closest('.search-results') || 
                element.closest('[class*="search"]') ||
                element.closest('[class*="highlight"]') ||
                element.closest('[id*="search"]')) return true;
            
            return false;
        }
        
                function getCleanUniversalText(element) {
            // Primeiro tentar obter apenas texto direto do elemento
            let text = '';
            for (let node of element.childNodes) {
                if (node.nodeType === Node.TEXT_NODE) {
                    text += node.textContent.trim() + ' ';
                }
            }
            
            // Se n√£o tem texto direto, pegar textContent (mas com cuidado)
            if (!text.trim()) {
                text = element.textContent?.trim() || '';
                
                // Limitar tamanho para evitar textos gigantes
                if (text.length > 100) text = text.substring(0, 100) + '...';
            }
            
            // Limpeza rigorosa
            text = text.replace(/\s+/g, ' ')                    // M√∫ltiplos espa√ßos
                    .replace(/[‚ñ∫‚ñº‚óè]/g, '')                    // S√≠mbolos de menu
                    .replace(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/gu, '') // Emojis
                    .replace(/[0-9]+\/[0-9]+/g, '')          // Contadores como "1/5"
                    .replace(/^\d+$/, '')                    // Apenas n√∫meros
                    .replace(/^[\[\](){}]+$/, '')            // Apenas s√≠mbolos
                    .trim();
            
            // Filtros adicionais para evitar lixo t√©cnico
            if (text.includes('highlight-partial') || 
                text.includes('search-') ||
                text.includes('addevent') ||
                text.includes('::') ||
                text.match(/^[a-z\-_]+$/i) ||               // Apenas nomes de classes/IDs
                text.match(/^\.[a-z\-_]+/i) ||              // Classes CSS
                text.match(/^#[a-z\-_]+/i)) {               // IDs CSS
                return '';
            }
            
            return text;
        }
        
        function categorizeForUniversalSearch(element) {
            if (element.closest('aside') || element.closest('.sidebar')) return 'menu';
            if (element.classList.contains('card') || element.closest('.card')) return 'card';
            if (['H1', 'H2', 'H3', 'H4', 'H5', 'H6'].includes(element.tagName)) return 'header';
            if (element.tagName === 'BUTTON' || element.classList.contains('btn')) return 'button';
            if (element.closest('.main-content') || element.closest('#mainContent')) return 'content';
            return 'other';
        }
        
        function getLocationForUniversalSearch(element) {
            let section = 'Desconhecido';
            let category = 'Outros';
            let path = [];
            
            if (element.closest('aside')) {
                section = 'Menu Lateral';
                category = 'Menu';
                const accordionHeader = element.closest('.accordion-content')?.previousElementSibling;
                if (accordionHeader) {
                    const categoryName = accordionHeader.textContent?.replace(/[‚ñ∫‚ñº‚óè0-9]/g, '').trim();
                    if (categoryName) path.push(categoryName);
                }
            } else if (element.closest('header')) {
                section = 'Cabe√ßalho';
                category = 'Header';
            } else if (element.closest('#mainContent')) {
                section = '√Årea Principal';
                category = 'Conte√∫do';
            }
            
            return { section, category, path };
        }
        
        function universalFlexibleSearch(query) {
            if (!query || query.length < 1) return [];
            
            const searchTerm = query.toLowerCase().trim();
            const results = [];
            
            menuSearchIndex.forEach(item => {
                const itemName = item.name.toLowerCase();
                const matchScore = calculateUniversalScore(itemName, searchTerm);
                
                if (matchScore > 0) {
                    results.push({
                        ...item,
                        matchScore: matchScore,
                        highlightedName: highlightUniversalTerm(item.name, searchTerm)
                    });
                }
            });
            
            return results.sort((a, b) => {
                if (b.matchScore !== a.matchScore) return b.matchScore - a.matchScore;
                const typePriority = { menu: 5, card: 4, content: 3, header: 2, button: 1 };
                return (typePriority[b.type] || 0) - (typePriority[a.type] || 0);
            });
        }
        
        function calculateUniversalScore(text, searchTerm) {
            if (text === searchTerm) return 100;
            if (text.startsWith(searchTerm)) return 90;
            if (text.endsWith(searchTerm)) return 80;
            if (text.includes(searchTerm)) return 70;
            
            let score = 0;
            let consecutiveMatches = 0;
            let lastMatchIndex = -1;
            
            for (let i = 0; i < searchTerm.length; i++) {
                const char = searchTerm[i];
                const foundIndex = text.indexOf(char, lastMatchIndex + 1);
                
                if (foundIndex !== -1) {
                    if (foundIndex === lastMatchIndex + 1) {
                        consecutiveMatches++;
                        score += consecutiveMatches * 2;
                    } else {
                        consecutiveMatches = 1;
                        score += 1;
                    }
                    lastMatchIndex = foundIndex;
                }
            }
            
            const words = searchTerm.split(' ');
            words.forEach(word => {
                if (word.length >= 1 && text.includes(word)) {
                    score += word.length * 3;
                }
            });
            
            return score;
        }
        
        function highlightUniversalTerm(text, searchTerm) {
            try {
                let regex = new RegExp(`(${searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
                let highlighted = text.replace(regex, '<span class="search-highlight">$1</span>');
                
                if (highlighted === text) {
                    const chars = searchTerm.toLowerCase().split('');
                    chars.forEach(char => {
                        if (char.trim()) {
                            const charRegex = new RegExp(`(${char.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')})`, 'gi');
                            highlighted = highlighted.replace(charRegex, '<span class="search-highlight-partial">$1</span>');
                        }
                    });
                }
                
                return highlighted;
            } catch (e) {
                return text;
            }
        }
        
        function displayUniversalResults(results) {
            const searchResults = document.getElementById('searchResults');
            
            if (results.length === 0) {
                clearPreviousHighlights();
                searchResults.innerHTML = '<div class="search-no-results">‚ùå Nenhum resultado encontrado</div>';
                searchResults.style.display = 'block';
                return;
            }
            
            const groupedResults = {
                menu: results.filter(r => r.type === 'menu'),
                card: results.filter(r => r.type === 'card'),
                content: results.filter(r => r.type === 'content'),
                header: results.filter(r => r.type === 'header'),
                button: results.filter(r => r.type === 'button'),
                other: results.filter(r => r.type === 'other')
            };
            
            expandAndHighlightItems(results);
            
            let html = `
                <div style="padding: 12px 15px; border-bottom: 2px solid var(--color-primary-light, rgba(128, 76, 154, 0.3)); background: var(--color-primary-light, rgba(128, 76, 154, 0.1)); margin-bottom: 5px;">
                    <div style="color: var(--color-text-on-sidebar, #fff); font-weight: bold; font-size: 0.9em;">
                        üîç Busca Universal (${results.length} resultados)
                    </div>
                </div>
            `;
            
            let resultIndex = 0;
            const typeIcons = { menu: 'üìã', card: 'üìö', content: 'üìÑ', header: 'üì∞', button: 'üîò', other: 'üìå' };
            const typeLabels = { menu: 'Menu', card: 'Cards', content: 'Conte√∫do', header: 'Cabe√ßalhos', button: 'Bot√µes', other: 'Outros' };
            
            Object.keys(groupedResults).forEach(type => {
                const typeResults = groupedResults[type];
                if (typeResults.length === 0) return;
                
                html += `
                    <div style="padding: 8px 15px; background: rgba(255,255,255,0.05); border-left: 3px solid var(--color-primary-solid, #804C9A); margin: 5px 0; color: var(--color-text-on-sidebar, #fff);">
                        <strong>${typeIcons[type]} ${typeLabels[type]} (${typeResults.length})</strong>
                    </div>
                `;
                
                typeResults.slice(0, 5).forEach(result => {
                    const pathText = result.section || result.category || 'Desconhecido';
                    
                    html += `
                        <div class="search-result-item" onclick="navigateToUniversalResult(${resultIndex})" data-result-index="${resultIndex}">
                            <div class="search-result-name">${result.highlightedName}</div>
                            <div class="search-result-path">üìç ${pathText}</div>
                        </div>
                    `;
                    resultIndex++;
                });
            });
            
            searchResults.innerHTML = html;
            searchResults.style.display = 'block';
        }
        
        function navigateToUniversalResult(index) {
            const allResults = [];
            ['menu', 'card', 'content', 'header', 'button', 'other'].forEach(type => {
                const typeResults = lastSearchResults.filter(r => r.type === type);
                allResults.push(...typeResults.slice(0, 5));
            });
            
            if (index >= 0 && index < allResults.length) {
                const result = allResults[index];
                
                if (result && result.element) {
                    const clickedListItem = document.querySelector(`[data-result-index="${index}"]`);
                    if (clickedListItem) {
                        clickedListItem.classList.add('clicked');
                        setTimeout(() => clickedListItem.classList.remove('clicked'), 300);
                    }
                    
                    clearPreviousHighlights();
                    
                    if (result.type === 'menu') {
                        expandParentCategoriesForSearch(result.element);
                    }
                    
                    result.element.classList.add('search-highlighted-item');
                    
                    setTimeout(() => {
                        result.element.scrollIntoView({
                            behavior: 'smooth',
                            block: 'center'
                        });
                        highlightElement(result.element);
                    }, 400);
                    
                    console.log(`üéØ Navegando para [${result.type.toUpperCase()}]: ${result.name} em ${result.section}`);
                }
            }
        }
        
                // Fun√ß√£o SUPER FLEX√çVEL para calcular score - encontra qualquer subsequ√™ncia
        function calculateUniversalScoreFixed(text, searchTerm) {
            const lowerText = text.toLowerCase();
            const lowerSearchTerm = searchTerm.toLowerCase();
            
            console.log(`üîç Testando "${text}" vs "${searchTerm}"`);
            
            // Match exato (100 pontos)
            if (lowerText === lowerSearchTerm) {
                console.log(`‚úÖ Match EXATO: "${text}"`);
                return 100;
            }
            
            // Inicia com (90 pontos)
            if (lowerText.startsWith(lowerSearchTerm)) {
                console.log(`‚úÖ INICIA com: "${text}"`);
                return 90;
            }
            
            // Termina com (80 pontos)
            if (lowerText.endsWith(lowerSearchTerm)) {
                console.log(`‚úÖ TERMINA com: "${text}"`);
                return 80;
            }
            
            // Cont√©m o termo completo (70 pontos)
            if (lowerText.includes(lowerSearchTerm)) {
                console.log(`‚úÖ CONT√âM completo: "${text}" cont√©m "${searchTerm}"`);
                return 70;
            }
            
            // ‚≠ê NOVA L√ìGICA: Busca por subsequ√™ncia (termo dentro de palavra)
            // Exemplo: "longe" encontra em "Longevidade"
            const words = lowerText.split(/\s+/);
            for (let word of words) {
                if (word.includes(lowerSearchTerm)) {
                    console.log(`‚úÖ SUBSEQU√äNCIA: "${word}" cont√©m "${searchTerm}" em "${text}"`);
                    return 60; // Score bom para subsequ√™ncias
                }
            }
            
            // Busca caractere por caractere em sequ√™ncia
            let score = 0;
            let consecutiveMatches = 0;
            let lastFoundIndex = -1;
            
            for (let i = 0; i < lowerSearchTerm.length; i++) {
                const char = lowerSearchTerm[i];
                const foundIndex = lowerText.indexOf(char, lastFoundIndex + 1);
                
                if (foundIndex !== -1) {
                    if (foundIndex === lastFoundIndex + 1) {
                        consecutiveMatches++;
                        score += consecutiveMatches * 3; // Mais pontos para sequ√™ncias
                    } else {
                        consecutiveMatches = 1;
                        score += 1;
                    }
                    lastFoundIndex = foundIndex;
                } else {
                    // Se n√£o encontrou um caractere, quebra a sequ√™ncia
                    break;
                }
            }
            
            // Se encontrou uma boa sequ√™ncia de caracteres
            if (score >= lowerSearchTerm.length * 2) {
                console.log(`‚úÖ SEQU√äNCIA de caracteres: "${text}" (score: ${score})`);
                return Math.min(score, 50); // Max 50 para sequ√™ncias de caracteres
            }
            
            console.log(`‚ùå Nenhum match suficiente para: "${text}" (score tentativo: ${score})`);
            return 0;
        }
        
        // Comentando implementa√ß√£o que quebrou o sistema
        // createMenuSearchIndex = originalCreateMenuSearchIndex;
        // searchMenu = originalSearchMenu;
        // displaySearchResults = originalDisplaySearchResults;
        */
        
                // Adicionar estilos CSS
        const universalStyles = document.createElement('style');
        universalStyles.textContent = `
            .search-highlight-partial {
                background-color: var(--color-primary-light, rgba(255, 193, 7, 0.4));
                color: var(--color-primary-solid, #FFD700);
                font-weight: bold;
            }
            
                    @keyframes slideIn {
            from {
                opacity: 0;
                transform: translate(-50%, -60%);
                scale: 0.8;
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
                scale: 1;
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
            
                    .card-highlighted {
            z-index: 1000 !important;
            position: relative !important;
            transform: scale(1.02);
            box-shadow: 0 0 20px var(--color-primary-solid, rgba(128, 76, 154, 0.8)) !important;
            animation: cardPulse 2s ease-in-out;
            color: var(--color-text-on-sidebar, #ffffff) !important;
        }

        .card-selected {
            border: 2px solid #4CAF50 !important;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.4) !important;
            background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05)) !important;
            transform: scale(1.01) !important;
            transition: all 0.3s ease !important;
            position: relative !important;
        }

        .card-selected::before {
            content: "‚úì";
            position: absolute;
            top: 10px;
            right: 10px;
            background: #4CAF50;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            z-index: 10;
        }
        
        @keyframes cardPulse {
            0%, 100% { 
                box-shadow: 0 0 20px var(--color-primary-solid, rgba(128, 76, 154, 0.8));
            }
            50% { 
                box-shadow: 0 0 30px var(--color-primary-solid, rgba(128, 76, 154, 1));
            }
        }
        

        `;
        document.head.appendChild(universalStyles);
        
        // Fun√ß√£o de debug acess√≠vel
        window.debugBusca = function(termo = null) {
            console.log('=== DEBUG BUSCA UNIVERSAL ===');
            console.log('Total de itens indexados:', menuSearchIndex.length);
            
            console.log('\nüìã Primeiros 10 itens do Menu:');
            const menuItems = menuSearchIndex.filter(item => item.type === 'menu');
            menuItems.slice(0, 10).forEach(item => {
                console.log(`- "${item.name}" (${item.section})`);
            });
            
            console.log('\nüìö Todos os Cards encontrados:');
            const cardItems = menuSearchIndex.filter(item => item.type === 'card');
            console.log(`Total de cards: ${cardItems.length}`);
            cardItems.forEach(item => {
                console.log(`- "${item.name}" (${item.section || item.category})`);
            });
            
            console.log('\nüé¥ Cards no Menu (Terceiro N√≠vel):');
            const menuCardItems = menuSearchIndex.filter(item => item.type === 'menu-card');
            console.log(`Total de menu-cards: ${menuCardItems.length}`);
            menuCardItems.forEach(item => {
                console.log(`- "${item.name}" (${item.path.join(' ‚Ä∫ ')})`);
            });
            
            console.log('\nüìÇ Sub-subcategorias (Terceiro N√≠vel):');
            const subSubCategoryItems = menuSearchIndex.filter(item => item.type === 'subsubcategory');
            console.log(`Total de sub-subcategorias: ${subSubCategoryItems.length}`);
            subSubCategoryItems.forEach(item => {
                console.log(`- "${item.name}" (${item.path.join(' ‚Ä∫ ')})`);
            });
            
            console.log('\nüìÑ Itens de Conte√∫do:');
            const contentItems = menuSearchIndex.filter(item => item.type === 'content');
            contentItems.slice(0, 10).forEach(item => {
                console.log(`- "${item.name}" (${item.section})`);
            });
            
            // Buscar especificamente por "Longevidade"
            console.log('\nüîç Procurando por "Longevidade":');
            const longevidadeItems = menuSearchIndex.filter(item => 
                item.name.toLowerCase().includes('longevidade')
            );
            longevidadeItems.forEach(item => {
                console.log(`‚úÖ ENCONTRADO: "${item.name}" (tipo: ${item.type}, se√ß√£o: ${item.section})`);
            });
            
            // Teste de busca
            const testeTermo = termo || 'longe';
            console.log(`\nüîç Teste busca "${testeTermo}":`);
            const results = universalFlexibleSearch(testeTermo);
            console.log(`Resultados encontrados: ${results.length}`);
            results.slice(0, 10).forEach(result => {
                console.log(`- "${result.name}" (score: ${result.matchScore}, tipo: ${result.type})`);
            });
            
            // Teste manual da fun√ß√£o de score
            console.log(`\nüß™ Teste manual: "Longevidade" vs "${testeTermo}":`);
            const scoreTest = calculateUniversalScore('Longevidade', testeTermo);
            console.log(`Score calculado: ${scoreTest}`);
        };
        
        // Fun√ß√£o para testar termos espec√≠ficos
        window.testarBusca = function(termo) {
            console.log(`\nüîç === TESTE: "${termo}" ===`);
            const results = universalFlexibleSearch(termo);
            console.log(`Encontrados ${results.length} resultados:`);
            results.forEach((result, i) => {
                console.log(`${i+1}. "${result.name}" (${result.type}) - Score: ${result.matchScore}`);
            });
        };
        
        // üîß Fun√ß√£o para diagn√≥stico COMPLETO do menu
        window.diagnosticarMenu = function() {
            console.log('\nüîç === DIAGN√ìSTICO COMPLETO DO MENU ===');
            
            // 1. Conta TODOS os elementos no menu
            const allElements = document.querySelectorAll('aside *');
            console.log(`üìã Total de elementos encontrados: ${allElements.length}`);
            
            // 2. Separa por tipo de elemento
            const elementTypes = {};
            allElements.forEach(el => {
                const tag = el.tagName.toLowerCase();
                const classes = Array.from(el.classList).join(' ');
                const key = classes ? `${tag}.${classes}` : tag;
                
                if (!elementTypes[key]) elementTypes[key] = 0;
                elementTypes[key]++;
            });
            
            console.log('\nüìä Elementos por tipo:');
            Object.entries(elementTypes)
                .sort((a, b) => b[1] - a[1])
                .forEach(([type, count]) => {
                    console.log(`  ${count}x ${type}`);
                });
            
            // 3. Identifica elementos clic√°veis perdidos
            console.log('\nüîç Elementos clic√°veis que podem estar sendo perdidos:');
            const clickableElements = document.querySelectorAll('aside button, aside a, aside [onclick], aside [data-card-name], aside .clickable, aside .menu-item');
            
            clickableElements.forEach((el, i) => {
                const text = el.textContent.trim();
                const isIndexed = allMenuItems.some(item => item.element === el);
                
                if (!isIndexed && text && text.length > 1) {
                    console.log(`‚ùå N√ÉO INDEXADO: "${text}" (${el.tagName.toLowerCase()}.${Array.from(el.classList).join('.')})`);
                }
            });
            
            // 4. Verifica elementos com texto mas sem indexa√ß√£o
            console.log('\nüìù Elementos com texto n√£o indexados:');
            let lostElements = 0;
            allElements.forEach(el => {
                const text = el.textContent.trim();
                const hasOnlyTextContent = el.children.length === 0;
                const isIndexed = allMenuItems.some(item => item.element === el);
                
                if (hasOnlyTextContent && text && text.length > 2 && !isIndexed && 
                    !text.includes('‚ñ∫') && !text.includes('‚ñº') && 
                    text !== 'Carregando...' && !text.includes('...')) {
                    console.log(`üîç Poss√≠vel elemento perdido: "${text}" (${el.tagName})`);
                    lostElements++;
                }
            });
            
            console.log(`\nüìä Resumo do diagn√≥stico:`);
            console.log(`  - Total de elementos: ${allElements.length}`);
            console.log(`  - Elementos indexados: ${allMenuItems.length}`);
            console.log(`  - Elementos clic√°veis: ${clickableElements.length}`);
            console.log(`  - Poss√≠veis elementos perdidos: ${lostElements}`);
            console.log(`  - Taxa de cobertura: ${((allMenuItems.length / allElements.length) * 100).toFixed(1)}%`);
        };
        
        // Fun√ß√£o espec√≠fica para testar CEL APPS
        window.testarCelApps = function() {
            console.log('\nüîç === TESTE ESPEC√çFICO: CEL APPS ===');
            
            // Testa as subcategorias
            const subcategorias = ['saude', 'comunicar', 'banco', 'alimentacao', 'utilidades', 'lazer', 'transporte'];
            subcategorias.forEach(subcat => {
                console.log(`\nüìÇ Testando subcategoria: "${subcat}"`);
                const results = universalFlexibleSearch(subcat);
                console.log(`Encontrados ${results.length} resultados:`);
                results.forEach((result, i) => {
                    console.log(`  ${i+1}. "${result.name}" (${result.type}) - Score: ${result.matchScore}`);
                });
            });
            
            // Testa alguns apps espec√≠ficos
            const apps = ['whatsapp', 'uber', 'banco', 'ifood', 'youtube'];
            console.log('\nüì± === TESTANDO APPS ESPEC√çFICOS ===');
            apps.forEach(app => {
                console.log(`\nüì± Testando app: "${app}"`);
                const results = universalFlexibleSearch(app);
                console.log(`Encontrados ${results.length} resultados:`);
                results.forEach((result, i) => {
                    console.log(`  ${i+1}. "${result.name}" (${result.type}) - Score: ${result.matchScore}`);
                });
            });
        };
        
        // Fun√ß√£o de debug para sincroniza√ß√£o
        window.debugSync = function(cardName = null) {
            console.log('=== DEBUG SINCRONIZA√á√ÉO BIDIRECIONAL ===');
            
            // Lista todos os card-menu-items
            const menuItems = Array.from(document.querySelectorAll('.card-menu-item'));
            console.log(`üìã Total de card-menu-items: ${menuItems.length}`);
            menuItems.forEach((item, i) => {
                const name = item.getAttribute('data-card-name');
                const isActive = item.classList.contains('active');
                console.log(`${i+1}. "${name}" ${isActive ? '‚úÖ ATIVO' : ''}`);
            });
            
            // Lista todos os cards na √°rea principal
            const cards = Array.from(document.querySelectorAll('.course-card, .card, .resource-card'));
            console.log(`\nüé¥ Total de cards na √°rea principal: ${cards.length}`);
            cards.forEach((card, i) => {
                const titleEl = card.querySelector('h3, .card-title, .course-title');
                const title = titleEl ? titleEl.textContent.trim() : 'Sem t√≠tulo';
                const isSelected = card.classList.contains('card-selected');
                console.log(`${i+1}. "${title}" ${isSelected ? '‚úÖ SELECIONADO' : ''}`);
            });
            
            // Teste de sincroniza√ß√£o se cardName fornecido
            if (cardName) {
                console.log(`\nüîÑ Testando sincroniza√ß√£o para: "${cardName}"`);
                syncMenuSelection(cardName);
            }
            
            console.log(`\nüåê Estado global: ${window.currentSelectedCard || 'Nenhum'}`);
        };
        
        // Fun√ß√£o para testar sincroniza√ß√£o com card espec√≠fico
        window.testarSync = function(cardName) {
            console.log(`\nüß™ === TESTE SINCRONIZA√á√ÉO: "${cardName}" ===`);
            syncMenuSelection(cardName);
            
            setTimeout(() => {
                window.debugSync();
            }, 500);
        };
        
        // Fun√ß√£o para testar centraliza√ß√£o no carrossel
        window.testarCentralizacao = function(cardName) {
            console.log(`\nüéØ === TESTE CENTRALIZA√á√ÉO: "${cardName}" ===`);
            
            const targetCard = Array.from(document.querySelectorAll('.course-card, .card, .resource-card')).find(card => {
                const cardTitle = card.querySelector('h3, .card-title, .course-title');
                return cardTitle && cardTitle.textContent.trim() === cardName.trim();
            });
            
            if (targetCard) {
                console.log('‚úÖ Card encontrado, centralizando...');
                centerCardInCarousel(targetCard);
                
                // Adiciona destaque visual
                targetCard.classList.add('card-highlighted');
                setTimeout(() => {
                    targetCard.classList.remove('card-highlighted');
                }, 3000);
            } else {
                console.log('‚ùå Card n√£o encontrado:', cardName);
                
                // Lista cards dispon√≠veis
                const availableCards = Array.from(document.querySelectorAll('.course-card, .card, .resource-card')).map(card => {
                    const cardTitle = card.querySelector('h3, .card-title, .course-title');
                    return cardTitle ? cardTitle.textContent.trim() : 'Sem t√≠tulo';
                });
                console.log('üìã Cards dispon√≠veis:', availableCards);
            }
        };
        
        // Fun√ß√£o para for√ßar centraliza√ß√£o usando scrollIntoView
        window.forceCentralizar = function(cardName) {
            console.log(`\nüöÄ === FOR√áAR CENTRALIZA√á√ÉO: "${cardName}" ===`);
            
            const targetCard = Array.from(document.querySelectorAll('.course-card, .card, .resource-card')).find(card => {
                const cardTitle = card.querySelector('h3, .card-title, .course-title');
                return cardTitle && cardTitle.textContent.trim() === cardName.trim();
            });
            
            if (targetCard) {
                console.log('‚úÖ Card encontrado, centralizando com scrollIntoView...');
                
                // M√©todo 1: scrollIntoView com inline center
                targetCard.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center',
                    inline: 'center'
                });
                
                // M√©todo 2: Scroll manual ap√≥s delay
                setTimeout(() => {
                    const container = targetCard.closest('.carousel-track, .cards-container, .content-area, main');
                    if (container) {
                        const cardRect = targetCard.getBoundingClientRect();
                        const containerRect = container.getBoundingClientRect();
                        
                        const cardCenter = cardRect.left + (cardRect.width / 2);
                        const containerCenter = containerRect.left + (containerRect.width / 2);
                        const scrollOffset = cardCenter - containerCenter;
                        
                        container.scrollBy({
                            left: scrollOffset,
                            behavior: 'smooth'
                        });
                        
                        console.log('üéØ Scroll manual aplicado:', {
                            cardCenter,
                            containerCenter,
                            scrollOffset
                        });
                    }
                }, 300);
                
                // Adiciona destaque visual
                targetCard.classList.add('card-highlighted');
                setTimeout(() => {
                    targetCard.classList.remove('card-highlighted');
                }, 3000);
                
                console.log('‚úÖ Centraliza√ß√£o for√ßada aplicada');
            } else {
                console.log('‚ùå Card n√£o encontrado:', cardName);
            }
        };
        
        // üöÄ Fun√ß√£o de "for√ßa bruta" para capturar TUDO
        window.forcaCompleta = function() {
            console.log('\nüöÄ === FOR√áA BRUTA: CAPTURANDO TUDO ===');
            
            // Re-faz a coleta com configura√ß√£o super abrangente
            allMenuItems = [];
            let totalCapturado = 0;
            
            // Captura LITERALMENTE tudo que tem texto no menu
            const todosElementos = document.querySelectorAll('aside *');
            
            todosElementos.forEach((elemento, index) => {
                const texto = elemento.textContent.trim();
                const temTextoUnico = elemento.children.length === 0; // N√£o tem filhos (folha da √°rvore)
                
                if (texto && texto.length > 1 && temTextoUnico &&
                    !texto.includes('‚ñ∫') && !texto.includes('‚ñº') &&
                    texto !== 'Carregando...' && !texto.includes('...') &&
                    !texto.match(/^\d+$/) && // N√£o √© s√≥ n√∫mero
                    texto !== '‚ò∞' && texto !== 'iA' && texto !== '√ó') {
                    
                    // Detecta categoria pai
                    let categoria = 'Desconhecida';
                    let elementoPai = elemento.closest('.accordion-item');
                    if (elementoPai) {
                        const header = elementoPai.querySelector('h2, .accordion-header');
                        if (header) {
                            categoria = header.textContent.replace(/‚ñ∫|‚ñº|\d+/g, '').trim();
                        }
                    }
                    
                    // Verifica se j√° foi adicionado
                    const jaExiste = allMenuItems.some(item => 
                        item.text === texto || item.element === elemento
                    );
                    
                    if (!jaExiste) {
                        allMenuItems.push({
                            element: elemento,
                            parent: elemento.parentElement,
                            text: texto,
                            originalText: elemento.textContent.trim(),
                            type: 'forca-bruta',
                            categoryName: categoria,
                            extraKeywords: '',
                            domIndex: index
                        });
                        totalCapturado++;
                        
                        console.log(`üöÄ [${totalCapturado}] CAPTURADO: "${texto}" (${categoria})`);
                    }
                }
            });
            
            console.log(`\n‚úÖ FOR√áA BRUTA CONCLU√çDA!`);
            console.log(`üìä Total capturado: ${totalCapturado} novos itens`);
            console.log(`üìã Total geral: ${allMenuItems.length} itens indexados`);
            
            // Testa a busca ap√≥s for√ßa bruta
            console.log(`\nüß™ Testando busca ap√≥s for√ßa bruta...`);
            const testeBusca = universalFlexibleSearch('teste');
            console.log(`Resultado teste: ${testeBusca.length} itens encontrados`);
        };
        
        // üîß Fun√ß√£o para for√ßar re-indexa√ß√£o manual
        window.reindexarAgora = function() {
            console.log('üîÑ === RE-INDEXA√á√ÉO MANUAL ===');
            collectAllMenuItems();
            console.log('‚úÖ Re-indexa√ß√£o conclu√≠da!');
        };
        
        // Bot√µes de debug removidos para produ√ß√£o

        // ============== SISTEMA DE PERSONALIZA√á√ÉO DE CORES ==============
        function initializeColorCustomization() {
            const primaryColorPicker = document.getElementById('primaryColorPicker');
            const applyColorsBtn = document.getElementById('applyColorsBtn');
            const resetColorsBtn = document.getElementById('resetColorsBtn');
            
            // DEBUG: Verificar se elementos foram encontrados
            console.log('üîç Debug Elementos:', {
                primaryColorPicker: !!primaryColorPicker,
                applyColorsBtn: !!applyColorsBtn,
                resetColorsBtn: !!resetColorsBtn,
                primaryColorValue: primaryColorPicker?.value
            });
            
            // Cor padr√£o
            const defaultColor = '#503060';
            
            // Carregar cores salvas
            loadSavedColors();
            
            // Event listener para o color picker principal
            // Fun√ß√£o para salvar cores automaticamente
            function autoSaveColors() {
                const currentColor = primaryColorPicker?.value || defaultColor;
                const colorConfig = {
                    primary: currentColor,
                    contrastMode: isAutoContrast ? 'auto' : 'manual',
                    manualTextColor: isAutoContrast ? null : manualTextColor?.value,
                    timestamp: Date.now()
                };
                
                localStorage.setItem('customColors', JSON.stringify(colorConfig));
                console.log('üíæ Auto-salvando cores:', colorConfig);
            }
            
            // Event listeners para os bot√µes
            if (primaryColorPicker) {
                primaryColorPicker.addEventListener('input', function() {
                    console.log('üé® Color picker INPUT - Nova cor:', this.value);
                    updatePreview();
                    autoSaveColors(); // Salvar automaticamente
                });
                primaryColorPicker.addEventListener('change', function() {
                    console.log('üé® Color picker CHANGE - Nova cor:', this.value);
                    updatePreview();
                    autoSaveColors(); // Salvar automaticamente
                });
                
                console.log('‚úÖ Event listeners do color picker configurados!');
            } else {
                console.error('‚ùå primaryColorPicker n√£o encontrado!');
            }
            
            // Fun√ß√£o para carregar cores salvas
            function loadSavedColors() {
                const savedConfig = localStorage.getItem('customColors');
                if (savedConfig) {
                    try {
                        const config = JSON.parse(savedConfig);
                        
                        // Restaurar cor prim√°ria
                        if (config.primary && primaryColorPicker) {
                            primaryColorPicker.value = config.primary;
                        }
                        
                        // Restaurar modo de contraste
                        if (config.contrastMode === 'manual' && config.manualTextColor) {
                            isAutoContrast = false;
                            switchToManualMode();
                            if (manualTextColor) {
                                manualTextColor.value = config.manualTextColor;
                                applyManualTextColor(config.manualTextColor);
                            }
                        } else {
                            isAutoContrast = true;
                            switchToAutoMode();
                        }
                        
                        // Aplicar cores restauradas
                        updatePreview();
                        
                        console.log('üîÑ Cores carregadas do localStorage:', config);
                    } catch (error) {
                        console.error('‚ùå Erro ao carregar cores salvas:', error);
                    }
                } else {
                    console.log('‚ÑπÔ∏è Nenhuma cor salva encontrada, usando padr√£o');
                }
            }
            
            // Event listeners para os bot√µes
            if (applyColorsBtn) {
                applyColorsBtn.addEventListener('click', applyCustomColors);
            }
            if (resetColorsBtn) {
                resetColorsBtn.addEventListener('click', resetToDefault);
            }
            
            // ===== CONTRASTE AUTOM√ÅTICO DO TEXTO =====
            const autoContrastBtn = document.getElementById('autoContrastBtn');
            const manualContrastBtn = document.getElementById('manualContrastBtn');
            const manualTextColor = document.getElementById('manualTextColor');
            const textBrightnessPreview = document.getElementById('textBrightnessPreview');
            
            let isAutoContrast = true; // Padr√£o √© autom√°tico
            
            // Fun√ß√£o para carregar configura√ß√£o salva
            function loadSavedContrastMode() {
                const savedMode = localStorage.getItem('contrastMode');
                const savedManualColor = localStorage.getItem('manualTextColor');
                
                if (savedMode === 'manual' && savedManualColor) {
                    isAutoContrast = false;
                    switchToManualMode();
                    manualTextColor.value = savedManualColor;
                    applyManualTextColor(savedManualColor);
                } else {
                    isAutoContrast = true;
                    switchToAutoMode();
                    applyAutoContrast();
                }
            }
            
            // Alternar para modo autom√°tico
            function switchToAutoMode() {
                isAutoContrast = true;
                autoContrastBtn.style.background = 'linear-gradient(45deg, #4CAF50, #45a049)';
                manualContrastBtn.style.background = '#666';
                manualTextColor.style.display = 'none';
                textBrightnessPreview.textContent = 'Modo: Autom√°tico (Detecta o melhor contraste)';
                localStorage.setItem('contrastMode', 'auto');
                applyAutoContrast();
            }
            
            // Alternar para modo manual
            function switchToManualMode() {
                isAutoContrast = false;
                autoContrastBtn.style.background = '#666';
                manualContrastBtn.style.background = 'linear-gradient(45deg, #4CAF50, #45a049)';
                manualTextColor.style.display = 'inline-block';
                updateManualPreview();
                localStorage.setItem('contrastMode', 'manual');
            }
            
            // Aplicar contraste autom√°tico baseado na cor da sidebar
            function applyAutoContrast() {
                if (!isAutoContrast) return;
                
                const root = document.documentElement;
                const primaryColor = primaryColorPicker?.value || defaultColor;
                const colors = generateColorVariations(primaryColor);
                
                // Usar a cor de elementos da sidebar para calcular contraste
                const contrastColor = getContrastColor(colors.sidebarElements);
                root.style.setProperty('--text-brightness-color', contrastColor);
                
                console.log(`ü§ñ Contraste autom√°tico: ${contrastColor} para fundo ${colors.sidebarElements}`);
                
                // Atualizar preview se estivermos em modo autom√°tico
                if (textBrightnessPreview) {
                    const colorName = contrastColor === '#000000' ? 'Preto' : 'Branco';
                    textBrightnessPreview.textContent = `Modo: Autom√°tico - ${colorName} (${contrastColor})`;
                    textBrightnessPreview.style.color = contrastColor;
                }
                
                // For√ßar aplica√ß√£o imediata
                setTimeout(forceContrastOnAllElements, 50);
            }
            
            // Aplicar cor manual do texto
            function applyManualTextColor(color) {
                const root = document.documentElement;
                root.style.setProperty('--text-brightness-color', color);
                localStorage.setItem('manualTextColor', color);
                console.log(`‚úã Cor manual aplicada: ${color}`);
                
                // For√ßar aplica√ß√£o imediata
                setTimeout(forceContrastOnAllElements, 50);
            }
            
            // Atualizar preview manual
            function updateManualPreview() {
                const selectedColor = manualTextColor.value;
                const colorNames = {
                    '#ffffff': 'Branco',
                    '#000000': 'Preto',
                    '#cccccc': 'Cinza Claro',
                    '#666666': 'Cinza Escuro'
                };
                textBrightnessPreview.textContent = `Modo: Manual - ${colorNames[selectedColor]} (${selectedColor})`;
                textBrightnessPreview.style.color = selectedColor;
            }
            
            // Event listeners
            if (autoContrastBtn) {
                autoContrastBtn.addEventListener('click', function() {
                    switchToAutoMode();
                    autoSaveColors(); // Salvar mudan√ßa de modo
                });
            }
            
            if (manualContrastBtn) {
                manualContrastBtn.addEventListener('click', function() {
                    switchToManualMode();
                    autoSaveColors(); // Salvar mudan√ßa de modo
                });
            }
            
            if (manualTextColor) {
                manualTextColor.addEventListener('change', function() {
                    applyManualTextColor(this.value);
                    updateManualPreview();
                    autoSaveColors(); // Salvar mudan√ßa de cor manual
                });
            }
            
            // Fun√ß√£o para for√ßar contraste em todos os elementos
            function forceContrastOnAllElements() {
                const root = document.documentElement;
                const currentTextColor = getComputedStyle(root).getPropertyValue('--text-brightness-color').trim();
                
                if (currentTextColor) {
                    // Aplicar diretamente a TODOS os elementos de texto na sidebar
                    const allTextElements = document.querySelectorAll('aside, aside *');
                    allTextElements.forEach(element => {
                        // N√£o aplicar em inputs de cor, range, ou elementos que devem manter cor espec√≠fica
                        if (!element.matches('input[type="color"], input[type="range"], .color-preview, .brightness-preview')) {
                            element.style.color = currentTextColor + ' !important';
                        }
                    });
                    
                    console.log(`üéØ Contraste for√ßado em ${allTextElements.length} elementos: ${currentTextColor}`);
                }
            }
            
            // Carregar configura√ß√£o salva na inicializa√ß√£o
            loadSavedContrastMode();
            
            // Fun√ß√£o para calcular contraste autom√°tico das fontes
            function getContrastColor(backgroundColor) {
                // Converter hex para RGB
                const hexToRgb = (hex) => {
                    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                    return result ? {
                        r: parseInt(result[1], 16),
                        g: parseInt(result[2], 16),
                        b: parseInt(result[3], 16)
                    } : null;
                };
                
                const rgb = hexToRgb(backgroundColor);
                if (!rgb) return '#ffffff'; // Default branco se erro
                
                // Calcular luminosidade relativa (f√≥rmula W3C)
                const getLuminance = (r, g, b) => {
                    const [rs, gs, bs] = [r, g, b].map(c => {
                        c = c / 255;
                        return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
                    });
                    return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
                };
                
                const luminance = getLuminance(rgb.r, rgb.g, rgb.b);
                
                // Se luminosidade baixa (escuro) ‚Üí texto branco
                // Se luminosidade alta (claro) ‚Üí texto preto
                return luminance > 0.5 ? '#000000' : '#ffffff';
            }

            // Fun√ß√£o para gerar cores automaticamente
            function generateColorVariations(baseColor) {
                const hexToHsl = (hex) => {
                    const r = parseInt(hex.slice(1, 3), 16) / 255;
                    const g = parseInt(hex.slice(3, 5), 16) / 255;
                    const b = parseInt(hex.slice(5, 7), 16) / 255;
                    
                    const max = Math.max(r, g, b);
                    const min = Math.min(r, g, b);
                    let h, s, l = (max + min) / 2;
                    
                    if (max === min) {
                        h = s = 0; // achromatic
                    } else {
                        const d = max - min;
                        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                        switch (max) {
                            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                            case g: h = (b - r) / d + 2; break;
                            case b: h = (r - g) / d + 4; break;
                        }
                        h /= 6;
                    }
                    
                    return [h * 360, s * 100, l * 100];
                };
                
                const hslToHex = (h, s, l) => {
                    l /= 100;
                    const a = s * Math.min(l, 1 - l) / 100;
                    const f = n => {
                        const k = (n + h / 30) % 12;
                        const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
                        return Math.round(255 * color).toString(16).padStart(2, '0');
                    };
                    return `#${f(0)}${f(8)}${f(4)}`;
                };
                
                const [h, s, l] = hexToHsl(baseColor);
                
                // Cor de fundo da sidebar (mais escura)
                const sidebarBgLightness = Math.max(10, l * 0.5);
                
                // Elementos da sidebar devem ser 30% mais claros que o fundo para contraste
                const sidebarElementsLightness = Math.min(90, sidebarBgLightness + 30);
                
                const generatedColors = {
                    main: baseColor,
                    secondary: hslToHex(h, Math.max(10, s * 0.8), Math.max(15, l * 0.8)), // Mais escuro que main
                    background: hslToHex(h, Math.max(10, s * 0.6), sidebarBgLightness),  // Fundo da sidebar
                    sidebarElements: hslToHex(h, Math.max(15, s * 0.9), sidebarElementsLightness), // 30% mais claro que o fundo
                    sidebarElementsHover: hslToHex(h, Math.max(20, s * 0.95), Math.min(95, sidebarElementsLightness + 10)), // Ainda mais claro no hover
                    // NOVA: cor escura para bordas do modal (15% de claridade)
                    darkBorder: hslToHex(h, Math.max(15, s * 0.9), 15),
                    // NOVA: cor mais escura que a principal (para gradientes)
                    darker: hslToHex(h, Math.max(15, s * 0.9), Math.max(10, l * 0.6)),
                    // NOVA: cor para sombras (com alpha)
                    shadowColor: `rgba(${parseInt(baseColor.slice(1, 3), 16)}, ${parseInt(baseColor.slice(3, 5), 16)}, ${parseInt(baseColor.slice(5, 7), 16)}, 0.4)`
                };
                
                // Adicionar cores de contraste autom√°tico
                generatedColors.textOnMain = getContrastColor(generatedColors.main);
                generatedColors.textOnSidebar = getContrastColor(generatedColors.sidebarElements);
                generatedColors.textOnBackground = getContrastColor(generatedColors.background);
                
                return generatedColors;
            }
            
            function updatePreview() {
                const primaryColor = primaryColorPicker?.value || defaultColor;
                const colors = generateColorVariations(primaryColor);
                
                // Atualizar preview principal
                const primaryPreview = document.getElementById('primaryColorPreview');
                if (primaryPreview) {
                    primaryPreview.style.background = colors.main;
                    primaryPreview.textContent = colors.main;
                }
                
                // Atualizar previews autom√°ticos
                const autoMainPreview = document.getElementById('autoMainPreview');
                const autoSecondaryPreview = document.getElementById('autoSecondaryPreview');
                const autoBackgroundPreview = document.getElementById('autoBackgroundPreview');
                
                if (autoMainPreview) {
                    autoMainPreview.style.background = colors.main;
                    autoMainPreview.textContent = colors.main;
                }
                if (autoSecondaryPreview) {
                    autoSecondaryPreview.style.background = colors.secondary;
                    autoSecondaryPreview.textContent = colors.secondary;
                }
                if (autoBackgroundPreview) {
                    autoBackgroundPreview.style.background = colors.background;
                    autoBackgroundPreview.textContent = colors.background;
                }
                
                // APLICAR EM TEMPO REAL - TODAS AS CORES
                applyColorsRealTime(colors.main, colors.secondary, colors.background);
                
                // Aplicar contraste autom√°tico se estiver ativo
                if (isAutoContrast) {
                    setTimeout(applyAutoContrast, 100); // Pequeno delay para CSS ser aplicado
                }
                
                // For√ßar aplica√ß√£o em todos os elementos
                setTimeout(forceContrastOnAllElements, 150);
            }
            
            function applyColorsRealTime(primaryColor, secondaryColor, backgroundColor) {
                // Gerar todas as varia√ß√µes com contraste adequado
                const colors = generateColorVariations(primaryColor);
                
                // Converter hex para RGB para alpha
                const hexToRgb = (hex) => {
                    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                    return result ? {
                        r: parseInt(result[1], 16),
                        g: parseInt(result[2], 16),
                        b: parseInt(result[3], 16)
                    } : null;
                };
                
                // Gerar cor muito escura para o fundo do main (carrossel)
                const generateDarkBackground = (baseColor) => {
                    const [h, s, l] = hexToHsl(baseColor);
                    // Criar uma vers√£o muito escura da cor (5% de lightness)
                    return hslToHex(h, Math.max(10, s * 0.8), 5);
                };
                
                // Fun√ß√£o para converter hex para HSL
                const hexToHsl = (hex) => {
                    const r = parseInt(hex.slice(1, 3), 16) / 255;
                    const g = parseInt(hex.slice(3, 5), 16) / 255;
                    const b = parseInt(hex.slice(5, 7), 16) / 255;
                    
                    const max = Math.max(r, g, b);
                    const min = Math.min(r, g, b);
                    let h, s, l = (max + min) / 2;
                    
                    if (max === min) {
                        h = s = 0;
                    } else {
                        const d = max - min;
                        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                        switch (max) {
                            case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                            case g: h = (b - r) / d + 2; break;
                            case b: h = (r - g) / d + 4; break;
                        }
                        h /= 6;
                    }
                    return [h * 360, s * 100, l * 100];
                };
                
                // Fun√ß√£o para converter HSL para hex
                const hslToHex = (h, s, l) => {
                    l /= 100;
                    const a = s * Math.min(l, 1 - l) / 100;
                    const f = n => {
                        const k = (n + h / 30) % 12;
                        const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
                        return Math.round(255 * color).toString(16).padStart(2, '0');
                    };
                    return `#${f(0)}${f(8)}${f(4)}`;
                };
                
                const primaryRgb = hexToRgb(colors.main);
                const sidebarElementsRgb = hexToRgb(colors.sidebarElements);
                const sidebarHoverRgb = hexToRgb(colors.sidebarElementsHover);
                
                // Gerar cor escura para o fundo do main
                const darkBackground = generateDarkBackground(colors.main);
                
                // Aplicar cores via CSS custom properties EM TEMPO REAL
                const root = document.documentElement;
                
                // Cores principais
                root.style.setProperty('--color-primary-start', colors.main);
                root.style.setProperty('--color-primary-end', colors.background);
                root.style.setProperty('--color-primary-solid', colors.main);
                
                // NOVA: Atualizar cor de fundo do main (carrossel) para acompanhar a cor escolhida
                root.style.setProperty('--color-bg-dark', darkBackground);
                
                // NOVA: Atualizar cor da borda escura do modal para acompanhar a cor escolhida
                root.style.setProperty('--color-primary-dark-border', colors.darkBorder);
                
                // NOVA: Cores para bot√µes de favoritos (mais escura e sombra)
                root.style.setProperty('--color-primary-darker', colors.darker);
                root.style.setProperty('--color-primary-shadow', colors.shadowColor);
                
                if (primaryRgb) {
                    root.style.setProperty('--color-primary-alpha', `rgba(${primaryRgb.r}, ${primaryRgb.g}, ${primaryRgb.b}, 0.9)`);
                    root.style.setProperty('--color-primary-light', `rgba(${primaryRgb.r}, ${primaryRgb.g}, ${primaryRgb.b}, 0.7)`);
                }
                
                // Cores da sidebar com contraste 30% garantido
                if (sidebarElementsRgb) {
                    root.style.setProperty('--color-sidebar-elements', colors.sidebarElements);
                    root.style.setProperty('--color-sidebar-elements-alpha', `rgba(${sidebarElementsRgb.r}, ${sidebarElementsRgb.g}, ${sidebarElementsRgb.b}, 0.8)`);
                }
                
                if (sidebarHoverRgb) {
                    root.style.setProperty('--color-sidebar-hover', colors.sidebarElementsHover);
                    root.style.setProperty('--color-sidebar-hover-alpha', `rgba(${sidebarHoverRgb.r}, ${sidebarHoverRgb.g}, ${sidebarHoverRgb.b}, 0.9)`);
                }
                
                // Aplicar cores de contraste autom√°tico para textos
                root.style.setProperty('--color-text-on-main', colors.textOnMain);
                root.style.setProperty('--color-text-on-sidebar', colors.textOnSidebar);
                root.style.setProperty('--color-text-on-background', colors.textOnBackground);
                
                // ATUALIZAR HEADER EM TEMPO REAL
                const header = document.querySelector('header');
                if (header) {
                    header.style.background = `linear-gradient(135deg, ${colors.main}, ${colors.sidebarElements}) !important`;
                    header.style.borderBottomColor = `${colors.sidebarElementsHover} !important`;
                    header.style.boxShadow = `0 2px 10px rgba(0, 0, 0, 0.3), 0 0 20px ${colors.main}33 !important`;
                }
                
                // ATUALIZAR MODAL EM TEMPO REAL
                const modalContent = document.querySelector('.modal-content');
                if (modalContent) {
                    modalContent.style.background = `linear-gradient(135deg, ${darkBackground}, ${colors.darkBorder}) !important`;
                    modalContent.style.borderColor = `${colors.sidebarElementsHover} !important`;
                    modalContent.style.boxShadow = `0 8px 25px rgba(0,0,0,0.7), 0 0 20px ${colors.main}50 !important`;
                }
                
                // For√ßar atualiza√ß√£o de todas as scrollbars (incluindo cards)
                document.body.style.overflow = 'hidden';
                
                // For√ßar scrollbars de containers espec√≠ficos com √™nfase no carousel
                const scrollContainers = document.querySelectorAll('.carousel-track, main, aside, .modal-content');
                scrollContainers.forEach(container => {
                    // For√ßar reflow mais agressivo
                    const originalOverflowX = container.style.overflowX;
                    const originalOverflowY = container.style.overflowY;
                    const originalScrollbarColor = container.style.scrollbarColor;
                    
                    container.style.overflowX = 'hidden';
                    container.style.overflowY = 'hidden';
                    container.style.scrollbarColor = 'initial';
                    
                    // For√ßar reflow
                    container.offsetHeight;
                    
                    setTimeout(() => {
                        container.style.overflowX = originalOverflowX || '';
                        container.style.overflowY = originalOverflowY || '';
                        container.style.scrollbarColor = originalScrollbarColor || '';
                        
                        // Para carousel-track, re-aplicar as propriedades espec√≠ficas
                        if (container.classList.contains('carousel-track')) {
                            container.style.overflowX = 'auto';
                            container.style.overflowY = 'hidden';
                        }
                    }, 10);
                });
                
                setTimeout(() => {
                    document.body.style.overflow = '';
                }, 10);
                
                // Aplicar diretamente aos elementos espec√≠ficos EM TEMPO REAL
                const sidebarUserHeader = document.querySelector('.sidebar-user-header');
                const searchContainer = document.querySelector('.menu-search-container');
                
                if (sidebarUserHeader && sidebarElementsRgb) {
                    sidebarUserHeader.style.background = `rgba(${sidebarElementsRgb.r}, ${sidebarElementsRgb.g}, ${sidebarElementsRgb.b}, 0.8)`;
                    sidebarUserHeader.style.color = '#fff';
                }
                
                if (searchContainer && sidebarElementsRgb) {
                    searchContainer.style.background = `rgba(${sidebarElementsRgb.r}, ${sidebarElementsRgb.g}, ${sidebarElementsRgb.b}, 0.6)`;
                }
            }
            
            function applyCustomColors() {
                const primaryColor = primaryColorPicker?.value || defaultColor;
                
                // As cores j√° est√£o aplicadas em tempo real, s√≥ precisamos salvar
                const customColors = {
                    primary: primaryColor,
                    contrastMode: isAutoContrast ? 'auto' : 'manual',
                    manualTextColor: isAutoContrast ? null : manualTextColor?.value,
                    timestamp: Date.now()
                };
                
                localStorage.setItem('customColors', JSON.stringify(customColors));
                
                // Feedback visual
                applyColorsBtn.textContent = 'üíæ Salvo!';
                applyColorsBtn.style.background = '#28a745';
                
                setTimeout(() => {
                    applyColorsBtn.textContent = 'üíæ Salvar';
                    applyColorsBtn.style.background = '';
                }, 2000);
                
                console.log('üé® Cores personalizadas salvas:', customColors);
            }
            
            function resetToDefault() {
                // Resetar color picker
                if (primaryColorPicker) primaryColorPicker.value = defaultColor;
                
                // Resetar para modo autom√°tico
                isAutoContrast = true;
                switchToAutoMode();
                
                // Resetar CSS properties
                const root = document.documentElement;
                root.style.removeProperty('--color-primary-start');
                root.style.removeProperty('--color-primary-end');
                root.style.removeProperty('--color-primary-solid');
                root.style.removeProperty('--color-primary-alpha');
                root.style.removeProperty('--color-primary-light');
                root.style.removeProperty('--color-secondary-alpha');
                root.style.removeProperty('--color-sidebar-elements');
                root.style.removeProperty('--color-sidebar-elements-alpha');
                root.style.removeProperty('--color-sidebar-hover');
                root.style.removeProperty('--color-sidebar-hover-alpha');
                root.style.removeProperty('--color-text-on-main');
                root.style.removeProperty('--color-text-on-sidebar');
                root.style.removeProperty('--color-text-on-background');
                root.style.removeProperty('--text-brightness-color');
                
                // Resetar elementos espec√≠ficos
                const sidebarUserHeader = document.querySelector('.sidebar-user-header');
                const searchContainer = document.querySelector('.menu-search-container');
                
                if (sidebarUserHeader) {
                    sidebarUserHeader.style.background = '';
                    sidebarUserHeader.style.color = '';
                }
                
                if (searchContainer) {
                    searchContainer.style.background = '';
                }
                
                // Remover do localStorage
                localStorage.removeItem('customColors');
                localStorage.removeItem('contrastMode');
                localStorage.removeItem('manualTextColor');
                
                // Atualizar previews
                updatePreview();
                
                // For√ßar atualiza√ß√£o da scrollbar
                document.body.style.overflow = 'hidden';
                setTimeout(() => {
                    document.body.style.overflow = '';
                }, 1);
                
                // Feedback visual
                resetColorsBtn.textContent = 'üîÑ Resetado!';
                resetColorsBtn.style.background = '#28a745';
                
                setTimeout(() => {
                    resetColorsBtn.textContent = 'üîÑ Resetar';
                    resetColorsBtn.style.background = '';
                }, 2000);
                
                console.log('üé® Cores resetadas para o padr√£o');
            }
            
            function loadSavedColors() {
                const savedColors = localStorage.getItem('customColors');
                if (savedColors) {
                    try {
                        const colors = JSON.parse(savedColors);
                        
                        if (primaryColorPicker) primaryColorPicker.value = colors.primary || defaultColor;
                        
                        // Carregar modo de contraste
                        if (colors.contrastMode) {
                            if (colors.contrastMode === 'manual' && colors.manualTextColor) {
                                isAutoContrast = false;
                                switchToManualMode();
                                manualTextColor.value = colors.manualTextColor;
                                applyManualTextColor(colors.manualTextColor);
                            } else {
                                isAutoContrast = true;
                                switchToAutoMode();
                            }
                        }
                        
                        updatePreview();
                        
                        // Aplicar as cores salvas automaticamente
                        setTimeout(() => {
                            updatePreview(); // Isso j√° chama applyColorsRealTime
                        }, 100);
                        
                        console.log('üé® Cores personalizadas carregadas:', colors);
                    } catch (error) {
                        console.error('Erro ao carregar cores salvas:', error);
                    }
                }
            }
        }
        
        // ===== INICIALIZA√á√ÉO FINAL =====
        // Garantir que o contraste seja aplicado quando a p√°gina carregar completamente
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                forceContrastOnAllElements();
                console.log('üéØ Contraste aplicado na inicializa√ß√£o da p√°gina');
                
                // ===== AUTO-CARREGAMENTO DE CORES NO DOM READY =====
                const savedColors = localStorage.getItem('customColors');
                if (savedColors) {
                    try {
                        const colors = JSON.parse(savedColors);
                        console.log('üé® Aplicando cores salvas no DOMContentLoaded:', colors);
                        
                        // Aplicar cor prim√°ria se existir
                        if (colors.primary) {
                            const primaryColorPicker = document.getElementById('primaryColorPicker');
                            if (primaryColorPicker) {
                                primaryColorPicker.value = colors.primary;
                                // Disparar evento para aplicar cores
                                primaryColorPicker.dispatchEvent(new Event('input', { bubbles: true }));
                                console.log('‚úÖ Cores aplicadas automaticamente:', colors.primary);
                            }
                        }
                    } catch (error) {
                        console.error('‚ùå Erro ao aplicar cores no DOMContentLoaded:', error);
                    }
                }
            }, 500);
            
            // ===== INICIALIZAR SISTEMA DE EXPORT/IMPORT =====
            initializeExportImportSystem();
        });
        
        // Fallback para caso DOMContentLoaded j√° tenha disparado
        setTimeout(() => {
            forceContrastOnAllElements();
            console.log('üéØ Contraste aplicado via timeout fallback');
            
            // ===== FALLBACK PARA CARREGAMENTO DE CORES =====
            const savedColors = localStorage.getItem('customColors');
            if (savedColors) {
                try {
                    const colors = JSON.parse(savedColors);
                    console.log('üîÑ Fallback: Aplicando cores salvas:', colors);
                    
                                        // Aplicar diretamente nas vari√°veis CSS
                    if (colors.primary) {
                        const root = document.documentElement;
                        const generatedColors = generateColorVariations(colors.primary);
                        
                        // Aplicar TODAS as vari√°veis CSS
                        root.style.setProperty('--color-primary-solid', generatedColors.primarySolid);
                        root.style.setProperty('--color-primary-light', generatedColors.primaryLight);
                        root.style.setProperty('--color-secondary-solid', generatedColors.secondarySolid);
                        root.style.setProperty('--color-primary-alpha', generatedColors.primaryAlpha);
                        root.style.setProperty('--color-sidebar-elements', generatedColors.sidebarElements);
                        root.style.setProperty('--color-sidebar-elements-alpha', generatedColors.sidebarElementsAlpha);
                        root.style.setProperty('--color-sidebar-hover', generatedColors.sidebarHover);
                        root.style.setProperty('--color-sidebar-hover-alpha', generatedColors.sidebarHoverAlpha);
                        
                        // Vari√°veis adicionais
                        root.style.setProperty('--color-bg-dark', '#100818');
                        root.style.setProperty('--color-text-primary', '#e5e5e5');
                        root.style.setProperty('--color-text-white', '#ffffff');
                        root.style.setProperty('--color-border-light', generatedColors.primaryLight + '40');
                        root.style.setProperty('--color-primary-end', generatedColors.secondarySolid);
                        
                        // For√ßar aplica√ß√£o em todos os elementos via CSS direto
                        const existingFallbackStyle = document.getElementById('fallback-colors');
                        if (existingFallbackStyle) {
                            existingFallbackStyle.remove();
                        }
                        
                        const fallbackStyle = document.createElement('style');
                        fallbackStyle.id = 'fallback-colors';
                        fallbackStyle.textContent = `
                            /* FALLBACK - For√ßar cores em TODOS os componentes */
                            .course-card, .resource-card, .content-card, .card {
                                border-color: ${generatedColors.primaryLight} !important;
                                background: rgba(63, 44, 80, 0.7) !important;
                            }
                            .course-card:hover, .resource-card:hover, .content-card:hover, .card:hover {
                                border-color: ${generatedColors.primarySolid} !important;
                                box-shadow: 0 6px 20px rgba(0,0,0,0.3), 0 0 15px ${generatedColors.primaryLight}50 !important;
                            }
                            .card-menu-item:hover {
                                background: ${generatedColors.sidebarElementsAlpha} !important;
                                border-left-color: ${generatedColors.sidebarElements} !important;
                            }
                            .card-menu-item.active {
                                background: ${generatedColors.sidebarHoverAlpha} !important;
                                border-left-color: ${generatedColors.sidebarHover} !important;
                            }
                            #myCoursesBtn, .access-course-button, button {
                                background-color: ${generatedColors.primarySolid} !important;
                            }
                            #myCoursesBtn:hover, .access-course-button:hover, button:hover {
                                background-color: ${generatedColors.primaryLight} !important;
                            }
                            #curationConfirm button, #curationReview button {
                                background-color: ${generatedColors.primarySolid} !important;
                                border-color: ${generatedColors.primaryLight} !important;
                            }
                            #curationConfirm button:hover, #curationReview button:hover {
                                background-color: ${generatedColors.primaryLight} !important;
                            }
                            input[type=checkbox] {
                                accent-color: ${generatedColors.primarySolid} !important;
                            }
                            aside {
                                background: ${generatedColors.primaryAlpha} !important;
                                border-right-color: ${generatedColors.primaryLight}40 !important;
                            }
                            aside .accordion-content ul li button:hover,
                            aside .accordion-content ul li button.active {
                                background: ${generatedColors.primaryAlpha} !important;
                            }
                            header {
                                background: linear-gradient(135deg, ${generatedColors.primarySolid}, ${generatedColors.secondarySolid}) !important;
                            }
                            .carousel-track::-webkit-scrollbar-thumb {
                                background: ${generatedColors.sidebarElements} !important;
                            }
                            .carousel-track::-webkit-scrollbar-thumb:hover {
                                background: ${generatedColors.sidebarHover} !important;
                            }
                        `;
                        document.head.appendChild(fallbackStyle);
                        
                        console.log('‚úÖ TODAS as cores aplicadas via fallback CSS:', colors.primary);
                    }
                } catch (error) {
                    console.error('‚ùå Erro no fallback de cores:', error);
                }
            }
        }, 1000);
        
        // ===== SISTEMA DE EXPORT/IMPORT COMPLETO =====
        function initializeExportImportSystem() {
            console.log('üîß Inicializando sistema de Export/Import...');
            
            const exportConfigBtn = document.getElementById('exportConfigBtn');
            const importConfigFile = document.getElementById('importConfigFile');
            
            console.log('üîç Elementos encontrados:', {
                exportBtn: !!exportConfigBtn,
                importInput: !!importConfigFile
            });
            
            // TESTE DIRETO - Adicionar onclick diretamente no HTML
            if (exportConfigBtn) {
                exportConfigBtn.onclick = function() {
                    console.log('üö® BOT√ÉO CLICADO DIRETAMENTE!');
                    exportAllConfigurations();
                };
                console.log('‚úÖ Onclick direto adicionado ao bot√£o!');
                
                // EXPOR FUN√á√ÉO NO CONSOLE PARA TESTE MANUAL
                window.testeExport = exportAllConfigurations;
                console.log('üß™ TESTE MANUAL: Digite "testeExport()" no console para testar!');
                
                // CRIAR BOT√ÉO DE TESTE VISUAL
                const testBtn = document.createElement('button');
                testBtn.textContent = 'üö®  BKP';
                testBtn.style.cssText = `
                    position: fixed;
                    top: 15px;
                    right: 16px;
                    z-index: 9999;
                    background: red;
                    color: white;
                    border: none;
                    padding: 10px;
                    cursor: pointer;
                    border-radius: 5px;
                `;
                testBtn.onclick = function() {
                    console.log('üö® BOT√ÉO DE TESTE CLICADO!');
                    exportAllConfigurations();
                };
                document.body.appendChild(testBtn);
                console.log('üö® Bot√£o de teste vermelho criado no canto superior direito!');
            }
        
        // SISTEMA √öNICO E SIMPLIFICADO DE EXPORT
        function exportAllConfigurations() {
            console.log('üöÄ EXPORT SIMPLIFICADO - Iniciando...');
            
            // Coletar TODAS as configura√ß√µes do localStorage
            const allLocalStorage = {};
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                allLocalStorage[key] = localStorage.getItem(key);
            }
            
            // Configura√ß√£o unificada e simples
            const config = {
                version: "UNIFIED_2.0",
                timestamp: new Date().toISOString(),
                type: "GERiAH_COMPLETE",
                
                // TUDO do localStorage (simples e completo)
                localStorage: allLocalStorage,
                
                // Configura√ß√µes atuais da interface (para redund√¢ncia)
                interface: {
                    primaryColor: primaryColorPicker?.value || '#503060',
                    userLabel: document.getElementById('userTypeLabel')?.textContent || 'INDIVIDUAL',
                    logoSrc: document.getElementById('logoImage')?.src || ''
                }
            };
            
            // Download simples e direto
            const dataStr = JSON.stringify(config, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            // Capturar texto personalizado para nome do backup
            const userLabel = document.getElementById('userTypeLabel');
            const texto = (userLabel && userLabel.textContent) ? userLabel.textContent.trim() : 'Usuario';
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `${texto.replace(/\s+/g, '_')}_Backup_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            console.log('üì• Export conclu√≠do:', Object.keys(allLocalStorage).length, 'itens salvos');
            alert('‚úÖ Backup criado com sucesso!');
        }
        
        // SISTEMA √öNICO E SIMPLIFICADO DE IMPORT
        function importAllConfigurations(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    console.log('üì• IMPORT SIMPLIFICADO - Iniciando...');
                    
                    // Parse do JSON
                    const config = JSON.parse(e.target.result);
                    console.log('üìã Configura√ß√£o recebida:', config);
                    
                    // SISTEMA UNIFICADO - Verificar se tem localStorage
                    if (config.localStorage) {
                        console.log('üîÑ Restaurando localStorage...');
                        
                        // Limpar localStorage atual (opcional - comentado para seguran√ßa)
                        // localStorage.clear();
                        
                        // Restaurar TODAS as configura√ß√µes
                        let itemsRestored = 0;
                        Object.keys(config.localStorage).forEach(key => {
                            if (config.localStorage[key] !== null && config.localStorage[key] !== undefined) {
                                localStorage.setItem(key, config.localStorage[key]);
                                itemsRestored++;
                            }
                        });
                        
                        console.log(`‚úÖ ${itemsRestored} configura√ß√µes restauradas no localStorage`);
                    }
                    
                    // Aplicar configura√ß√µes da interface se dispon√≠veis
                    if (config.interface) {
                        console.log('üé® Aplicando configura√ß√µes da interface...');
                        
                        // Aplicar cor prim√°ria
                        if (config.interface.primaryColor && primaryColorPicker) {
                            primaryColorPicker.value = config.interface.primaryColor;
                        }
                        
                        // Aplicar texto do usu√°rio
                        if (config.interface.userLabel) {
                            const userLabel = document.getElementById('userTypeLabel');
                            if (userLabel) {
                                userLabel.textContent = config.interface.userLabel;
                            }
                        }
                        
                        // Aplicar logo
                        if (config.interface.logoSrc) {
                            const logoImg = document.getElementById('logoImage');
                            if (logoImg) {
                                logoImg.src = config.interface.logoSrc;
                            }
                        }
                    }
                    
                    // Aplicar mudan√ßas visuais
                    console.log('üîÑ Aplicando mudan√ßas visuais...');
                    
                    // Recarregar cores se h√° color picker
                    if (primaryColorPicker) {
                        // Disparar evento para atualizar cores autom√°ticas
                        primaryColorPicker.dispatchEvent(new Event('input', { bubbles: true }));
                    }
                    
                    // For√ßar atualiza√ß√£o da interface
                    setTimeout(() => {
                        // Recarregar favoritos se a fun√ß√£o existir
                        if (typeof loadUserFavorites === 'function') {
                            loadUserFavorites();
                        }
                        if (typeof updateFavoritesDisplay === 'function') {
                            updateFavoritesDisplay();
                        }
                        if (typeof updateFavoritesCounter === 'function') {
                            updateFavoritesCounter();
                        }
                        console.log('‚úÖ Interface atualizada!');
                    }, 300);
                    
                    alert('‚úÖ Backup restaurado com sucesso!\n\nüîÑ Recarregue a p√°gina se necess√°rio.');
                    
                    console.log('üì• Configura√ß√µes importadas:', config);
                    
                } catch (error) {
                    console.error('‚ùå Erro detalhado na importa√ß√£o:', error);
                    console.error('‚ùå Stack trace:', error.stack);
                    console.error('‚ùå Conte√∫do do arquivo:', e.target.result);
                    
                    // Mensagem de erro mais detalhada
                    const errorMessage = `‚ùå Erro ao importar configura√ß√µes:\n\n${error.message}\n\nDetalhes t√©cnicos:\n‚Ä¢ Tipo: ${error.name}\n‚Ä¢ Linha: ${error.lineNumber || 'N/A'}\n\nVerifique se:\n‚úì O arquivo √© um JSON v√°lido\n‚úì Foi exportado pelo mesmo sistema\n‚úì N√£o foi corrompido`;
                    alert(errorMessage);
                }
            };
            
            reader.readAsText(file);
            
            // Limpar input para permitir reimporta√ß√£o do mesmo arquivo
            event.target.value = '';
        }
        
            // Event listeners para export/import
            if (exportConfigBtn) {
                exportConfigBtn.addEventListener('click', exportAllConfigurations);
                console.log('‚úÖ Event listener do bot√£o EXPORT registrado!');
            } else {
                console.error('‚ùå Bot√£o exportConfigBtn n√£o encontrado!');
            }
            
            if (importConfigFile) {
                importConfigFile.addEventListener('change', importAllConfigurations);
                console.log('‚úÖ Event listener do input IMPORT registrado!');
            } else {
                console.error('‚ùå Input importConfigFile n√£o encontrado!');
            }

            // Event listener para gera√ß√£o de HTML para cliente
            const generateClientHtmlBtn = document.getElementById('generateClientHtmlBtn');
            if (generateClientHtmlBtn) {
                generateClientHtmlBtn.addEventListener('click', generateClientHTML);
                console.log('‚úÖ Event listener do bot√£o GERAR HTML registrado!');
            } else {
                console.error('‚ùå Bot√£o generateClientHtmlBtn n√£o encontrado!');
            }
        } // Fim da fun√ß√£o initializeExportImportSystem

        // ===== GERADOR ULTRA LIMPO - ZERO MODIFICA√á√ÉO DO DOM =====
        function generateClientHTML() {
            try {
                console.log('üéØ GERADOR DEFINITIVO - Funcionalidade + Personaliza√ß√µes!');
                
                const btn = document.getElementById('generateClientHtmlBtn');
                if (!btn) {
                    alert('‚ùå Bot√£o n√£o encontrado!');
                    return;
                }
                
                btn.textContent = '‚è≥ Coletando...';
                
                // === CAPTURAR PERSONALIZA√á√ïES ANTES DE GERAR ===
                const primaryColorPicker = document.getElementById('primaryColorPicker');
                const userLabel = document.getElementById('userTypeLabel');
                const logoImage = document.getElementById('logoImage');
                const userTypeLogo = document.getElementById('userTypeLogo');
                
                let cor = (primaryColorPicker && primaryColorPicker.value) || '#503060';
                
                // DEBUG - Captura mais robusta da cor
                console.log('üé® DEBUG CAPTURA DE COR:');
                console.log('- primaryColorPicker:', primaryColorPicker);
                console.log('- primaryColorPicker.value:', primaryColorPicker ? primaryColorPicker.value : 'N/A');
                console.log('- Cor inicial:', cor);
                
                // Se for cor padr√£o, tentar outras fontes
                if (!cor || cor === '#503060') {
                    console.log('üîç Tentando capturar cor de outras fontes...');
                    
                    // Tentar do CSS computado
                    try {
                        const computedStyle = getComputedStyle(document.documentElement);
                        const corCSS = computedStyle.getPropertyValue('--primary-color');
                        if (corCSS && corCSS.trim() !== '' && corCSS.trim() !== '#503060') {
                            cor = corCSS.trim();
                            console.log('- Cor do CSS:', cor);
                        }
                    } catch (e) {
                        console.warn('Erro ao ler CSS:', e);
                    }
                    
                    // Tentar de outros elementos visuais
                    const autoMainPreview = document.getElementById('autoMainPreview');
                    if (autoMainPreview && autoMainPreview.style.background) {
                        const bgColor = autoMainPreview.style.background;
                        const hexMatch = bgColor.match(/#[0-9a-fA-F]{6}/);
                        if (hexMatch && hexMatch[0] !== '#503060') {
                            cor = hexMatch[0];
                            console.log('- Cor do preview:', cor);
                        }
                    }
                }
                
                console.log('üéØ COR FINAL CAPTURADA:', cor);
                const texto = (userLabel && userLabel.textContent) || 'INDIVIDUAL';
                
                // Tentar capturar logo de m√∫ltiplas fontes
                let logoSrc = '';
                if (logoImage && logoImage.src && !logoImage.src.includes('blob:')) {
                    logoSrc = logoImage.src;
                } else if (userTypeLogo && userTypeLogo.src && !userTypeLogo.src.includes('blob:')) {
                    logoSrc = userTypeLogo.src;
                }
                
                // Verificar se logo personalizada foi salva no localStorage
                const savedLogo = localStorage.getItem('customLogo');
                if (!logoSrc && savedLogo) {
                    try {
                        const logoData = JSON.parse(savedLogo);
                        if (logoData.src && !logoData.src.includes('blob:')) {
                            logoSrc = logoData.src;
                        }
                    } catch (e) {
                        console.warn('Erro ao ler logo salva:', e);
                    }
                }
                
                console.log('üîç DEBUG CAPTURA:');
                console.log('- Color Picker:', primaryColorPicker, 'Valor:', cor);
                console.log('- User Label:', userLabel, 'Texto:', texto);
                console.log('- Logo Image:', logoImage, 'Src:', logoSrc);
                console.log('üìã Personaliza√ß√µes capturadas:', { cor, texto, logoSrc });
                
                // AGUARDAR DOM ESTAR COMPLETAMENTE PRONTO
                setTimeout(function() {
                    btn.textContent = '‚è≥ Gerando...';
                    console.log('üì∏ Capturando HTML funcional...');
                    
                    // === CAPTURA FUNCIONAL (IGUAL AO TESTE QUE FUNCIONOU) ===
                    let html = document.documentElement.outerHTML;
                    
                    console.log('üõ°Ô∏è Aplicando personaliza√ß√µes ULTRA CONSERVADORAS...');
                    
                    // === APLICA√á√ïES SEGURAS - ZERO RISCO ===
                    
                    // 1. T√çTULO (100% seguro) - APENAS nome do cliente
                    console.log('üè∑Ô∏è Aplicando t√≠tulo personalizado...');
                    const tituloAntes = html.match(/<title>[^<]*<\/title>/g);
                    html = html.replace(/<title>[^<]*<\/title>/g, '<title>' + texto + '</title>');
                    const tituloDepois = html.match(/<title>[^<]*<\/title>/g);
                    console.log('- Antes:', tituloAntes);
                    console.log('- Depois:', tituloDepois);
                    
                    // 1.5. TEXTO PERSONALIZADO (substituir INDIVIDUAL por texto personalizado)
                    if (texto !== 'INDIVIDUAL') {
                        console.log('üë§ Aplicando texto personalizado no conte√∫do...');
                        // Substituir em span, div e texto do usu√°rio (forma conservadora)
                        html = html.replace(/(<span[^>]*id="userTypeLabel"[^>]*>)[^<]*(<\/span>)/g, '$1' + texto + '$2');
                        html = html.replace(/(<div[^>]*class="[^"]*user-type[^"]*"[^>]*>)[^<]*(<\/div>)/g, '$1' + texto + '$2');
                        console.log('- Texto aplicado:', texto);
                    }
                    
                    // 2. CORES COMPLETAS - APLICA√á√ÉO FINAL
                    console.log('üé® === APLICANDO CORES COMPLETAS ===');
                    console.log('- Cor final a aplicar:', cor);
                    
                    // Gerar cores derivadas para gradiente de fundo
                    function hexToRgb(hex) {
                        const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                        return result ? {
                            r: parseInt(result[1], 16),
                            g: parseInt(result[2], 16),
                            b: parseInt(result[3], 16)
                        } : { r: 80, g: 48, b: 96 };
                    }
                    
                    function rgbToHex(r, g, b) {
                        return "#" + [r, g, b].map(x => {
                            const hex = Math.max(0, Math.min(255, Math.round(x))).toString(16);
                            return hex.length === 1 ? "0" + hex : hex;
                        }).join("");
                    }
                    
                    const rgb = hexToRgb(cor);
                    // Criar GRADIENTE ESCURO na tonalidade escolhida (como o roxo original)
                    const corEscuraInicio = rgbToHex(rgb.r * 0.5, rgb.g * 0.5, rgb.b * 0.5); // 50% mais escuro
                    const corEscuraFim = rgbToHex(rgb.r * 0.3, rgb.g * 0.3, rgb.b * 0.3);    // 70% mais escuro
                    
                    console.log('üé® CORES CALCULADAS:');
                    console.log('- Cor principal:', cor);
                    console.log('- RGB:', rgb);
                    console.log('- Cor escura in√≠cio:', corEscuraInicio);
                    console.log('- Cor escura fim:', corEscuraFim);
                    
                    // === BUSCAR E SUBSTITUIR TODAS AS CORES DE FUNDO ===
                    
                    // 1. Vari√°veis CSS tradicionais
                    console.log('üîç Procurando vari√°veis CSS...');
                    const coresAntes = html.match(/(--primary-color\s*:\s*)#[0-9a-fA-F]{6}/g);
                    console.log('- --primary-color encontradas:', coresAntes);
                    html = html.replace(/(--primary-color\s*:\s*)#[0-9a-fA-F]{6}/g, '$1' + cor);
                    
                    // 2. *** VARI√ÅVEIS DO GRADIENTE DE FUNDO ***
                    console.log('üåà Procurando vari√°veis de gradiente...');
                    const gradienteStartAntes = html.match(/(--color-primary-start\s*:\s*)#[0-9a-fA-F]{6}/g);
                    const gradienteEndAntes = html.match(/(--color-primary-end\s*:\s*)#[0-9a-fA-F]{6}/g);
                    console.log('- --color-primary-start encontradas:', gradienteStartAntes);
                    console.log('- --color-primary-end encontradas:', gradienteEndAntes);
                    
                    html = html.replace(/(--color-primary-start\s*:\s*)#[0-9a-fA-F]{6}/g, '$1' + corEscuraInicio);
                    html = html.replace(/(--color-primary-end\s*:\s*)#[0-9a-fA-F]{6}/g, '$1' + corEscuraFim);
                    
                    // 3. *** CORES HARDCODED NO CSS ***
                    console.log('üéØ Substituindo cores hardcoded...');
                    // Substituir #503060 e #3B204A diretamente no CSS
                    const roxoAntes = (html.match(/#503060/g) || []).length;
                    const roxoEscuroAntes = (html.match(/#3B204A/g) || []).length;
                    console.log('- #503060 encontradas:', roxoAntes);
                    console.log('- #3B204A encontradas:', roxoEscuroAntes);
                    
                    html = html.replace(/#503060/g, corEscuraInicio);
                    html = html.replace(/#3B204A/g, corEscuraFim);
                    
                    // *** 3.5. FOR√áAR BACKGROUND INLINE NO BODY E HTML ***
                    console.log('üé® FOR√áANDO background inline COMPLETO...');
                    
                    // 1. FOR√áAR NO ELEMENTO HTML
                    const htmlStyleMatch = html.match(/<html[^>]*style="([^"]*)"[^>]*>/);
                    if (htmlStyleMatch) {
                        console.log('- HTML com style encontrado');
                        let htmlStyle = htmlStyleMatch[1];
                        htmlStyle = htmlStyle.replace(/--color-primary-start[^;]*;?/g, '');
                        htmlStyle = htmlStyle.replace(/--color-primary-end[^;]*;?/g, '');
                        htmlStyle += `--color-primary-start: ${corEscuraInicio} !important; --color-primary-end: ${corEscuraFim} !important;`;
                        
                        const newHtmlTag = htmlStyleMatch[0].replace(/style="[^"]*"/, `style="${htmlStyle}"`);
                        html = html.replace(htmlStyleMatch[0], newHtmlTag);
                        console.log('- HTML style atualizado');
                    } else {
                        // Se n√£o tem style no HTML, adicionar
                        html = html.replace(/<html([^>]*)>/, `<html$1 style="--color-primary-start: ${corEscuraInicio} !important; --color-primary-end: ${corEscuraFim} !important;">`);
                        console.log('- HTML style adicionado');
                    }
                    
                    // 2. FOR√áAR NO ELEMENTO BODY
                    const bodyStyleMatch = html.match(/<body[^>]*style="([^"]*)"[^>]*>/);
                    if (bodyStyleMatch) {
                        console.log('- Body com style encontrado:', bodyStyleMatch[0]);
                        let bodyStyle = bodyStyleMatch[1];
                        
                        // Remover backgrounds existentes
                        bodyStyle = bodyStyle.replace(/background[^;]*;?/g, '');
                        
                        // Adicionar background GRADIENTE ESCURO
                        bodyStyle += `background-image: linear-gradient(to bottom, ${corEscuraInicio}, ${corEscuraFim}) !important; background-color: ${corEscuraFim} !important;`;
                        
                        const newBodyTag = bodyStyleMatch[0].replace(/style="[^"]*"/, `style="${bodyStyle}"`);
                        html = html.replace(bodyStyleMatch[0], newBodyTag);
                        
                        console.log('- Body style atualizado:', bodyStyle);
                    } else {
                        // Se n√£o tem style, adicionar
                        console.log('- Body sem style - adicionando...');
                        html = html.replace(/<body([^>]*)>/, `<body$1 style="background-image: linear-gradient(to bottom, ${corEscuraInicio}, ${corEscuraFim}) !important; background-color: ${corEscuraFim} !important;">`);
                    }
                    
                    // *** 4. ABORDAGEM NUCLEAR - CSS OVERRIDE COMPLETO ***
                    console.log('üí• APLICANDO GRADIENTE ESCURO + HEADER PERSONALIZADO!');
                    
                    // Adicionar CSS override no final do <head>
                    const cssNuclear = `
                    <style id="nuclear-background-override">
                    /* OVERRIDE NUCLEAR - GRADIENTE ESCURO + HEADER */
                    :root {
                        --color-primary-start: ${corEscuraInicio} !important;
                        --color-primary-end: ${corEscuraFim} !important;
                        --primary-color: ${cor} !important;
                        --color-header-bg: ${cor} !important;
                    }
                    
                    html, body {
                        background-image: linear-gradient(to bottom, ${corEscuraInicio}, ${corEscuraFim}) !important;
                        background-color: ${corEscuraFim} !important;
                    }
                    
                    /* HEADER na cor escolhida */
                    header {
                        background-color: ${cor} !important;
                        background: ${cor} !important;
                    }
                    
                    /* Elementos do header */
                    header .menu-toggle,
                    header h3,
                    header #headerTitle,
                    header button {
                        color: white !important;
                    }
                    
                    /* Sidebar na tonalidade escura */
                    aside {
                        background: ${corEscuraInicio} !important;
                        border-right: 1px solid ${cor} !important;
                    }
                    
                    /* For√ßar todos os elementos principais */
                    main, .main-content, #main, .content-area {
                        background: transparent !important;
                    }
                    
                    /* Remover backgrounds conflitantes exceto do body */
                    main *, .content-area * {
                        background-image: none !important;
                    }
                    
                    /* GARANTIR gradiente escuro no body */
                    body {
                        background-image: linear-gradient(to bottom, ${corEscuraInicio}, ${corEscuraFim}) !important;
                        background-attachment: fixed !important;
                    }
                    </style>
                    `;
                    
                    // Inserir antes do </head>
                    html = html.replace('</head>', cssNuclear + '</head>');
                    console.log('üí• Gradiente escuro na tonalidade aplicado!');
                    
                    // 5. VERIFICA√á√ÉO FINAL
                    const coresDepois = html.match(/(--primary-color\s*:\s*#[0-9a-fA-F]{6}|--color-primary-start\s*:\s*#[0-9a-fA-F]{6}|--color-primary-end\s*:\s*#[0-9a-fA-F]{6})/g);
                    const roxoDepois = (html.match(/#503060/g) || []).length;
                    const roxoEscuroDepois = (html.match(/#3B204A/g) || []).length;
                    
                    console.log('‚úÖ RESULTADO FINAL:');
                    console.log('- Vari√°veis CSS depois:', coresDepois);
                    console.log('- #503060 restantes:', roxoDepois);
                    console.log('- #3B204A restantes:', roxoEscuroDepois);
                    console.log('- Gradiente escuro na tonalidade inserido: SIM');
                    
                    // 2.5. LOGO E FAVICON - APLICAR APENAS SE EXISTIR E FOR V√ÅLIDA
                    console.log('üîç Verificando logo personalizada...');
                    console.log('- Logo src atual:', logoSrc);
                    console.log('- √â v√°lida?', logoSrc && logoSrc !== '');
                    console.log('- N√£o √© blob?', !logoSrc.includes('blob:'));
                    console.log('- √â URL v√°lida?', logoSrc.startsWith('http') || logoSrc.startsWith('data:'));
                    
                    // Aceitar URLs http/https e data URIs (base64)
                    if (logoSrc && logoSrc !== '' && !logoSrc.includes('blob:') && (logoSrc.startsWith('http') || logoSrc.startsWith('data:'))) {
                        console.log('üñºÔ∏è Aplicando logo personalizada:', logoSrc);
                        
                        // Debug - verificar logos antes da substitui√ß√£o
                        const logosBefore = html.match(/(id="(?:logoImage|userTypeLogo)"[^>]*)/g);
                        console.log('- Logos encontradas antes:', logosBefore);
                        
                        // Substituir src das imagens de logo (forma mais robusta)
                        let logoModificada = false;
                        
                        // Logo principal
                        if (html.includes('id="logoImage"')) {
                            html = html.replace(/(id="logoImage"[^>]*src=")[^"]*(")/g, '$1' + logoSrc + '$2');
                            logoModificada = true;
                            console.log('- Logo principal substitu√≠da!');
                        }
                        
                        // Logo do usu√°rio  
                        if (html.includes('id="userTypeLogo"')) {
                            html = html.replace(/(id="userTypeLogo"[^>]*src=")[^"]*(")/g, '$1' + logoSrc + '$2');
                            logoModificada = true;
                            console.log('- Logo do usu√°rio substitu√≠da!');
                        }
                        
                        // Debug - verificar logos ap√≥s substitui√ß√£o
                        const logosAfter = html.match(/(id="(?:logoImage|userTypeLogo)"[^>]*)/g);
                        console.log('- Logos ap√≥s substitui√ß√£o:', logosAfter);
                        console.log('- Logo foi modificada?', logoModificada);
                    } else {
                        console.log('üñºÔ∏è Logo n√£o aplicada - usando padr√£o');
                    }
                    
                    // === AJUSTE DE TAMANHO DO LOGO DO USU√ÅRIO (SEMPRE APLICAR) ===
                    console.log('üìè Ajustando tamanho do logo do usu√°rio para 40px...');
                    if (html.includes('id="userTypeLogo"')) {
                        // Ajustar tamanho do logo do usu√°rio para 100% maior (40px)
                        html = html.replace(/(id="userTypeLogo"[^>]*style="[^"]*width:\s*)20px([^"]*height:\s*)20px/g, '$140px$240px');
                        console.log('- Tamanho do logo ajustado: 20px ‚Üí 40px');
                    }
                    
                    // === FAVICON PERSONALIZADO ===
                    if (logoSrc && logoSrc !== '' && !logoSrc.includes('blob:') && (logoSrc.startsWith('http') || logoSrc.startsWith('data:'))) {
                        console.log('üéØ Aplicando favicon personalizado com a mesma logo!');
                        
                        // Debug - verificar favicons existentes
                        const faviconsAntes = html.match(/<link[^>]*rel="[^"]*icon[^"]*"[^>]*>/g);
                        console.log('- Favicons encontrados:', faviconsAntes);
                        
                        // Aplicar favicon personalizado com a mesma logo
                        let faviconModificado = false;
                        
                        // Substituir TODOS os tipos de favicon (regex mais abrangente)
                        
                        // 1. Favicons com rel="icon" (incluindo sizes)
                        const iconMatches = html.match(/<link[^>]*rel="icon"[^>]*>/g);
                        if (iconMatches) {
                            console.log('- √çcones "icon" encontrados:', iconMatches.length);
                            html = html.replace(/(<link[^>]*rel="icon"[^>]*href=")[^"]*(")/g, '$1' + logoSrc + '$2');
                            faviconModificado = true;
                        }
                        
                        // 2. Shortcut icons
                        const shortcutMatches = html.match(/<link[^>]*rel="shortcut icon"[^>]*>/g);
                        if (shortcutMatches) {
                            console.log('- √çcones "shortcut" encontrados:', shortcutMatches.length);
                            html = html.replace(/(<link[^>]*rel="shortcut icon"[^>]*href=")[^"]*(")/g, '$1' + logoSrc + '$2');
                            faviconModificado = true;
                        }
                        
                        // 3. Apple touch icons
                        const appleMatches = html.match(/<link[^>]*rel="apple-touch-icon"[^>]*>/g);
                        if (appleMatches) {
                            console.log('- √çcones "apple-touch" encontrados:', appleMatches.length);
                            html = html.replace(/(<link[^>]*rel="apple-touch-icon"[^>]*href=")[^"]*(")/g, '$1' + logoSrc + '$2');
                            faviconModificado = true;
                        }
                        
                        // Se n√£o existir favicon, adicionar um novo
                        if (!faviconModificado) {
                            console.log('- Nenhum favicon encontrado, criando novo...');
                            html = html.replace(/(<head[^>]*>)/g, '$1\n    <link rel="icon" type="image/png" href="' + logoSrc + '">\n    <link rel="shortcut icon" type="image/png" href="' + logoSrc + '">');
                        }
                        
                        // Debug - verificar favicons ap√≥s modifica√ß√£o
                        const faviconsDepois = html.match(/<link[^>]*rel="[^"]*icon[^"]*"[^>]*>/g);
                        console.log('- Favicons ap√≥s modifica√ß√£o:', faviconsDepois);
                        console.log('- Total de favicons modificados:', faviconModificado ? (faviconsDepois ? faviconsDepois.length : 0) : 0);
                    }
                    
                    // 3. APENAS OCULTAR BOT√ÉO (n√£o remover nada)
                    html = html.replace(/(<button[^>]*id="generateClientHtmlBtn"[^>]*style="[^"]*)/g, '$1; display: none');
                    html = html.replace(/(<button[^>]*id="generateClientHtmlBtn"[^>]*)((?!style)[^>]*>)/g, '$1 style="display: none"$2');
                    
                    console.log('‚úÖ Personaliza√ß√µes M√çNIMAS aplicadas - JavaScript 100% intacto!');
                    
                    // === RESUMO FINAL DAS MODIFICA√á√ïES ===
                    console.log('üìä RESUMO FINAL:');
                    console.log('- T√≠tulo personalizado:', texto);
                    console.log('- Cor personalizada:', cor);
                    console.log('- Logo personalizada:', logoSrc ? 'SIM' : 'N√ÉO');
                    console.log('- Logo do usu√°rio tamanho:', '40px (100% maior)');
                    console.log('- Favicons modificados:', logoSrc ? 'SIM' : 'N√ÉO');
                    
                    // === DOWNLOAD IMEDIATO ===
                    const nome = texto.replace(/\s+/g, '_') + '_PERSONALIZADO_' + new Date().toISOString().split('T')[0] + '.html';
                    
                    const blob = new Blob([html], { type: 'text/html' });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = nome;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    
                    btn.textContent = '‚úÖ Gerado!';
                    setTimeout(function() {
                        btn.textContent = 'üì¶ Gerar';
                    }, 3000);
                    
                    alert('üéØ ARQUIVO PERSONALIZADO CRIADO!\n\nüìÑ Arquivo: ' + nome + '\nüé® Cor: ' + cor + '\nüë§ Texto: ' + texto + '\nüñºÔ∏è Logo: ' + (logoSrc ? 'Personalizada' : 'Padr√£o') + '\nüìè Logo do usu√°rio: 40px (100% maior)\nüéØ Favicon: ' + (logoSrc ? 'Mesmo da logo!' : 'Padr√£o') + '\n\n‚úÖ Funcionalidade 100% preservada!\nüé® Personaliza√ß√µes hardcoded!\nüöÄ Pronto para entrega!');
                    
                }, 1000); // Apenas 1 segundo
                
            } catch (error) {
                console.error('‚ùå ERRO:', error);
                const btn = document.getElementById('generateClientHtmlBtn');
                if (btn) {
                    btn.textContent = '‚ùå ERRO!';
                    setTimeout(() => btn.textContent = 'üì¶ Gerar', 3000);
                }
                alert('‚ùå ERRO: ' + error.message);
            }
        }
        
        // Fun√ß√£o auxiliar para converter hex para rgb
        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            } : { r: 80, g: 48, b: 96 }; // Fallback para cor padr√£o
        }
        
        // ===== SISTEMA DE LOGO EDIT√ÅVEL =====
        const supportLogo = document.getElementById('supportLogo');
        const logoImage = document.getElementById('logoImage');
        
        // Fun√ß√£o para carregar logo salva
        function loadSavedLogo() {
            const savedLogo = localStorage.getItem('customLogo');
            if (savedLogo && logoImage) {
                try {
                    const logoData = JSON.parse(savedLogo);
                    logoImage.src = logoData.src;
                    logoImage.alt = logoData.alt || 'Logo';
                    
                    // Sincronizar com o logo do usu√°rio
                    const userTypeLogo = document.getElementById('userTypeLogo');
                    if (userTypeLogo) {
                        userTypeLogo.src = logoData.src;
                        userTypeLogo.alt = logoData.alt || 'User Logo';
                    }
                    
                    // Atualizar header sempre (modo normal ou edi√ß√£o)
                    updateHeaderWithCustomLogo();
                } catch (error) {
                    console.error('Erro ao carregar logo salva:', error);
                }
            }
        }
        
        // Fun√ß√£o para salvar logo
        function saveLogo(src, alt) {
            const logoData = { src, alt };
            localStorage.setItem('customLogo', JSON.stringify(logoData));
            
            // Sincronizar com o logo do usu√°rio
            const userTypeLogo = document.getElementById('userTypeLogo');
            if (userTypeLogo) {
                userTypeLogo.src = src;
                userTypeLogo.alt = alt || 'User Logo';
            }
            
            // Atualizar header sempre (modo normal ou edi√ß√£o)
            updateHeaderWithCustomLogo();
        }
        
        // Fun√ß√£o para ativar/desativar edi√ß√£o da logo
        function toggleLogoEditMode(isEditMode) {
            if (isEditMode) {
                supportLogo.classList.add('editable');
                supportLogo.addEventListener('click', openLogoSelector);
            } else {
                supportLogo.classList.remove('editable');
                supportLogo.removeEventListener('click', openLogoSelector);
            }
        }
        
        // Fun√ß√£o para abrir seletor de logo
        function openLogoSelector() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        logoImage.src = e.target.result;
                        saveLogo(e.target.result, file.name);
                        
                        // Feedback visual
                        supportLogo.style.transform = 'scale(1.1)';
                        setTimeout(() => {
                            supportLogo.style.transform = '';
                        }, 300);
                        
                        console.log('üñºÔ∏è Logo alterada:', file.name);
                    };
                    reader.readAsDataURL(file);
                }
            };
            
            input.click();
        }
        
        // Integrar com o modo de edi√ß√£o existente
        // Assumindo que existe uma fun√ß√£o de toggle do modo de edi√ß√£o
        const editToggle = document.getElementById('editModeToggle');
        if (editToggle) {
            editToggle.addEventListener('change', function() {
                const isEditMode = this.checked;
                toggleLogoEditMode(isEditMode);
                
                // Atualizar tamb√©m a edi√ß√£o do texto do usu√°rio
                const userLabel = document.getElementById('userTypeLabel');
                if (userLabel) {
                    if (isEditMode) {
                        enableUserTypeEditing();
                    } else {
                        disableUserTypeEditing();
                    }
                }
            });
        }
        
        // Carregar logo salva na inicializa√ß√£o
        loadSavedLogo();
        
        // Carregar cores salvas na inicializa√ß√£o
        loadSavedColors();
        
        // Atualizar header com logo sempre (modo normal ou edi√ß√£o)
        setTimeout(() => {
            updateHeaderWithCustomLogo();
        }, 100);
        
        // ===== AUTO-CARREGAMENTO DE CORES NA INICIALIZA√á√ÉO =====
        function initializeColorSystem() {
            console.log('üé® Inicializando sistema de cores...');
            
            // Carregar cores salvas
            const savedColors = localStorage.getItem('customColors');
            if (savedColors) {
                try {
                    const colors = JSON.parse(savedColors);
                    console.log('üîÑ Cores encontradas no localStorage:', colors);
                    
                    // Aplicar cor prim√°ria
                    if (colors.primary && primaryColorPicker) {
                        primaryColorPicker.value = colors.primary;
                        console.log('üé® Cor prim√°ria aplicada:', colors.primary);
                        
                        // Disparar evento para aplicar cores automaticamente
                        primaryColorPicker.dispatchEvent(new Event('input', { bubbles: true }));
                    }
                    
                    // Aplicar modo de contraste
                    if (colors.contrastMode === 'manual' && colors.manualTextColor) {
                        console.log('üéØ Aplicando contraste manual:', colors.manualTextColor);
                        // As fun√ß√µes de contraste j√° est√£o sendo carregadas
                    }
                    
                    console.log('‚úÖ Sistema de cores inicializado com sucesso!');
                    
                } catch (error) {
                    console.error('‚ùå Erro ao carregar cores salvas:', error);
                }
            } else {
                console.log('‚ÑπÔ∏è Nenhuma cor personalizada salva, usando padr√£o');
            }
        }
        
        // Executar inicializa√ß√£o de cores
        setTimeout(() => {
            initializeColorSystem();
        }, 200);
        
        console.log('‚úÖ Sistema de Export/Import + Logo Edit√°vel + Auto-Save de Cores inicializado!');

        // ===== SISTEMA DE BUSCA DE TREINAMENTOS =====
        function openTrainingSearchModal() {
            console.log('üîç Abrindo modal de busca de treinamentos...');
            const modal = document.getElementById('trainingSearchModal');
            if (modal) {
                modal.classList.remove('hidden');
                console.log('‚úÖ Modal aberto com sucesso');
                
                // Garantir que os eventos estejam inicializados
                ensureTrainingEventsInitialized();
            } else {
                console.error('‚ùå Modal n√£o encontrado!');
            }
        }

        function closeTrainingSearchModal() {
            document.getElementById('trainingSearchModal').classList.add('hidden');
            // Limpar resultados ao fechar
            document.getElementById('trainingSearchResults').innerHTML = '<p style="color: #ccc; text-align: center; margin-top: 50px;">Digite algo para buscar ou clique em uma categoria acima</p>';
            document.getElementById('trainingSearchInput').value = '';
            // Remover classe active dos filtros
            document.querySelectorAll('.training-filter-btn').forEach(btn => btn.classList.remove('active'));
            // Limpar resultados armazenados
            window.currentSearchResults = null;
            console.log('üßπ Modal de busca fechado e dados limpos');
        }

        async function searchTrainings(query, isFilter = false, forceAllCategories = false) {
            console.log('üîç searchTrainings chamada com:', { query, isFilter, forceAllCategories });
            
            const resultsContainer = document.getElementById('trainingSearchResults');
            if (!resultsContainer) {
                console.error('‚ùå Container de resultados n√£o encontrado!');
                return;
            }
            
            resultsContainer.innerHTML = '<p style="color: #ccc; text-align: center;">üîç Buscando...</p>';

            try {
                console.log('üì° Iniciando busca na API IPED...');
                console.log('üîë Token:', apiToken ? 'Presente' : 'Ausente');
                console.log('üåê URL Categorias:', categoryUrl);
                
                // Usar todas as categorias da API IPED
                const fd = new FormData();
                fd.append('token', apiToken);
                fd.append('all_formats', 'true');
                
                const categoryRes = await fetch(categoryUrl, { method: 'POST', body: fd });
                console.log('üìä Resposta categorias:', categoryRes.status, categoryRes.ok);
                
                const categoryData = await categoryRes.json();
                console.log('üìã Dados categorias:', categoryData);
                
                if (!categoryData.CATEGORIES) {
                    throw new Error('Erro ao carregar categorias');
                }

                let allCourses = [];
                let relevantCategories = 0;
                
                // Verificar se deve buscar em todas as categorias
                // APENAS quando bot√£o "Buscar em Todas" for clicado
                const searchAllCategories = forceAllCategories;
                
                if (searchAllCategories) {
                    console.log('üåê BUSCA EM TODAS AS CATEGORIAS ativada pelo bot√£o!');
                } else {
                    console.log('üîç Busca nas categorias empresariais:', relevantKeywordsFor50Plus);
                }
                
                // Buscar cursos das categorias
                for (const category of categoryData.CATEGORIES) {
                    const categoryTitle = category.category_title.toLowerCase();
                    let isRelevant = false;
                    
                    if (searchAllCategories) {
                        // Se busca geral, incluir TODAS as categorias
                        isRelevant = true;
                        console.log(`üåê Incluindo categoria (busca geral): "${category.category_title}"`);
                    } else {
                        // Se busca filtrada, usar palavras-chave espec√≠ficas
                        isRelevant = relevantKeywordsFor50Plus.some(keyword => categoryTitle.includes(keyword));
                        if (isRelevant) {
                            console.log(`‚úÖ Categoria relevante encontrada: "${category.category_title}"`);
                        }
                    }
                    
                    if (isRelevant) {
                        relevantCategories++;
                        
                        try {
                            const coursesFd = new FormData();
                            coursesFd.append('token', apiToken);
                            coursesFd.append('category_id', category.category_id);
                            coursesFd.append('all_formats', 'true');
                            
                            const coursesRes = await fetch(coursesUrl, { method: 'POST', body: coursesFd });
                            const coursesData = await coursesRes.json();
                            
                            if (coursesData.COURSES) {
                                console.log(`üìö ${coursesData.COURSES.length} cursos encontrados em "${category.category_title}"`);
                                coursesData.COURSES.forEach(course => {
                                    course.category_name = category.category_title;
                                });
                                allCourses = allCourses.concat(coursesData.COURSES);
                            }
                        } catch (error) {
                            console.warn('‚ö†Ô∏è Erro ao buscar cursos da categoria:', category.category_title, error);
                        }
                    }
                }

                if (searchAllCategories) {
                    console.log(`üìä BUSCA GERAL: ${relevantCategories} categorias (TODAS), ${allCourses.length} cursos encontrados`);
                } else {
                    console.log(`üìä BUSCA FILTRADA: ${relevantCategories} categorias relevantes, ${allCourses.length} cursos encontrados`);
                }

                // Filtrar e ordenar cursos por relev√¢ncia
                let filteredCourses = allCourses;
                if (query) {
                    const searchTerms = query.toLowerCase().split(' ');
                    
                    // Filtrar e calcular relev√¢ncia
                    filteredCourses = allCourses.filter(course => {
                        const searchText = (course.course_title + ' ' + course.course_description + ' ' + course.category_name).toLowerCase();
                        return searchTerms.some(term => searchText.includes(term));
                    }).map(course => {
                        // Calcular pontua√ß√£o de relev√¢ncia
                        let relevanceScore = 0;
                        const titleLower = course.course_title.toLowerCase();
                        const descriptionLower = (course.course_description || '').toLowerCase();
                        const categoryLower = course.category_name.toLowerCase();
                        
                        searchTerms.forEach(term => {
                            // Pontua√ß√£o maior para matches no t√≠tulo
                            if (titleLower.includes(term)) {
                                relevanceScore += titleLower.indexOf(term) === 0 ? 100 : 50; // In√≠cio do t√≠tulo = mais relevante
                            }
                            // Pontua√ß√£o m√©dia para matches na descri√ß√£o
                            if (descriptionLower.includes(term)) {
                                relevanceScore += 20;
                            }
                            // Pontua√ß√£o menor para matches na categoria
                            if (categoryLower.includes(term)) {
                                relevanceScore += 10;
                            }
                            // B√¥nus para match exato
                            if (titleLower === term || titleLower.includes(' ' + term + ' ')) {
                                relevanceScore += 200;
                            }
                        });
                        
                        return { ...course, relevanceScore };
                    }).sort((a, b) => b.relevanceScore - a.relevanceScore); // Ordenar por relev√¢ncia (maior primeiro)
                    
                    console.log(`üéØ Filtros aplicados: ${filteredCourses.length} cursos encontrados e ordenados por relev√¢ncia para "${query}"`);
                }

                // Renderizar resultados
                renderTrainingResults(filteredCourses, query, isFilter, searchAllCategories);

            } catch (error) {
                console.error('‚ùå Erro na busca de treinamentos:', error);
                resultsContainer.innerHTML = '<p style="color: #ff6b6b; text-align: center;">‚ùå Erro na busca. Tente novamente.<br><small>' + error.message + '</small></p>';
            }
        }

        function renderTrainingResults(courses, query, isFilter, isAllCategoriesSearch = false) {
            const resultsContainer = document.getElementById('trainingSearchResults');
            
            if (courses.length === 0) {
                let noResultsMsg = `üîç Nenhum treinamento encontrado para "${query}"`;
                if (isAllCategoriesSearch) {
                    noResultsMsg = `üåê Nenhum treinamento encontrado em todas as categorias da plataforma`;
                } else {
                    // Sugerir busca ampliada quando n√£o encontrar nada nas categorias empresariais
                    noResultsMsg += `
                        <br><br>
                        <div style="background: rgba(33, 150, 243, 0.1); border: 1px solid rgba(33, 150, 243, 0.3); border-radius: 8px; padding: 15px; margin-top: 20px; text-align: left;">
                            <h4 style="color: #2196F3; margin: 0 0 10px 0;">üí° N√£o encontrou o que procura?</h4>
                            <p style="color: #ccc; margin: 0 0 10px 0; font-size: 14px;">Buscamos apenas nas √°reas empresariais. Clique no bot√£o abaixo para ampliar:</p>
                            <p style="color: #64B5F6; margin: 0; font-weight: bold;">üåê "Buscar em Todas" ‚Üí Expande para todas as categorias da plataforma</p>
                        </div>
                    `;
                }
                resultsContainer.innerHTML = `<p style="color: #ccc; text-align: center; margin-top: 30px;">${noResultsMsg}</p>`;
                return;
            }

            let html = '';
            
            // Cabe√ßalho baseado no tipo de busca
            if (isAllCategoriesSearch) {
                html += `
                    <div style="background: rgba(33, 150, 243, 0.1); border: 1px solid rgba(33, 150, 243, 0.3); border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                        <h3 style="color: #2196F3; margin: 0 0 10px 0;">üåê Busca Ampliada - Todas as Categorias</h3>
                        <p style="color: #ccc; margin: 0; font-size: 14px;">Resultado: ${courses.length} treinamentos de TODAS as categorias da plataforma IPED</p>
                        <p style="color: #64B5F6; margin: 5px 0 0 0; font-size: 12px;">üí° Escopo ampliado para encontrar qualquer conte√∫do dispon√≠vel</p>
                    </div>
                `;
            } else {
                html += `
                    <div style="margin-bottom: 15px;">
                        <h3 style="color: #fff; margin: 0 0 10px 0;">üìö ${courses.length} treinamentos encontrados</h3>
                        <p style="color: #999; font-size: 13px; margin: 0 0 5px 0;">Busca nas √°reas: üè¢ Gest√£o ‚Ä¢ üí∞ Vendas ‚Ä¢ üì¢ Marketing ‚Ä¢ üìû Atendimento ‚Ä¢ üõ†Ô∏è Suporte</p>
                        ${query ? '<p style="color: #64B5F6; font-size: 12px; margin: 0;">‚ú® Resultados ordenados por relev√¢ncia (mais pr√≥ximos do termo buscado primeiro)</p>' : ''}
                    </div>
                `;
            }
            
            courses.forEach((course, index) => {
                // Limpar t√≠tulo removendo "Curso de", "Curso sobre", etc.
                let cleanTitle = course.course_title;
                const titlePrefixes = [
                    'Curso de ',
                    'Curso sobre ',
                    'Curso: ',
                    'Treinamento de ',
                    'Treinamento sobre ',
                    'Treinamento: ',
                    'Workshop de ',
                    'Workshop: '
                ];
                
                titlePrefixes.forEach(prefix => {
                    if (cleanTitle.toLowerCase().startsWith(prefix.toLowerCase())) {
                        cleanTitle = cleanTitle.substring(prefix.length);
                    }
                });
                
                // Destacar termos de busca no t√≠tulo e descri√ß√£o (apenas se houver query)
                let highlightedTitle = cleanTitle;
                let highlightedDescription = course.course_description || 'Sem descri√ß√£o dispon√≠vel';
                
                if (query && query.trim() !== '' && query !== 'todas') {
                    const searchTerms = query.toLowerCase().split(' ').filter(term => term.length > 2);
                    searchTerms.forEach(term => {
                        // Escapar caracteres especiais do regex
                        const escapedTerm = term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                        const regex = new RegExp(`\\b(${escapedTerm})`, 'gi');
                        highlightedTitle = highlightedTitle.replace(regex, '<mark style="background: rgba(255, 235, 59, 0.3); color: #fff; padding: 1px 3px; border-radius: 3px;">$1</mark>');
                        highlightedDescription = highlightedDescription.replace(regex, '<mark style="background: rgba(255, 235, 59, 0.3); color: #fff; padding: 1px 3px; border-radius: 3px;">$1</mark>');
                    });
                }
                
                // Escapar dados para uso seguro no onclick
                const safeTitle = course.course_title.replace(/'/g, "\\'").replace(/"/g, '\\"');
                const safeDescription = (course.course_description || 'Sem descri√ß√£o dispon√≠vel').replace(/'/g, "\\'").replace(/"/g, '\\"');
                const safeCategoryName = course.category_name.replace(/'/g, "\\'").replace(/"/g, '\\"');
                
                html += `
                    <div class="training-result-item" onclick="selectTrainingCourseFromSearch(${index})">
                        <div class="training-result-title">${highlightedTitle}</div>
                        <div class="training-result-description">${highlightedDescription}</div>
                        <div class="training-result-meta">
                            <span>üìÅ ${course.category_name}</span>
                            <span>‚è±Ô∏è ${course.course_time || 'Dura√ß√£o n√£o informada'}</span>
                            <span>üéØ ${course.course_format || 'Formato padr√£o'}</span>
                        </div>
                    </div>
                `;
            });
            
            // Armazenar os cursos globalmente para acesso via √≠ndice
            window.currentSearchResults = courses;

            resultsContainer.innerHTML = html;
        }

        function selectTrainingCourseFromSearch(courseIndex) {
            console.log('üéØ Selecionando curso pelo √≠ndice:', courseIndex);
            
            if (!window.currentSearchResults || !window.currentSearchResults[courseIndex]) {
                console.error('‚ùå Dados do curso n√£o encontrados!');
                return;
            }
            
            const course = window.currentSearchResults[courseIndex];
            console.log('üìã Dados completos do curso:', course);
            
            selectTrainingCourse(course.course_id, course.course_title, course);
        }

        function selectTrainingCourse(courseId, courseTitle, courseData = null) {
            console.log('üéØ Curso selecionado via busca:', courseId, courseTitle);
            
            // Fechar modal de busca
            closeTrainingSearchModal();
            
            // Criar objeto do curso no formato esperado pelo sistema de curadoria
            const courseObject = {
                course_id: courseId,
                course_title: courseTitle,
                course_description: courseData?.course_description || 'Curso encontrado via busca inteligente',
                course_time: courseData?.course_time || 'A definir',
                course_format: courseData?.course_format || 'Online',
                category_name: courseData?.category_name || 'Busca de Treinamentos',
                course_url: courseData?.course_url || '',
                course_image: courseData?.course_image || 'https://d1yei2z3i6k35z.cloudfront.net/12974529/684d9ab360bc7_GERiAHLOGO8SQUARE2donwload.png',
                // Propriedades adicionais que podem estar na API
                course_instructor: courseData?.course_instructor || '',
                course_level: courseData?.course_level || '',
                course_language: courseData?.course_language || 'Portugu√™s',
                course_rating: courseData?.course_rating || '',
                course_price: courseData?.course_price || 'Gratuito'
            };

            console.log('üìã Abrindo modal de curadoria para:', courseObject);
            
            // Usar o sistema de curadoria existente
            if (typeof promptCurate === 'function') {
                promptCurate(courseObject);
            } else {
                console.error('‚ùå Fun√ß√£o promptCurate n√£o encontrada!');
                alert('Erro: Sistema de curadoria n√£o dispon√≠vel.');
                return;
            }
            
            // Feedback visual opcional
            const container = document.getElementById('coursesContainer');
            if (container) {
                container.innerHTML = `
                    <h2 class="category-title-header">üéØ Curso Selecionado via Busca</h2>
                    <div style="background: rgba(76, 175, 80, 0.1); border: 1px solid rgba(76, 175, 80, 0.3); border-radius: 8px; padding: 20px; margin-top: 20px;">
                        <h3 style="color: #4CAF50; margin: 0 0 10px 0;">‚úÖ ${courseTitle}</h3>
                        <p style="color: #ccc; margin: 0;"><strong>ID:</strong> ${courseId}</p>
                        <p style="color: #ccc; margin: 5px 0;"><strong>Categoria:</strong> ${courseObject.category_name}</p>
                        <p style="color: #ccc; margin: 5px 0;"><strong>Dura√ß√£o:</strong> ${courseObject.course_time}</p>
                        <p style="color: #4CAF50; margin: 10px 0 0 0; font-weight: bold;">üéØ Modal de curadoria aberto! Escolha sua a√ß√£o:</p>
                        <ul style="color: #ccc; margin: 10px 0 0 20px;">
                            <li>üìñ <strong>Acessar Agora</strong> - Ir direto para o curso</li>
                            <li>‚≠ê <strong>Adicionar √† Curadoria</strong> - Salvar para depois</li>
                            <li>‚ùå <strong>Cancelar</strong> - Voltar √† busca</li>
                        </ul>
                    </div>
                `;
            }
        }

        // Inicializar eventos do modal (executar ap√≥s DOM estar pronto)
        function initializeTrainingSearchEvents() {
            console.log('üîß Inicializando eventos do modal de busca...');
            
            // Fechar modal
            const closeBtn = document.getElementById('trainingSearchClose');
            if (closeBtn) {
                closeBtn.addEventListener('click', closeTrainingSearchModal);
                console.log('‚úÖ Evento de fechar modal adicionado');
            } else {
                console.error('‚ùå Bot√£o de fechar n√£o encontrado');
            }

            // Busca por texto
            const searchInput = document.getElementById('trainingSearchInput');
            if (searchInput) {
                let searchTimeout;
                searchInput.addEventListener('input', function() {
                    console.log('üìù Texto digitado:', this.value);
                    clearTimeout(searchTimeout);
                    const query = this.value.trim();
                    
                    if (query.length >= 2) { // Reduzido para 2 caracteres
                        searchTimeout = setTimeout(() => {
                            console.log('üîç Iniciando busca para:', query);
                            searchTrainings(query);
                        }, 300); // Reduzido delay
                    } else if (query.length === 0) {
                        document.getElementById('trainingSearchResults').innerHTML = `
                            <div style="text-align: center; margin-top: 40px;">
                                <p style="color: #ccc; margin-bottom: 20px;">üîç Digite qualquer termo no campo acima</p>
                                <div style="background: rgba(100, 181, 246, 0.1); border: 1px solid rgba(100, 181, 246, 0.2); border-radius: 8px; padding: 20px; text-align: left; max-width: 500px; margin: 0 auto;">
                                    <h4 style="color: #64B5F6; margin: 0 0 15px 0;">üí° Como funciona:</h4>
                                    <p style="color: #ccc; margin: 0 0 10px 0; font-size: 14px;">1Ô∏è‚É£ <strong>Digite</strong> qualquer palavra-chave</p>
                                    <p style="color: #ccc; margin: 0 0 10px 0; font-size: 14px;">2Ô∏è‚É£ <strong>Busca autom√°tica</strong> nas √°reas empresariais</p>
                                    <p style="color: #ccc; margin: 0 0 10px 0; font-size: 14px;">3Ô∏è‚É£ <strong>N√£o encontrou?</strong> Clique em "üåê Buscar em Todas"</p>
                                    <p style="color: #64B5F6; margin: 10px 0 0 0; font-size: 13px;">Exemplo: "excel", "powerpoint", "comunica√ß√£o"...</p>
                                </div>
                            </div>
                        `;
                    }
                });
                console.log('‚úÖ Evento de busca por texto adicionado');
            } else {
                console.error('‚ùå Campo de busca n√£o encontrado');
            }

            // Bot√£o "Buscar em Todas" - √∫nico bot√£o clic√°vel
            const allCategoriesBtn = document.querySelector('[data-filter="todas"]');
            if (allCategoriesBtn) {
                allCategoriesBtn.addEventListener('click', function() {
                    console.log('üåê Expandindo busca para TODAS as categorias...');
                    
                    // Marcar como ativo
                    this.classList.add('active');
                    this.style.background = 'linear-gradient(45deg, #1976D2, #0D47A1)';
                    this.textContent = 'üåê Buscando...';
                    
                    // Pegar o termo atual do campo de busca
                    const currentSearch = document.getElementById('trainingSearchInput').value.trim();
                    const searchTerm = currentSearch || 'todas';
                    
                    searchTrainings(searchTerm, true, true); // novo par√¢metro para for√ßar busca geral
                    
                    // Restaurar bot√£o ap√≥s busca
                    setTimeout(() => {
                        this.textContent = '‚úÖ Busca Ampliada';
                        setTimeout(() => {
                            this.textContent = 'üåê Buscar em Todas';
                            this.style.background = 'linear-gradient(45deg, #2196F3, #1976D2)';
                            this.classList.remove('active');
                        }, 2000);
                    }, 1000);
                });
                console.log('‚úÖ Evento do bot√£o "Buscar em Todas" adicionado');
            } else {
                console.error('‚ùå Bot√£o "Buscar em Todas" n√£o encontrado');
            }

            // Fechar modal clicando fora
            const modal = document.getElementById('trainingSearchModal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        closeTrainingSearchModal();
                    }
                });
                console.log('‚úÖ Evento de fechar clicando fora adicionado');
            }
            
            console.log('üéâ Todos os eventos do modal inicializados!');
        }



        console.log('üîç Sistema de Busca de Treinamentos inicializado!');

        // Garantir que os eventos sejam inicializados quando a p√°gina carregar
        function ensureTrainingEventsInitialized() {
            if (window.trainingEventsInitialized) {
                console.log('‚úÖ Eventos j√° inicializados');
                return;
            }

            const modal = document.getElementById('trainingSearchModal');
            if (!modal) {
                console.log('‚è≥ Modal ainda n√£o dispon√≠vel, tentando novamente...');
                setTimeout(ensureTrainingEventsInitialized, 200);
                return;
            }

            console.log('üîß Inicializando eventos do modal...');
            initializeTrainingSearchEvents();
            window.trainingEventsInitialized = true;
        }

        // Executar em diferentes momentos para garantir inicializa√ß√£o
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                setTimeout(ensureTrainingEventsInitialized, 300);
            });
        } else {
            setTimeout(ensureTrainingEventsInitialized, 100);
        }

        // Backup: tentar novamente ap√≥s 2 segundos
        setTimeout(ensureTrainingEventsInitialized, 2000);
        
    </script>
</body>
</html>
